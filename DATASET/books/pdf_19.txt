 Contribution à l’étude de la distributivité d’un treillis de concepts Alain Gély Miguel Couceiro Yassine Namir Amedeo Napoli LORIA CNRS Inria Nancy Grand Est Université de Lorraine BP 239 54506 Vandoeuvre les Nancy France alain gely miguel couceiro amedeo napoli loria fr Université de Lorraine namir yassine gmail com Résumé Nous nous intéressons aux treillis distributifs dans le cadre de l’ana lyse formelle de concepts FCA La motivation primitive vient de la phylogénie et des graphes médians pour représenter les dérivations biologiques et les arbres parcimonieux La FCA propose des algorithmes efficaces de construction de treillis de concepts Cependant un treillis de concepts n’est pas en correspon dance avec un graphe médian sauf s’il est distributif d’où l’idée d’étudier la transformation d’un treillis de concepts en un treillis distributif Pour ce faire nous nous appuyons sur le théorème de représentation de Birkhoff qui nous per met de systématiser la transformation d’un contexte quelconque en un contexte de treillis de concepts distributif Ainsi nous pouvons bénéficier de l’algorith mique de FCA pour construire mais aussi visualiser les treillis de concepts dis tributifs et enfin étudier les graphes médians associés 1 Contexte et motivations Les structures discrètes ont toujours su démontrer leur utilité pour découvrir de l’informa tion Parmi elles les arbres ou leurs extensions Bertrand et Janowitz 2002 Diatta 2005 Bertrand et Diatta 2017 sont très souvent utilisés notamment en biologie où les arbres phy logénétiques permettent de capturer les filiations inter espèces Le problème est alors de re trouver les évolutions qui ont amené la diversité du vivant actuel généralement à partir de fragments d’ADN d’espèces contemporaines Lorsque plusieurs arbres possibles aboutissent au même résultat on privilégie les arbres les plus parcimonieux c’est à dire ceux qui nécessitent le moins de modifications mutations pour les espèces considérées Cependant même ainsi plusieurs arbres restent possibles C’est le cas par exemple si l’on observe des mutations dites inverses un gène retrouve un état an térieur suite à une nouvelle mutation ou parallèles la même mutation se produit chez des espèces sans liens direct Si on ne souhaite pas privilégier un de ces arbres la question de la représentation de cette famille se pose Peut on trouver une structure encodant l’ensemble des arbres phylogénétiques parcimonieux Pour répondre à cette question Bandelt a proposé l’utilisation de graphes médians Bandelt et Hedlíková 1983 Bandelt et al 1999 En quelques mots ces derniers sont des graphes 107 étude de la distributivité d’un treillis de concepts qui ont la particularité que pour tout triplet de sommets les plus courts chemins entre paires de sommets s’intersectent en un sommet unique appelé sommet médian On retrouve l’idée de parcimonie le croisement des chemins se faisant en un point unique Un graphe médian est un moyen de représenter l’ensemble des arbres parcominieux Toujours parmi les structures discrètes les treillis des concepts sont au coeur de l’analyse de concepts formels FCA pour "Formal Concept Analysis" Ganter et Wille 1999 Ils sont utilisés dans de nombreux champs applicatifs Carpineto et Romano 2004 par une commu nauté de recherche qui va en s’étoffant notamment pour des problématiques de classification Les méthodes de FCA utilisent généralement en entrée une table binaire appelée contexte ce qui ne pose pas de véritable problème pour s’intéresser à la filiation inter espèce et aux pro blèmes de phylogénie Il suffira en effet de pré traiter les données de façon à se ramener à ce cadre C’est par exemple possible en utilisant un contexte mettant en relation les espèces avec un génome de référence en indiquant 1 s’il n’y a pas eu mutation sur un gène par rapport à ce génome et 0 sinon Il y a des liens forts entre les graphes médians d’un coté et certains treillis de l’autre ceux ayant la propriété d’être distributifs comme discuté ci après Uta Priss Priss 2012 2013 propose de tirer profit de ces liens pour ré utiliser l’ensemble des outils à disposition dans la communauté FCA pour traiter les problèmes de phylogénétique utilisant un graphe médian Cependant un treillis des concepts n’est pas forcément distributif et n’est donc pas en correspondance directe avec un graphe médian Il faut par suite modifier le treillis pour qu’il vérifie la propriété de distributivité Si un exemple de modification est donné dans les articles d’Uta Priss il n’y a pas dans ses travaux d’algorithme général permettant de transformer un treillis quelconque en treillis distributif de façon systématique et le travail semble avoir été fait manuellement L’apport principal de cet article est de proposer un tel algorithme qui s’appuie sur le théorème de représentation de Birkhoff Birkhoff 1933 1967 Notre algorithme produit le contexte d’un treillis distributif à partir du contexte d’un treillis quelconque ce qui évite de de voir construire le treillis de départ pour le modifier par la suite De plus notre algorithme assure que le treillis initial peut se plonger plongement d’ordre dans le treillis distributif obtenu Le reste de l’article est structuré comme suit Dans la section 2 nous rappelons les défi nitions et notations nécessaires sur les ensembles ordonnés et treillis La section 3 est un état de l’art sur les treillis distributifs Nous y rappelons les résultats sur lesquels nous construi rons notre algorithme L’algorithme est présenté en section 4 et l’article se termine par une discussion en section 5 2 Définitions et notations Dans l’ensemble de cette section on ne considère que le cas fini Pour la plupart des défi nitions et résultats de ce chapitre on pourra se référer aux trois ouvrages de références Ganter et Wille 1999 Davey et Priestley 2002 Caspard et al 2007 Un ensemble ordonné P ≤ est un ensemble d’éléments P muni de la relation d’ordre ≤ Dans cet article les relations d’ordre seront représentées par leur diagramme de Hasse Il s’agit du graphe ayant pour sommets les éléments de P et pour arêtes les éléments en relation de couverture par d’arcs de transitivité ni de réflexivité Le diagramme de Hasse est orienté du bas vers le haut 108 A Gély et al Définition 1 Soit un ensemble ordonné P ≤ et X ⊆ P X est un idéal d’ordre resp filtre d’ordre si x ∈ X et y ≤ x alors y ∈ X resp ssi x ∈ X et x ≤ y alors y ∈ X Pour un ensemble X ⊆ P quelconque on notera ↓X l’idéal resp ↑X le filtre construit à partir de X Pour un élément x ∈ P ↓x est appelé idéal principal resp ↑x filtre principal Sur l’exemple de la figure 2 l’idéal principal de d est ↓ d = {a b d} le filtre principal de a est ↑ a = {a d} L’ensemble {c d} n’est ni un filtre ni un idéal On a ↑ {c d} = {c d e} ↓{c d} = {a b c d} ba d c e ba c e ↓ d = {a b d} b d c e ↑ a = {a d} FIG 1 – Illustration de filtres et idéaux sur un ensemble ordonné Définition 2 Un treillis T ≤ ∨ ∧ est un ensemble ordonné T ≤ muni de deux opérations de supremum borne supérieure ∨ et d’infimum borne inférieure ∧ Puisque nous considérons le cas fini un treillis possède un plus petit élément noté ⊥ et un plus grand élément noté > Dans la suite lorsqu’il n’y a pas d’ambiguité pour simplifier on utilisera parfois T pour désigner le treillis T ≤ ∨ ∧ et P pour désigner l’ensemble ordonné P ≤ Définition 3 Soit un treillis T ≤ ∨ ∧ — j ∈ T est un élément ∨ irréductible ssi j 6= > et ∀x y ∈ T x ∨ y = j implique x = j ou y = j — m ∈ T est un élément ∧ irréductible ssi m 6= ⊥ et ∀x y ∈ T x ∧ y = m implique x = m ou y = m Les éléments ∨ irréductibles resp ∧ irréductible sont donc les éléments de T qui ne peuvent être retrouvés comme étant le suprémum resp infimum d’autres éléments On notera J T resp M T l’ensemble des éléments ∨ irréductibles resp ∧ irréductibles de T Sans ambiguïté sur T on notera seulement J et M Ces deux ensembles ne sont pas forcément disjoints un même élément pouvant être à la fois ∨ irréductible et ∧ irréductible on parle de doublement irréductible Par convention dans cet article les éléments de J seront étiquetés par des lettres et les éléments de M par des chiffres Un même élément pourra donc être désigné par deux étiquettes s’il est doublement irréductible C’est le cas en figure 2 par exemple pour l’élément doublement irréductible qui a pour label b lorsqu’il est considéré comme un élément∨ irréductible et 1 lorsqu’il est considéré comme élément∧ irréductible Cela nous permettra de clarifier le rôle joué par un élément dans le cadre des relations flèches définies ci après Des éléments peuvent bien sûr ne pas être irréductibles C’est le cas de l’élément au centre du treillis qui peut être décrit comme a ∨ c ou encore 2 ∧ 4 Chaque élément x d’un treillis peut en effet être représenté par l’ensemble des éléments ∧ irréductibles qui lui sont supérieurs représentation ∧ dense x = {∧M∩ ↑x} ou bien de 109 étude de la distributivité d’un treillis de concepts façon équivalente par l’ensemble des éléments ∨ irréductibles qui lui sont inférieurs repré sentation ∨ dense x = {∨ J∩ ↓x} Définition 4 La table d’un treillis T est la relation binaire R ⊆ J ×M définie par jRm relation d’incidence si j ≤ m Une fois la table définie on peut introduire les connections de Galois qui permettent de reconstruire le treillis à partir de cette table Définition 5 Soit J M ≤ la table d’un treillis T on peut définir les connections de Galois entre J et M comme suit — ′ 2J → 2M O′ = m | ∀j ∈ O j ≤ m — ′ 2M → 2J A′ = j | ∀m ∈ A j ≤ m La composition ′′ est un opérateur de fermeture et permet de définir deux systèmes de fermeture sur J et M ainsi que le treillis de Galois treillis des concepts à partir de la table de T La table d’un treillis correspond au contexte réduit d’un treillis des concepts en FCA Gan ter et Wille 1999 Un contexte réduit est un contexte O A I une relation binaire I entre objets O et attributs A pour lequel il n’y a pas deux lignes resp colonnes identiques et tel que chaque ligne resp colonne ne soit pas l’intersection d’autres lignes resp colonnes Autrement dit un contexte réduit est réduit aux éléments irréductibles On notera C J M ≤ la table le contexte réduit d’un treillis La table est souvent repré senté par un tableau à double entrée avec J en colonnes M en lignes et une croix × dans la cellule j m ssi j ≤ m Cette table peut d’autre part être complétée pour servir à présenter d’autres informations comme les relations flèches définies ci après Définition 6 Soit un treillis T j ∈ J et m ∈M on note — j ↑ m ssi m ∈ max T\ ↑j — j ↓m ssi j ∈ min T\ ↓m — j ↔m ssi j ↑ m et j ↓m où min X et max X désignent les éléments minimaux et maximaux de X Ainsi on a j ↑ m si m est maximal dans l’ordre induit par le treillis moins les éléments du filtre de j De même on a j ↓m si j est minimal dans l’ordre induit par le treillis moins les éléments de l’idéal de m Une illustration d’éléments en relation double flèche est donnée figure 2 On notera C J M ≤ ↓ ↑ la table fléchée le contexte réduit avec l’information sup plémentaire des relations flèches Par définition si deux éléments j m sont en relation flèche flèche haut flèche bas ou double flèche alors j 6≤ m Par suite la table fléchée est un tableau à deux dimensions où la valeur d’une cellule j m indique la relation entre j et m celle ci pouvant être de façon exclusive × si j ≤ m ↓ ↑ ↔ ou aucune d’entres elles la cellule est alors laissée vide La figure 2 montre à droite la table fléchée du treillis de gauche Remarquons que l’en semble T\ ↑a ∩M = {3} on a donc a ↑ 3 De même T\ ↓ 3 ∩ J = {a b} et seul a est minimal dans cet ensemble on a donc a ↓3 Puisque a ↑ 3 et a ↓3 on notera a ↔3 Définition 7 Un sous treillis S ≤S ∨S ∧S de T ≤T ∨S ∧S est un treillis tel que 110 A Gély et al a 4 b 1 2 c d 3 1 2 3 4 a × × ↔ × b × × ↔ c ↔ × × × d ↔ × × FIG 2 – Exemple de treillis distributif avec sa table fléchée — S ⊆ T — ∀x y ∈ S x ∨T y ∈ S — ∀x y ∈ S x ∧T y ∈ S Autrement dit un sous treillis est fermé pour les opérations∨ et∧ du treillis dont il est issu Certaines classes de treillis dont les treillis distributif définis ci après peuvent être caractérisés par des sous treillis interdits La prochaine section donne plusieurs résultats sur les treillis distributifs 3 Treillis distributifs Un treillis est distributif ssi il vérifie la distributivité des opérations ∨ et ∧ c’est à dire ∀x y z ∈ T x ∨ y ∧ z = x ∨ y ∧ x ∨ z Birkhoff s’est énormément intéressé aux treillis distributifs dès les années 30 avec un article dont est issu un des résultats utilisé ici Birkhoff 1933 Cette classe particulière de treillis dispose d’un chapitre à part entière dans son ouvrage de référence sur les treillis Birkhoff 1967 Les deux théorèmes repris ici sont aussi détaillés dans l’ouvrage Caspard et al 2007 qui apporte de plus les caractérisations par relations flèches 3 1 Caractérisations d’un treillis distributif Caractérisations Un treillis distributif est un treillis pour lequel les opérations ∨ et ∧ sont distributives entre elles Il découle de cette définition plusieurs caractérisations équivalentes que nous allons réutiliser par la suite Théorème 1 Un treillis T ≤ ∨ ∧ est distributif ssi l’une toutes des conditions équiva lentes suivantes est vérifiée 1 x ∨ y ∧ z = x ∨ y ∧ x ∨ z 2 x ∧ y ∨ z = x ∧ y ∨ x ∧ z 3 x ∧ y ∨ y ∧ z ∨ z ∧ x = x ∨ y ∧ y ∨ z ∧ z ∨ x 4 T ne contient ni N5 ni M3 comme sous treillis 5 la table fléchée de T contient exactement une double flèche ↔ par ligne et par colonne à l’exclusion de toute autre relation flèche 111 étude de la distributivité d’un treillis de concepts a 1 c 3b 2 1 2 3 a × ↔ ↔ b ↔ × ↔ c ↔ ↔ × b 2a 1 c 3 1 2 3 a × ↓ ↔ b ↔ × × c ↑ ↔ × FIG 3 – Treillis M3 et N5 avec leur table fléchée En particulier la troisième caractérisation fait un lien direct entre les treillis distributifs d’un coté et les graphes médians de l’autre En effet on peut définir une opération de médiane sur un ensemble M comme une fonction m M3 →M vérifiant m a a b = a et m m a b c d c = m a m b c d c Or m a b c = a ∧ b ∨ b ∧ c ∨ c ∧ a défini une opération de médiane sur un treillis distributif Ce résultat est utilisé par Bandelt Bandelt et al 1999 pour rapprocher les treillis distributifs des graphes médians Les treillis M3 et N5 apparaissant dans la caractérisation sont les deux plus petits treillis non distributifs Ils sont illustrés en figures 3 avec leur table fléchée Contrairement à la table fléchée du treillis de la figure 2 celles ci ne contiennent pas exclusivement une double flèche par ligne et par colonne Pour M3 on peut voir deux doubles flèches par ligne et par colonne Pour N5 il n’y a qu’une seule double flèche par ligne et par colonne mais aussi des flèches simples 3 2 Treillis distributif et treillis des idéaux Soit l’ensemble ordonné P ≤ on note O P l’ensemble des idéaux d’ordre de P ≤ O P muni de la relation d’inclusion est lui même un ensemble ordonné O P ⊆ C’est de plus un treillis appelé treillis des idéaux L’opération de borne inférieure est l’intersection L’opération de borne supérieure est l’union Le théorème 2 du à Birkhoff Birkhoff 1933 permet de mettre en évidence que les élé ments ∨ irréductibles du treillis des idéaux O P ⊆ ∩ ∪ sont les idéaux principaux de l’ensemble ordonné P ≤ Théorème 2 Soit P ≤ un ensemble ordonné et x ∈ P la fonction � x →↓ x est un isomorphisme d’ordre de P vers J O P Une illustration de ce théorème est proposée figure 4 ou l’on voit à gauche un ensemble ordonné et à droite le treillis des idéaux correspondant avec les idéaux principaux en noir et les autres idéaux en blancs 112 A Gély et al c ba ↓ b = {b} ↓ c = {b c} {a b c} ↓ a = {a} {a b} ∅ FIG 4 – Illustration du théorème de représentation de Birkhoff Le théorème 2 indique qu’il y a isomorphisme entre les ensembles ordonnés d’un coté et les éléments sup irréductibles des treillis des idéaux de l’autre Ce résultat ne donne aucune information sur les propriétés de ces derniers Cependant le résultat du théorème 3 toujours du à Birkhoff permet de remarquer qu’il s’agit de la famille des treillis distributifs Théorème 3 Théorème de représentation de Birkhoff Birkhoff 1933 Soit T un treillis distributif alors la fonction η T → O J T définie par η a = {x ∈ J T | x ≤ a} = {J T ∩ ↓a} est un isomorphisme de T dans O J T On déduit de ce théorème que pour tout treillis T ≤ ∨ ∧ on peut trouver un treillis distributif Td ≤d ∨d ∧d tel que J T ≤ = J Td ≤d Autrement dit on peut toujours à partir d’un treillis obtenir un treillis distributif ayant le même ordre induit sur J C’est ce résultat que nous allons utiliser pour proposer un algorithme construisant la table d’un treillis distributif à partir de la table d’un treillis quelconque 4 Résultats Le problème consiste à transformer un treillis quelconque en un treillis distributif A moins que le treillis initial ne soit déjà lui même distributif il y aura donc forcément modification des données et par suite de la table fléchée L’idée est de calculer la table correspondant au treillis distributif à partir de la table du treillis initial quelconque sans avoir à construire ce dernier et dans un principe d’économie D’autre part on peut se poser la question de savoir dans quelle mesure le treillis distributif obtenu est "proche" du treillis initial et quelles modifications sont autorisées sur la table de départ Ici en considérant T ≤T ∨T ∧T le treillis de départ et Td ≤Td ∨Td ∧Td le treillis distributif construit nous avons considéré les hypothèses suivantes — J Td ≤ = J T ≤ ou bien M Td ≤ = M T ≤ un des deux ordres in duits par les éléments irréductibles est isomorphe entre le treillis initial et le treillis distributif — soit J M ≤ et J Md ≤d les tables des deux treillis alors la relation ≤ est incluse dans la relation ≤d Autrement dit on ne s’autorise qu’à ajouter des croix dans la table et jamais à en retirer L’intuition de cette deuxième hypothèse se retrouve dans la maxime "l’absence de preuve n’est pas la preuve de l’absence 1" S’il y a une croix 1 ce qu’on pourrait interpréter comme une variante de l’hypothèse de monde ouvert 113 étude de la distributivité d’un treillis de concepts c’est que l’existence de la mutation a été montrée pour une espèce et on ne peut le remettre en question S’il n’y a pas de croix cette mutation n’a pas été repérée mais ce n’est pas pour autant qu’elle n’existe pas Comme nous travaillons avec le théorème de représentation de Birkhoff la première condi tion nous assure que le treillis construit a bien une structure commune avec le treillis initial Comme un passage au treillis dual inverse les éléments ∨ irréductibles et ∧ irréductible nous pouvons nous appuyer sur l’une comme sur l’autre Dans un treillis distributif les ordres J Td ≤ et M Td ≤ sont isomorphes On a donc |J Td | = |M Td | Dans le treillis initial trois cas peuvent se produire 1 |J T | = |M T | 2 |J T | > |M T | 3 |J T | < |M T | Si on utilise systématiquement l’ensemble des éléments ∨ irréductibles lignes de la table alors la table modifiée aura autant cas 1 plus cas 2 ou moins cas 3 de colonnes que la table initiale Conserver la relation d’incidence du contexte conserver les croix existantes n’est possible que dans les deux premiers cas En effet dans le troisième certains éléments ∧ irréductibles sont amenés à disparaître On pourra cependant toujours se ramener à l’un des deux premiers cas en raisonnant sur le dual c’est à dire en échangeant le rôle de J T et M T Nous montrerons dans la suite que pour les deux premiers cas la relation d’incidence initiale est bien conservée plongée dans la relation d’incidence du treillis distributif Il serait aussi possible de raisonner sur le troisième cas en conservant J T Dans ce cas la table du treillis distributif ayant moins de colonnes il y aura disparition de croix de la relation d’incidence Notons que dans tous les cas de par l’utilisation du théorème de représentation de Birkhoff y il aura un plongement du treillis de départ dans le treillis distributif ce qui nous assure que les ensembles fermés concepts initiaux apparaissent toujours dans les données transformées L’algorithme proposé suit les deux grandes étapes suivantes 1 Construction de J ≤ à partir de C J M ≤ 2 Construction de C J MTd ≤Td à partir de J ≤ La méthode proposée n’a techniquement pas besoin de la table fléchée C J M ≤ ↑ ↓ pour fonctionner Cependant la connaissance de ces relations permet de savoir plus facilement quelles modifications sont faites sur la table initiale Si besoin le calcul des relations flèches se fait en temps polynomial en la taille du contexte J T ≤ et M T ≤ peuvent être calculés en temps polynomial algorithme 1 Pour trou ver les éléments en relation ↑ avec un élément de j ∈ J on retire le filtre de j c’est à dire j′ de M T ≤ et on cherche les éléments maximaux de M T \j′ ≤ Dualement pour trouver les éléments en relation ↓ avec un élément m ∈M on retire l’idéal de m c’est à dire m′ de J T ≤ et on cherche les éléments minimaux de J T \m′ ≤ Dans la suite nous utiliserons la transformation du treillis N5 en treillis distributif pour illustrer les différentes parties de l’algorithme y compris le calcul des relations flèches 114 A Gély et al Algorithme 1 ordreInduitJdepuisTable Données La table d’un treillis C J M ≤C Résultat l’ensemble ordonné J ≤J ≤J← ∅ pour chaque j1 ∈ J faire pour chaque j2 ∈ J faire si j′1 ⊆ j′2 alors ≤J←≤J ∪ j2 j1 4 1 Construction de J ≤ à partir d’un contexte L’algorithme calcule d’abord J T ≤ à partir d’un contexte L’algorithme 1 est basé sur le fait que tout élément d’un treillis peut être identifié par les éléments ∧ irréductibles qui sont dans son filtre Ainsi un élément j1 est inférieur à j2 si les éléments ∧ irréductibles du filtre de j2 c’est à dire j′2 sont inclus dans ceux du filtre de j1 c’est à dire j ′ 1 Notons que l’algorithme peut être adapté sans mal pour obtenir M T ≤ La complexité de cet algorithme est de O |J |2 |M | puisque pour chaque couple j1 j2 ∈ J on va faire des comparaisons ensemblistes sur j′1 et j ′ 2 O |M | Illustration On considère la table du treillis N5 illustrée en figure 5 gauche A partir de cette table et de l’algorithme 1 on calcule J ≤ centre et M ≤ droite Pour J ≤ puisque c′ ⊂ b′ alors b < c Pour M ≤ puisque 2′ ⊂ 3′ alors 2 < 3 Calcul des relations flèches Pour calculer les relations flèches on cherche les éléments de M en relation ↑ avec un élément de J Pour cela on s’appui sur l’ordre M ≤ — Pour a on calcule M\a′ ≤ En effet a′ =↑a∩M Ici a′ = {1} Seul 3 est maximal dans l’ordre induit On a a ↑ 3 — Pour b on calcule M\b′ ≤ b′ = {2 3} 1 est maximal b ↑ 1 — Pour c on calcule M\c′ ≤ c′ = {3} 1 et 2 sont minimaux c ↑ 1 c ↑ 2 On cherche maintenant les éléments de J qui sont en relation ↓ avec un élément de M — Pour 1 on calcule J\1′ ≤ En effet 1′ =↓ 1 ∩ J Ici 1′ = {a} Seul b est minimal dans l’ordre induit On a b ↓1 — Pour 2 on calcule J\2′ ≤ 2′ = {b} a et c sont minimaux a ↓2 c ↓2 — Pour 3 on calcule J\3′ ≤ 3′ = {b c} a est minimal c ↓3 A partir des éléments en relation ↑ et ↓ on déduit les éléments en relation ↔ b ↔1 c ↔2 a ↔3 4 2 Construction de la table d’un treillis distributif isomorphe au treillis des idéaux Nous avons vu précédemment qu’un treillis distributif était entièrement déterminé par l’en semble de ses éléments ∨ irréductibles Il faut alors calculer la table correspondant au treillis 115 étude de la distributivité d’un treillis de concepts 1 2 3 a × b × × c × table de N5 c ba J ≤ 1 2 3 M ≤ FIG 5 – Représentation de J ≤ M ≤ extraits de la table distributif O J T ⊆ ∪ ∩ à partir de J ≤ Ainsi le treillis de départ et le treillis dis tributif obtenus auront le même ordre induit par les éléments ∨ irréductibles L’algorithme 2 décrit la façon de faire Algorithme 2 Production du contexte d’un treillis distributif Données La table C J M ≤C Résultat La table Cd J Md ≤Cd correspondant à O J ⊆ ∩ ∪ Md ← ∅ ≤Cd← ∅ J ≤j ← ordreInduitJdepuisTable C J M <C pour chaque j ∈ J faire Md ←Md ∪mj mj est l’élément ∧ irréductible tel que j ↔mj X ← J\ ↑j≤j pour chaque x ∈ X faire ≤Cd←≤Cd ∪ x mj Propriété 1 L’algorithme 2 produit la table du treillis des idéaux associé à l’ordre J T Démonstration Le treillis des idéaux d’un ordre est un treillis distributif ayant pour élément ∨ irréductible les idéaux principaux de cet ordre Par construction l’algorithme produit un unique élément m pour chaque j tel que j ↔m Puisque j ↔m alors ↓m ⊆ T\ ↑ j Comme il n’y a pas d’autres relations flèches pour m théorème 1 caractérisation 5 alors ↓m = T\ ↑ j L’ordre induit par J n’est pas modifié par l’algorithme et la table produite est alors par construction celle d’un treillis distributif ayant le même ordre induit par J c’est à dire le treillis des idéaux de l’ordre J ≤ Illustration A l’issue de l’étape précédente nous disposons de l’ordre J ≤ et des relations flèches Puisque nous connaissons les éléments en relation double flèche et qu’il n’y en a qu’une par ligne et par colonne malgré des flèches simples nous allons les utiliser de façon à ce que la table produite conserve ses doubles flèches Autrement dit mb = 1 ′ = J\ ↑b = {a} mc = 2 ′ = J\ ↑c = {a b} ma = 3 ′ = J\ ↑a = {b c} 116 A Gély et al 1 2 3 a × × ↔ b ↔ × × c ↔ × ba c FIG 6 – Table modifiée et treillis distributif obtenu La figure 6 montre la table modifiée gauche et le treillis distributif correspondant droite les nouveaux éléments apparaissent en blanc les éléments du treillis initial en noir complexité Après une étape en O |J |2 |M | calcul de J ≤ la complexité de cet al gorithme est de l’ordre de O |J |2 pour chaque élément ∨ irréductible on calcule un filtre O |J | puis on fait une opération d’intersection ensembliste O |J | La complexité totale de l’algorithme est alors en O |J |2 |M | Propriété 2 Soit T un treillis et Td le treillis distributif obtenu par le théorème de représen tation de Birkhoff Pour tout m ∈ M T il existe mTd ∈ M Td tel que j <T m implique j <Td mTd Démonstration Soit j ∈ J T et m ∈M T tels que j ↔m Alors par définition ↑j∩ ↓m = ∅ Or par construction dans Td il existe un unique mTd tel que m′Td = T\ ↑j ∩ J Comme m′ =↓m ∩ J On a donc m′ ⊆ m′Td et quel que soit ji ∈ m′ ji ∈ m′Td Dans le cas ou |J T | > |M T | cette propriété implique que la relation d’incidence initiale est toujours présente rajout de croix seulement De plus cette preuve nous permet de constater que pour un élément peut importe la double flèche considérée dans la ligne ou la colonne Il suffit alors de choisir les doubles flèches de façon à en avoir une seule par ligne et colonne dans la table du treillis distributif 5 Discussion et Conclusion En nous appuyant sur le théorème de représentation de Birkhoff nous avons proposé un algorithme polynomial produisant la table d’un treillis distributif à partir de la table d’un treillis des concepts La relation d’ordre entre éléments ∨ irréductibles est identique dans les deux treillis et le treillis initial peut être plongé dans le treillis distributif obtenu On pourra aussi s’intéresser aux contextes non binaires par exemple issus d’extension de l’analyse de concepts formel comme les treillis de patrons pattern stucture lattices Une expérimentation sur données réelles devra permettre de vérifier que la sémantique des données est bien préservée par les transformations proposées par cet algorithme Enfin l’algo rithme proposé actuellement en O |J |2 |M | a été mis en place pour montrer la possibilité d’application en temps polynomial en la taille du contexte Une étude plus approfondie pouvant abaisser la complexité théorique de cet algorithme devra être menée 117 étude de la distributivité d’un treillis de concepts Références Bandelt H J P Forster et A Röhl 1999 Median joining networks for inferring intraspeci fic phylogenies Molecular biology and evolution 16 1 37–48 Bandelt H J et J Hedlíková 1983 Median algebras Discrete mathematics 45 1 1–30 Bertrand P et J Diatta 2017 Multilevel clustering models and interval convexities Discrete Applied Mathematics 222 54–66 Bertrand P et M F Janowitz 2002 Pyramids and weak hierarchies in the ordinal model for clustering Discrete Applied Mathematics 122 1 55–81 Birkhoff G 1933 On the combination of subalgebras In Mathematical Proceedings of the Cambridge Philosophical Society Volume 29 pp 441–464 Cambridge University Press Birkhoff G 1967 Lattice theory In Colloquium Publications 3 ed Volume 25 Amer Math Soc Carpineto C et G Romano 2004 Concept data analysis Theory and applications John Wiley Sons Caspard N B Leclerc B Monjardet et al 2007 Ensembles ordonnés finis concepts résultats et usages Volume 60 Springer Davey B A et H A Priestley 2002 Introduction to lattices and order Cambridge university press Diatta J 2005 Galois weak hierarchies Theoretical and computational issues In UK Workshop on Computational Intelligence pp 3 Ganter B et R Wille 1999 Formal concept analysis mathematical foundations Springer Priss U 2012 Concept lattices and median networks In CLA pp 351–354 Priss U 2013 Representing median networks with concept lattices In ICCS pp 311–321 Springer Summary In this paper we study distributive lattices for use in Formal Concept Analysis FCA Principal motivation comes from phylogeny and median graphs to represent biological deriva tions and parcimonious trees FCA proposes efficient algorithms to build concept lattices Nevertheless a concept lattice is not in correspondence with a median graph except if it is a distributive one hence comes the idea to study how to transform a concept lattice in a dis tributive one In goal to achieve it we use Birkhoff representation theorem which allows to compute the transformation of any context in the context of a distributive lattice So we can use all the FCA algorithmic to build but also visualise distributive concept lattices and to study associated median graphs 118 