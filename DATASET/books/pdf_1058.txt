 Modèle décisionnel basé sur la qualité des données pour sélec tionner les règles d’associations légitimement intéressantes Laure Berti Équille IRISA Campus Universitaire de Beaulieu 35042 Rennes France berti irisa fr Résumé Dans cet article nous proposons d’exploiter des mesures décrivant la qualité des données pour définir la qualité des règles d'associations résultant d’un processus de fouille Nous proposons un modèle décisionnel probabiliste basé sur le coût de la sélection de règles légitimement potentiellement intéres santes ou inintéressantes si la qualité des données à l’origine de leur calcul est bonne moyenne ou douteuse Les expériences sur les données de KDD CUP 98 montrent que les 10 meilleures règles sélectionnées d’après leurs mesures de support et confiance ne sont intéressantes que dans le cas où la qualité de leurs données est correcte voire améliorée 1 Introduction La qualité des règles d'association est généralement évaluée par des mesures d’intérêt classiquement le support et la confiance et de nombreuses autres mesures ont été proposées Tan et al 2002 Mais on peut légitimement se demander quel est l’intérêt de telles règles notées LHS RHS si 30 % des données de LHS sont obsolètes 20% des données de RHS sont imprécises et 15% des données de LHS proviennent d’une source réputée peu fiable La thèse défendue dans cet article est que les mesures d'intérêt pour la découverte de règles d’associations ne sont pas autosuffisantes pour représenter effectivement la qualité des rè gles Des mesures décrivant la qualité des données à partir desquelles sont calculées les rè gles doivent être intégrées au processus de découverte de même que le coût d’une décision de choisir ou non ces règles supposées intéressantes doit être également considéré Ceci a motivé donc nos travaux que nous formalisons dans les sections suivantes 2 Caractérisation de la qualité des règles d’association à par tir de la qualité des données d’origine Soit I un ensemble d’items Une règle d’association R est une implication de la forme LHS RHS où LHS ⊆ I RHS ⊆ I et LHS ∩ RHS =∅ LHS et RHS sont des conjonctions de variables telles que l’extension de LHS est g LHS = x1∧x2 ∧…∧xn et l’extension de Y est g RHS = y1∧y2∧…∧ yn' Soit j j=1 2 … k une dimension décrivant un aspect de la qualité des données i e complétude fraîcheur précision cohérence crédibilité etc Soit qj Ii ∈[minij maxij] le score de la dimension de qualité j pour le sous ensemble de données Ii 593 RNTI E 6 Modèle décisionnel pour sélectionner les règles légitimement intéressantes Ii ⊆ I Pour chaque itemset Ii le vecteur composé des scores sur toutes les dimensions de qualité normalisées sur [0 1] est appelé vecteur qualité et noté q Ii dans l’espace qualité Q de tous les vecteurs qualité possibles Nous définissons la qualité d’une règle d’association R avec une fonction de fusion notée "oj" dont la sémantique est spécifique à la dimension de qualité j considérée Cette fonction permet de fusionner chaque composante des vecteurs qualité correspondants aux ensembles de données présents dans les partie gauche et droite de la règle La qualité de la règle R est donc un vecteur k dimensionnel tel que ⎟⎟ ⎟ ⎟ ⎟ ⎠ ⎞ ⎜⎜ ⎜ ⎜ ⎜ ⎝ ⎛ = ⎟⎟ ⎟ ⎟ ⎟ ⎠ ⎞ ⎜⎜ ⎜ ⎜ ⎜ ⎝ ⎛ = ⎟⎟ ⎟ ⎟ ⎟ ⎠ ⎞ ⎜⎜ ⎜ ⎜ ⎜ ⎝ ⎛ = '2121 '22222212222222212 '11121111111121111 222 111 2 1 nkkkkkkknkkkkkk nn nn kkkk yqyqyqxqxqxq yqyqyqxqxqxq yqyqyqxqxqxq RHSqLHSq RHSqLHSq RHSqLHSq Rq Rq Rq RQuality oLooooLoo M oLooooLoo oLooooLoo o M o o M On peut alors définir la qualité moyenne de la règle R notée q R par une somme pondérée de chaque dimension des vecteurs qualité des jeux de données composant la règle avec Le Tableau 1 présente plusieurs exemples de définition ainsi que la sémantique que l’on peut donner à la fonction de fusion pour combiner les scores de qualité sur la dimension considérée pour deux ensembles de données x et y composant la règle j D I M E N S I O N F O N C T I O N D E F U S I O N " o j" D I M E N S I O N D E L A R E G L E x y 1 F r a î c h e u r m i n [ q 1 x q 1 y ] L a f r a î c h e u r d e l a r è g l e x y e s t e s t im é e d e f a ç o n p e s s im i s t e p a r l e p i r e s c o r e d e f r a î c h e u r d e s 2 e n s e m b l e s d e d o n n é e s c o m p o s a n t l a r è g l e 2 P r é c i s i o n q 2 x q 2 y L a p r é c i s i o n d e l a r è g l e x y e s t e s t im é e p a r l e p r o d u i t d e s s c o r e s d e p r é c i s i o n d e s e n s e m b le s x e t y d e l a r è g l e 3 C o m p l é t u d e q 3 x + q 3 y – q 3 x q 3 y L a c o m p l é t u d e d e l a r è g l e x y e s t e s t im é e p a r l a p r o b a b i l i t é q u ’ u n d e s d e u x e n s e m b l e s d e l a r è g l e s o i t c o m p le t 4 C o h é r e n c e m a x [ q 4 x q 4 y ] L a c o h é r e n c e d e l a r è g l e x y e s t e s t im é e d e f a ç o n o p t im i s t e p a r l e m e i l l e u r s c o r e d e c o h é r e n c e d e s 2 e n s e m b l e s d e d o n n é e s c o m p o s a n t l a r è g l e TAB 1 – Différentes fonctions de fusion pour combiner les scores d’une dimension qualité Nous considérons que choisir et utiliser ou non une règle d'association est une décision qui désigne la règle comme étant légitimement intéressante D1 potentiel lement intéressante D2 ou inintéressante D3 à la fois sur la base de bonnes mesures d'intérêt mais également en connaissant la qualité effective des données composant les parties gauche et droite de la règle Cette décision a nécessairement un coût lié à l’incertitude et à la méconnaissance du jeu de données et du processus de recueil qui ne garantit généralement pas la bonne qualité des données Pour for malisme nous employons PCE x la probabilité que le jeu de données X soit "de mauvaise qualité" sur une ou plusieurs dimensions de qualité et PCC x la probabilité que X soit "de qualité correcte" dans une gamme de valeurs acceptables sur chaque dimension de qualité PAE x représente la probabilité que X soit détecté correct alors qu’il est effectivement incorrect PAC x représente la probabilité qu'il soit détecté incorrect alors qu’il est effectivement correct voir Figure 1 1 2 ∑ = = k j jj RqwRq 1 kjw k j j K 2 1 1 1 =∀=∑ = 594 RNTI E 6 L Berti Équille 0 1 0 PCE x Low quality Data PCC x Correct quality Data Erroneous Range Correct Range PAE x Actually erroneous PAC x Actually correct Décision de sélection d’une règle Coût Statut de la qualité des données Coût c10 CC 0 00 c11 CE 1 000 00 c12 AE 0 00 D1 c13 AC 0 00 c20 CC 50 00 c21 CE 50 00 c22 AE 0 00 D2 c23 AC 0 00 c30 CC 500 00 c31 CE 0 00 c32 AE 0 00 D3 c33 AC 0 00 FIG 1 – Probabilités de détection des données dont la qualité est correcte ou mauvaise TAB 2 – Coûts des décisions de sélection des règles selon la qualité des données Pour q ∈ Q la qualité moyenne des données LHS ∪ RHS de la règle R on note P q∈Q | CC ou fCC q la probabilité conditionnelle que la qualité moyenne q cor responde à celle des jeux de données qui sont classifiés comme étant de qualité cor rect CC De la même façon on note P q∈Q | CE ou fCE q la probabilité condi tionnelle que la qualité moyenne q corresponde à celle des jeux de données qui sont classifiés erronés ou comme étant de mauvaise qualité CE On note d la décision de choisir une règle légitimement intéressante notée D1 potentiellement intéres sante notée D2 ou inintéressante notée D3 et s le statut de la qualité des jeux de données à partir desquelles a été calculée la règle On note P d=Di s=j et P d=Di | s=j respectivement les probabilités conjointe et conditionnelle que la décision Di soit prise lorsque le statut de la qualité des données à l’origine du calcul de la règle R est j i e CC CE AE AC On note cij le coût de la décision Di pour classifier la règle sur la base de la qualité des données j composant les parties gauche et droite de la règle A partir des coûts présentés dans le Tableau 2 l’objectif est de minimiser le coût moyen c qui résulte d’une telle prise de décision tel que 333223113 332222112 331221111 330220110 ACsDdPcACsDdPcACsDdPc AEsDdPcAEsDdPcAEsDdPc CEsDdPcCEsDdPcCEsDdPc CCsDdPcCCsDdPcCCsDdPcc ==+==+==+ ==+==+==+ ==+==+==+ ==+==+=== A partir du théorème de Bayes tel que j j P s s DP dj s DP d ii ====== où i=1 2 3 et j= CC CE AE AC on suppose que q est la qualité moyenne des jeux de données composant la règle tirée aléatoirement dans l’espace de tous les vecteurs qualité possibles La probabili té conditionnelle P d=Di| s=j est définie à partir de la fonction de densité de proba bilité fj du vecteur qualité de telle sorte que la variable aléatoire q prenne des va leurs dans l’intervalle [qjMin qjMax] correspondant aux seuils de qualité selon j telle que ] ] q f js DP d jMaxjMin qqq ji ∑ ∈ === où i=1 2 3 et j=CC CE AE AC Par souci de place pour la suite de l’article considérons le cas où il n’y a pas de problème de classification P s=AC P s=AE fAC fAE sont nuls et π0AE et π0AC éga 4 5 3 595 RNTI E 6 Modèle décisionnel pour sélectionner les règles légitimement intéressantes lement On note la probabilité a priori P s=CC =π0 la probabilité a priori probabili té de P s=AC =π0AC la probabilité a priori de P s=AE =π0AE et la probabilité a prio ri de P s=CE = 1 π0 Le coût moyen c dans l’éq 3 basée sur les éq 4 et 5 peut être réécrit tel que [ ] [ ] [ ] 1 1 1 0 33 0 32 0 31 0 30 0 23 0 22 0 21 0 20 0 13 0 12 0 11 0 10 3 2 1 ACACAEAECE Qq CC ACACAEAECE Qq CC ACACAEAECE Qq CC π cf π cfπ cf π cf π cf π cfπ cf π cf π cf π cfπ cf π cfc ++−++ ++−++ ++−+= ∑ ∑ ∑ ∈ ∈ ∈ Minimiser ce coût moyen conduit à rechercher la décision optimale pour la clas sification des règles en trois catégories notées D01 pour les règles légitimement inté ressantes D02 pour les règles potentiellement intéressantes et D03 pour les règles inintéressantes selon les trois répartitions de qualité correspondantes Q1 Q2 et Q3 ⎭ ⎬ ⎫ ⎩ ⎨ ⎧ − − ⋅ − ≥ − − ⋅ − ≥= ⎭ ⎬ ⎫ ⎩ ⎨ ⎧ − − ⋅ − ≤ − − ⋅ − ≥= ⎭ ⎬ ⎫ ⎩ ⎨ ⎧ − − ⋅ − ≤ − − ⋅ − ≤= 1 and 1 1 and 1 1 and 1 3121 2030 0 0 3111 1030 0 0 0 3 3121 2030 0 0 2111 1020 0 0 0 2 2111 1020 0 0 3111 1030 0 0 0 1 cc cc π π f f cc cc π π f fqD cc cc π π f f cc cc π π f fqD cc cc π π f f cc cc π π f fqD CC CE CC CE CC CE CC CE CC CE CC CE Les inégalités 7 permettent de définir trois valeurs de seuil L P et N respecti vement pour des règles légitimement potentiellement et non intéressantes dans l'espace de décision L’éq 8 définit concrètement ces régions où la décision est basée sur les coûts du choix d’une règle sans problème de classification 1 1 1 3121 2030 0 0 2111 1020 0 0 3111 1030 0 0 cc cc π πNet cc cc π πP cc cc π πL − − ⋅ − = − − ⋅ − = − − ⋅ − = 3 Expérimentations Afin d’évaluer notre modèle décisionnel nous avons utilisé les données recueillies par l'UCI dans le cadre de KDD CUP 981 comprenant 191 779 enregistrements sur les individus contactés pour une campagne de dons aux vétérans américains en 1997 Chaque enregistre ment est décrit par 479 variables et deux variables cibles indiquent les classes d’individus ayant répondu positivement ou non "respond" "no respond" avec la donation effectuée en dollars Environ 5% des individus ont répondu positivement Le challenge de KDD Cup 98 était d’établir un modèle de prédiction des bénéfices c’est à dire du montant total des dona tions auquel sont retranchés les coûts d'expédition 0 68 voir Wang et al 2005 pour plus de détails Puisque nous ignorions la qualité des données recueillies pendant cette campa gne nous avons généré des indicateurs synthétiques de la qualité de données selon différen tes distributions de pollutions sur quatre dimensions de la qualité des données fraîcheur complétude cohérence et crédibilité pour chaque domaine de valeurs des variables considé 1 kdd ics uci edu databases kddcup98 kddcup98 html for the dataset and kdnuggets com meetings kdd98 kdd cup 98 html for the results 6 7 8 596 RNTI E 6 L Berti Équille rées Puis nous avons calculés les 10 meilleures règles d’association en suivant l’approche de Wang et al 2005 pour prédire les individus répondant positivement à l’appel de dons et les bénéfices Nous avons ensuite calculé la qualité des 10 meilleures règles découvertes voir Tableau 3 En employant l’éq 8 et le Tableau 2 nous avons calculé les valeurs des trois seuils de décision pour le choix des règles avec une probabilité a priori π0 = 0 200 sans problème de classification et obtenons L = 0 125 P = 0 013 et N = 2 25 Qualité Décision Régles d’associations Conf Supp Profit Wang et al 2005 Fresh Accur Compl Consi Average Coût 1 ETHC4=[2 5 4 5] ETH1=[22 84 29 76] HC6=[60 91 68 53] 0 11 13 81 11 0 21 0 38 0 79 0 53 0 48 53 POTENTIALLY 2 RFA_14=f1d ETH1=[29 76 36 69] 0 17 8 61 73 0 21 0 52 0 62 0 53 0 47 109 5 NOT 3 HHD1=[24 33 28 91] EIC4=[33 72 37 36] 0 12 12 47 07 0 17 0 35 0 90 0 15 0 39 113 NOT 4 RFA_23=s2g ETH13=[27 34 31 23] 0 12 16 40 82 0 34 0 01 0 90 0 79 0 51 130 NOT 5 EIC16=[11 25 13 12] CHIL2=[33 35 33] HC6=[45 69 53 30] 0 16 11 35 17 0 03 0 53 0 77 0 71 0 51 34 7 POTENTIALLY 6 RHP2=[36 72 40 45] AGE904=[42 2 44 9] 0 16 7 28 71 0 50 0 15 0 44 0 73 0 46 109 NOT 7 HVP5=[56 07 63 23] ETH13=[31 23 35 61] RAMNT_22=[7 90 10 36] 0 14 10 24 32 0 37 0 65 0 68 0 95 0 66 62 8 POTENTIALLY 8 NUMCHLD=[2 5 3 25] HU3=[66 27 70 36] 0 08 31 19 32 0 07 0 09 0 61 0 57 0 34 190 NOT 9 RFA_11=f1g DMA=[743 766 8] POP903=[4088 208 4391 917] WEALTH2=[6 428571 7 714286] 0 25 8 17 59 0 24 0 08 0 72 0 95 0 50 49 6 POTENTIALLY 10 HUPA1=[41 81+ ] TPE11=[27 64 31 58] 0 23 9 9 46 0 20 0 22 0 99 0 93 0 59 40 8 POTENTIALLY TAB 3 – Les 10 meilleures règles découvertes avec leur qualité coût et décision associés Le Tableau 3 montre les 10 meilleures règles d’associations découvertes avec leur confiance leur support en nombre d’enregistrements le bénéfice prédit les scores par dimension de qualité la qualité moyenne le coût de sélection pour chaque règle d'association et enfin la région décisionnelle de chaque règle Il est intéressant de noter que le bénéfice prédit par règle peut être considérablement affecté par le coût de sélectionner une règle cal culée à partir de données de mauvaise qualité par exemple la deuxième meilleure règle R2 dont le bénéfice prévu est 61 73 a un coût de 109 5 si elle est sélectionnée alors qu’elle est classifiée comme "inintéressante" à cause de cette mauvaise qualité de données Dans ces expériences notre but était également de démontrer que des variations de la qualité de don nées pouvaient avoir un impact considérable sur la validité des résultats issus de la fouille de règles et dans le cas du challenge KDD Cup 98 invalider totalement les prédictions de béné fices Ainsi la Figure 2 a montre le comportement du coût de la décision dans le choix des règles quand la qualité moyenne des données InitQual se dégrade de 10% 30% à 50% ou s’améliore de +10% +30% à +50% avec 0π = 0 200 et en l’absence de problème de clas sification Nous observons que la dégradation de la qualité des jeux de données composant les règles augmente le coût de la sélection de ces règles L'amélioration de qualité de données se manifeste par une stabilisation du coût de la décision pour des règles légitimement intéres santes Un autre résultat intéressant est montré dans la Figure 2 b parmi les 10 meilleures règles découvertes pour une qualité de données initiale InitQual seulement 5 règles R1 R5 R7 R9 et R10 sont potentiellement intéressantes Lorsque la qualité augmente de 30% 3 règles deviennent légitimement intéressantes R5 R7 et R9 Cette observation offre deux perspectives intéressantes pour l'exploitation des règles d'associations et pour la gestion de la qualité de données la première pour guider l’élagage du nombre de règles sur la base à la fois des indicateurs de qualité de données et des coûts de décision dans le choix des règles la seconde pour établir des stratégies et des priorités dans l'amélioration de la qualité de don nées par un nettoyage ciblé par exemple 597 RNTI E 6 Modèle décisionnel pour sélectionner les règles légitimement intéressantes FIG 2 – Coût de la décision et statut des règles selon des variations de la qualité 4 Conclusion Dans cet article nous proposons une méthode pour définir la qualité des règles d'associa tions en intégrant des mesures de la qualité de données à partir desquelles celles ci sont dé couvertes Ensuite nous proposons un modèle décisionnel probabiliste basé sur le coût que peut engendrer le choix de règles d'association certes intéressantes d’après leur support et confiance mais basées sur des données de mauvaise qualité Le modèle définit les trois seuils pour déterminer si les règles découvertes sont légitimement potentiellement intéressantes ou inintéressantes Pour valider notre approche nos expériences sur l'ensemble de données de la KDD Cup 98 ont consisté à i générer des indicateurs synthétiques de qualité des données ii calculer les dix meilleures règles d'association en terme de support confiance et calculer leur qualité moyenne à partir de la qualité de leurs données iii calculer le coût qu’entraîne la décision de choisir des règles illégitimement intéressantes iv examiner le coût et la décision sur le choix de ces règles quand la qualité des données varie Nos expériences confirment notre hypothèse initiale les mesures d’intérêt des règles d’associations découvertes ne sont pas autosuffisantes et la qualité d’une règle d'association dépend de la qualité des données à partir desquelles elle est calculée La qualité de données inclut de diverses dimensions devant être considérées pour assurer et valider la qualité des connaissances extraites Références Tan P N Kumar V and Srivastava J 2002 Selecting the Right Interestingness Measure for Association Patterns Proc of Intl KDD Conf p 32 41 Wang K Zhou S Yang Q and Yeung J M S 2005 Mining Customer Value from Associa tion Rules to Direct Marketing Journal of Data Mining and Knowledge Discovery Summary In this paper we propose to exploit the measures describing the quality of data for defin ing the quality of association rules resulting from the rule mining process We propose a probabilistic cost based decisional model for the selection of legitimately potentially inter esting or not interesting rules when the quality of data they are computed from is correct medium or low The experiments on the KDD CUP 98 dataset show that the Top 10 rules selected with good support and confidence measures are not interesting unless the quality of their data is correct or improved R1 NOT R2 R3 LEGITIMATELY R4 R5 POTENTIALLY R6 R7 R8 R9 R10 50% 30% 10% init quality 10% 30% 50% a b 598 RNTI E 6