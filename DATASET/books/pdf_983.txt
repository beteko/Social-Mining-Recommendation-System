 article_egcUne règle d’exception en Analyse Statistique Implicative Régis Gras * Pascale Kuntz * Einoshin Suzuki ** *Laboratoire d’Informatique de Nantes Atlantique FRE CNRS 2729 Equipe COD Connaissances Décision Site Ecole Polytechnique de l’Université de Nantes La Chantrerie BP 60601 44306 Nantes cedex ** Department of Informatics ISEE Kyushu University Japan regisgra club internet fr pascale kuntz polytech univ nantes fr suzuki i kyushu u ac jp Résumé En fouille de règles certaines situations exceptionnelles défient le bon sens C’est le cas de la règle R a → c et b → c et a et b → non c Une telle règle que nous étudions dans l’article est appelée règle d’exception A la suite des travaux précurseurs de E Suzuki et Y Kodratoff 1999 qui ont étudié un autre type de règle d’exception nous cherchons ici à caractériser les conditions d’apparition de la règle R dans le cadre de l’Analyse Statistique Implicative 1 Introduction Depuis les travaux de Agrawal et al 1993 les règles d’association ont été un modèle très utilisé pour extraire des tendances implicatives dans des bases de données Rappelons que lorsqu’on dispose d’un ensemble E d’individus décrits par p variables {a b … } qui peuvent être des conjonctions de variables atomiques et que l’on supposera ici binaires une règle d’association a → b signifie que si a est vérifiée alors généralement b l’est également Lorsque l’on extrait un ensemble de telles règles partielles d’association il est pertinent de s’interroger sur les relations que ces règles entretiennent entre elles Cette question a été abordée dans la littérature selon différents points de vue Dans une optique de structuration de l’ensemble des règles différentes méthodes de classification ont été proposées e g Lent et al 1997 Gras et Kuntz 2005 Des représentations visuelles bien adaptées permettent également de mettre en évidence des dépendances entre les règles e g Lehn 2000 ou Couturier et Gras 2005 Si l’on étudie localement avec attention ces relations on peut découvrir une situation qui défie l’intuition Supposons que l’on ait entre trois variables par exemple des attributs a b et c conjonction de variables binaires dans l’étude présente et vérifiant a → c et b → c Dans des cas exceptionnels on n’a pas a et b → c comme le bon sens nous le suggère mais a et b → non c Cette dernière règle sera appelée ici règle d’exception Remarquons que des travaux antérieurs Suzuki et Kodratoff 1999 Suzuki et Zytkow 2005 considèrent comme situation d’exception la situation suivante a → c dite règle de sens commun non b→ c’ dite règle de référence et a et b → c’ dite règle d’exception où c ≠ c’ et où a et b sont respectivement des conjonctions a = Une règle d’exception en Analyse Statistique Implicative RNTI X a1 et a2 …et am et b= b1 et b2… et bp Notre définition de règle d’exception se distingue ainsi de celle ci mais présente comme chez E Suzuki et Y Kodratoff un caractère surprenant Or il existe comme nous le verrons en donnant des exemples des situations naturelles où un caractère exceptionnel associe les trois variables Pour le prendre en compte et en étudier un modèle nous étendons ici le sens précédent en accentuant ainsi le caractère surprenant d’exception d’une règle dérivée de deux règles simples Pour illustrer ce type de règle nous faisons référence tout d’abord au cas de l’incompatibilité de groupes sanguins en ce qui concerne le facteur Rhésus Certaines femmes non primo parturientes dont les globules rouges sont porteurs de deux allèles Rh et dont l’immunisation anti Rh+ est active possèdent alors le phénotype Rh caractère a Quel que soit le père en général l’enfant qu’elles portent ne présentera pas à la naissance de problème sur le plan sanguin caractère c Nous sommes en présence de la règle a → c Un homme de génotype Rh+ et Rh+ possède le phénotype Rh+ caractère b Quelle que soit la mère en général l’enfant qu’il engendrera n’aura pas de problème à sa naissance caractère c C’est la situation où la règle b → c est valide En revanche un couple où la femme est Rh et remplit les conditions a et l’homme est Rh+ caractère b pourra donner naissance à un enfant qui présentera un risque important du fait de l’incompatibilité Rhésus caractère non c Dans des cas exceptionnels en effet la mère s’immunisant contre le facteur Rh du fœtus fabrique des anticorps qui détruisent les globules rouges de l’enfant Même si la conjugaison des caractères a et b est rare on rencontre cependant la réalisation de la règle que nous avons appelée règle d’exception a et b → non c On sait d’ailleurs que des précautions sont prises pour éviter ce problème dès que sont connus les phénotypes des parents à la faveur d’une prévention adaptée par exemple l’exsanguino transfusion On trouve une situation comparable d’apparition de règle d’exception dans l’étude des phénomènes d’interférences lumineuses par exemple dans l’expérience classique des franges de Young Bruhat G 1959 La même source lumineuse franchissant deux fentes identiques a et b conduit à des franges d’interférences où alternent des zones d’intensité lumineuse c variable susceptible de faiblir et ou s’annuler non c Dans cette communication nous cherchons à caractériser les situations qui présentent ce type de règles Nous nous plaçons ici dans le cadre de l’Analyse Statistique Implicative A S I qui a montré toute sa pertinence en E C D pour la fouille de règles1 Dans la première partie nous rappelons brièvement les principes de base de l’A S I qui nous servent dans la suite Puis nous proposons une description ensembliste d’une règle d’exception suivie d’un exemple numérique dont l’analyse des résultats nous permet d’établir des conjectures sur les conditions favorables à l’apparition d’une règle d’exception Nous finissons par une caractérisation formelle de ces conditions selon les deux modélisations de tirages les plus utilisées en A S I le modèle de Poisson et le modèle 1 cf Actes de la 3ème Rencontre ASI 3 de Palerme 6 8 10 05 GRIMM Université de Palerme I R Gras et al RNTI X binomial Elle s’exprimera en termes de relations algébriques entre les paramètres de la situation 2 Principes de l’A S I Rappels Notons A et B les sous ensembles respectifs de E d’individus qui vérifient respectivement les variables a et b Pour une règle quelconque a→ b observée dans E l’A S I consiste à comparer le nombre de contre exemples ban ∧ à cette règle observés dans A B∩ avec le nombre de contre exemples qui apparaîtraient lors d’un choix aléatoire et indépendant de deux parties X et Y de E de mêmes cardinaux respectifs que A et B FIG 1 cf Gras 2005 et Lebart et al 2006 La variable aléatoire associée est notée baN ∧ La qualité de la règle a→ b sera intuitivement d’autant meilleure que Prob[ baN ∧ > ban ∧ ] sera proche de 1 autrement dit en général on observe plus de contre exemples dans des circonstances aléatoires que l’on en a observés dans la contingence Dans ce cas le seul hasard conduit donc en moyenne à plus de contre exemples que ce qui est observé FIG 1 – Représentation ensembliste La méthode de tirage au hasard de X et Y dans une hypothèse a priori d’indépendance de a et b conduit à différentes options pour la loi de la variable aléatoire baN ∧ Deux modélisations de cette variable sont généralement retenues en A S I conduisant à un modèle de Poisson et à un modèle binomial Gras 1979 Lerman 1981 a et Lerman et al 1981 b On centre et on réduit cette variable en la variable Q a b l’observation contingente sa réalisation est q a b Par exemple dans le cas de Poisson on obtient q a ∧ b c = n nn n nn n cba cba cba ∧ ∧ ∧∧ − L’intensité d’implication est alors définie par ϕ a b = Prob[Q a b >q a b ] dont la valeur gaussienne asymptotique centrée et réduite est B n b A n a Y n b a X n E Les parties hachurées correspondent aux contre exemples observés ou aléatoires de a → b Une règle d’exception en Analyse Statistique Implicative RNTI X ϕ a b = ∫ ∞+ − π 2 2 2 1 baq t dte 1 Plus q a b est négatif meilleure est la qualité de la règle a→ b 3 Interprétation et illustration des règles d’exception Soient A B C et A ∩ B respectivement les sous ensembles d’individus de E qui satisfont les variables a b c et a et b Dans la situation illustrée ici elles sont binaires mais l’A S I permet de considérer également d’autres types de variables Gras 2005 3 1 Deux approches pour la caractérisation des règles d’exception Supposons la situation prototypique des règles d’exception a→ c b→ c et a et b →non c alors que a et b → c est de piètre qualité Elle s’exprime en termes ensemblistes par une quasi inclusion des ensembles d’instances à savoir A et B sont presque contenus dans C mais A ∩ B est plutôt contenu dans le complémentaire de C L’illustration ci dessous rend compte de la situation ensembliste FIG 2 – Apparition d’une règle d’exception ensembliste Dans le cadre de l’A S I deux approches pourraient nous permettre de mettre en évidence cette situation La première approche est basée sur l’analyse de l’intensité d’implication ϕ a b Elle nous permet de conclure au rejet de a et b → c et a contrario à l’apparition d’une intensité non négligeable quelquefois de a et b → non c La deuxième approche est basée sur l’extension que nous avons proposée des règles en R règles règles de règles de type R→ R’ où R et R’ sont elles mêmes des règles Gras et Kuntz 2005 Intuitivement ces règles sont comparables à celles qui apparaissent en mathématiques où un théorème R a pour conséquence un autre théorème R’ ou est suivi d’un c non c A B A et B I R Gras et al RNTI X corollaire R’ Elles sont construites selon un algorithme récursif utilisant un indice appelé cohésion Celui ci rend compte de la qualité des liaisons implicatives des variables de la règle R avec les variables de la règle R’ Rappelons qu’en logique formelle la règle de règle ou R règle a⇒ b⇒ non c composée de la règle R1 = b⇒ non c et R2 = a⇒ R1 est vraie en même temps que a et b ⇒ non c Par analogie dans notre cadre statistique où les règles sont partielles l’extraction de la R règle a→ b→ non c pourrait nous permettre de mettre en évidence la règle d’exception a et b → non c Notons que dans Gras et al 2005 les variables a b et c peuvent être des règles elles mêmes Nous avons développé un algorithme basé sur une classification ascendante hiérarchique qui nous permet d’extraire des R règles significatives FIG 3 Cependant cet algorithme recherche en priorité la variable que b implique avec le maximum d’intensité Il ne peut donc faire appel à non c On retrouve ici le problème d’artefact lié au chaînage et au fait que l’implication n’est pas stricte Ainsi nous suivons dans la suite la première approche FIG 3 –Règle d’exception dans une hiérarchie implicative 3 2 Exemple numérique Nous avons construit un fichier fictif de 200 sujets cf un tableau partiel en Annexe où nous en montrons la construction sujets sur lesquels nous observons les variables binaires a b a ∧ b c et non c Les valeurs associées des différentes intensités sont données dans TAB 1 Elles sont obtenues par le logiciel CHIC Couturier et Gras 2005 qui permet les calculs et les représentations graphiques des ensembles de règles extraites des instances a b c non c a ∧ b a 0 79 89 08 89 b 79 0 84 10 88 c 68 67 0 0 36 non c 32 33 0 0 64 a ∧ b 1 00 1 00 03 97 0 TAB 1 – Intensités d’implication associées à un jeu de données Notons les fréquences des occurrences des variables na= nb = 12 na ∧ b= 7 nc= 50 Les intensités d’implication associées sont ϕ a c = 0 89 ϕ b c = 84 ϕ a et b c = 0 03 a b non c Une règle d’exception en Analyse Statistique Implicative RNTI X alors que ϕ a et b c = 0 97 ce qui confirme la présence d’une règle d’exception Une première analyse par CHIC sur le tableau complet donne le graphe implicatif Figure 4 a et l’on constate la bonne qualité d’implication de a et de b sur c On constate aussi que l’on a bien a→ c et b→ c Lorsque CHIC conjoint les variables on obtient cette fois le phénomène lié à l’existence d’une règle d’exception Figure 4 b 4 a Règles simples 4 b Apparition de la règle d’exception FIG 4– Graphe implicatif avec les règles simples puis conjointes D’une façon générale en A S I trois conditions nous semblent favorables à l’apparition d’une règle d’exception de a ∧ b sur non c 1 Une certaine qualité d’implication de a et de b sur c cette condition de bon sens conduit à ce que la règle a ∧ b → c soit attendue et non pas a ∧ b → c qui en définitive va l'être 2 Une mauvaise qualité de ressemblance entre a ∧ b et c cban ∧∧ est faible 3 Une bonne qualité de ressemblance entre a et b si le référentiel devient non c cban ∧∧ est grand relativement à na ∧ b 4 Relation entre les intensités d’implication de a ∧ b sur c et sur non c Rappelons que en A S I nous modélisons l’implication de a sur b de deux manières i par une loi de Poisson de paramètre λ = nnn ba ii par une loi binomiale de paramètres n et p = nnnn ba Une modélisation hypergéométrique est écartée car elle n’induit pas de différence entre une implication et sa réciproque Gras et al 1996b Etablissons pour chacun de ces deux modèles retenus les intensités d’implication de la conjonction a ∧ b sur les variables c et non c encore notée c Nous utiliserons la relation simple cban ∧∧ = ban ∧ cban ∧∧ a b c a b non c a b I R Gras et al RNTI X 4 1 Modèle de Poisson Dans ce modèle pour respectivement l’implication a ∧ b → c et l’implication a ∧ b → c les indices q1 a ∧ b c et q2 a ∧ b c sont q1 = n nn n nn n cba cba cba ∧ ∧ ∧∧ − et q2 = n nn n nn n cba cba cba ∧ ∧ ∧∧ − 2 Pour que l’implication a ∧ b → c soit de bonne qualité il est nécessaire que q1 soit négatif En effet le nombre de contre exemples observé cban ∧∧ doit être inférieur à celui auquel seul le hasard pourrait conduire dans l’hypothèse d’indépendance de a ∧ b et de c soit la moyenne n nn cba ∧ On retrouve ici un argument justifiant le cas 2 du paragraphe précédent Des définitions 2 on déduit q1 = n nn n nn nn cba cba cbaba _ ∧ ∧ ∧∧∧ − = cba cbacba nnn nnnnn ∧ ∧∧∧ −− = n nn n nn n cba cba cba ˆ ∧ ∧ ∧∧ − = q2 n nn n nn cba cba ∧ ∧ Finalement q1 = q2 c c n n soit 2 1 q q = c c n n q1 et q2 sont bien de signes opposés ce qui est conforme à l’intuition Mais de plus l’amplitude de la positivité de q2 induit celle de la négativité de q1 Au sens de l’intensité d’implication classique pour que la règle a ∧ b →c soit considérée comme une exception et apparaisse la différence cba ∧ϕ cba ∧ϕ suivante doit être positive et suffisamment grande π2 1 ∫ ∞+ − 1 2 2 q t dte ∫ ∞+ − − π c c n n q t dte 1 2 2 2 1 = ∫ − − π c c n n q q t dte 1 1 2 2 2 1 3 Une règle d’exception en Analyse Statistique Implicative RNTI X Conséquence 1 Il y a donc apparition de règles d’exception lorsque q1 est négatif c’est à dire lorsque n n cba ∧∧ < n n n n cba ∧ sous indépendance de qualité d’autant meilleure que l’ensemble C des instances satisfaisant c est supérieur à celui qui satisfont sa négation non c La force de l’intensité d’exception sera à la mesure de la valeur de l’intégrale gaussienne sur l’intervalle [q1 c c 1 n n q− ] De même règle attendue et règle d’exception coïncident lorsque q1 = q2 = 0 Ainsi c’est à l’occasion de l’indépendance de a ∧ b et c et donc de a ∧ b et c que disparaît la règle d’exception 4 2 Modèle binomial Posons q’1 et q’2 respectivement les indices respectifs d’implication de a ∧ b→ c et a ∧ b →c lorsque le modèle de tirage aléatoire des parties A B et C est binomial Dans ce cas par un calcul comparable au modèle précédent on obtient 2 1 ' ' q q = cba 2 c cba 2 c nnnn nnnn ∧ ∧ − − 4 Posons k a b c = 2 1 2 2 1 1                   −       − ∧ ∧ n nn n nn cba cba 5 Donc 2 1 ' ' q q = cbak n n c c 6 et la différence cba ∧ϕ cba ∧ϕ entre les intensités d’implication est ∫ +∞ − 1 2 ' 2 2 1 q t dte π π2 1− ∫ ∞+ − − ' 2 1 2 cbak n n q t c c dte = ∫ − − π ' ' cbak n n q q 2 tc c 1 1 2 dte 2 1 7 Conséquence 2 Pour le modèle binomial la différence entre les intensités d’implication sera non seulement fonction du rapport cn cn mais aussi de k a b c 5 Ce coefficient est I R Gras et al RNTI X d’autant plus grand et renforce ainsi l’effet du rapport cn cn que 2 1 n nn cba∧− >> 2 1 n nn cba∧− c’est à dire n n n n cba ∧ >> n n n n cba ∧ Les deux membres de cette inégalité ne sont autres que de gauche à droite les probabilités respectives du nombre de contre exemples aléatoires dans le modèle binomial où les variables a ∧ b et c seraient indépendantes des implications a ∧ b→ c et a ∧ b→c Ainsi plus on s’attend à une réfutation de a ∧ b→ c au vu de ban ∧ et de c plus le caractère surprenant exceptionnel de cette règle est manifeste par le constat de la modicité des contre exemples observés à savoir cban ∧∧ Ceux ci la valident au détriment de a ∧ b→ c argument favorable à la conjecture 3 du § 3 2 L’inégalité montre la contribution active à l’exception au rapport cn cn contribution qu’apportent les instances de cardinal ban ∧ dans celles de cardinal cn Cette conséquence 2 liée au modèle binomial nous apparaît donc plus riche que la conséquence 1 car elle nous fournit une relation de contrôle entre les paramètres plus fine du caractère d’exception que dans le modèle de Poisson Ce phénomène certes lié au nombre de paramètres de définition du modèle binomial le gratifie cependant d’un intérêt que le logiciel CHIC permet d’exploiter à travers l’offre de son menu Remarque A titre de comparaison intéressons nous à un autre indice de mesure de qualité de règle la confiance c qui est à la base des principaux autres indices de qualité Lenca et al 2004 Elle s’exprime ainsi c a → c = a ca n n ∧ souvent notée ][Pr ][Pr aob caob ∧ autrement dite probabilité conditionnelle de c sachant a La relation entre les règles que nous avons examinées est alors c cba →∧ = ba cba n n ∧ ∧∧ = 1 ba cba n n ∧ ∧∧ = 1 c cba →∧ La règle d’exception a pour mesure le complément à 1 de la règle attendue Ainsi elle est indépendante des valeurs des occurrences 5 Conclusion Lorsque deux variables impliquent une 3ème que leur conjonction implique plutôt la négation de cette 3ème nous considérons que cette règle est d’exception en un sens voisin mais différent de celui de E Suzuki et Y Kodratoff 1999 Nous avons étudié et illustré par un exemple numérique et un exemple de génétique l’expression de ce caractère exceptionnel Puis nous avons précisé les relations entre les paramètres des variables dans les deux modélisations selon lesquelles est construite l’Analyse Statistique Implicative un modèle de Poisson et un modèle binomial l’un et l’autre convergeant vers le même modèle gaussien Une règle d’exception en Analyse Statistique Implicative RNTI X Nous avons évoqué une approche complémentaire pour la détection de ces règles qui se base sur les travaux menés ces dernières années sur les R règles Gras et Kuntz 2005 La construction associée d’une hiérarchie implicative n’a pas été initialement développée dans ce but Cependant elle constitue une piste à explorer tant d’un point vue algorithmique que méthodologique concernant l’interprétation de ce qui pourraient être des R règles d’exception Références Agrawal R Imiliensky T et Swami A 1996 Mining association rules between sets of items in large databases Proc of the ACM SIGMOD’93 p 679 696 AAAI Press Bruhat G 1959 Optique Masson Paris Couturier R Gras R 2005 CHIC Traitement de données avec l’analyse implicative Extraction et Gestion des Connaissances Volume I1 RNTI Cepadues Paris p 679 684 Gras R 1979 Contribution à l’étude expérimentale et à l’analyse de certaines acquisitions cognitives et de certains objectifs didactiques en mathématiques Thèse d’Etat Rennes 1 Gras R et H Ratsimba Rajohn 1996a Analyse non symétrique de données par l’implication statistique RAIRO Recherche Opérationnelle 30 3 217 232 Gras R S Ag Almouloud M Bailleul A Larher M Polo H Ratsimba Rajohn et A Totohasina 1996b L'implication Statistique La Pensée Sauvage Grenoble Gras R Kuntz P et Briand H 2001 Les fondements de l’analyse statistique implicative et quelques prolongements pour la fouille de données Mathématiques et Sciences Humaines n° 154 155 pp 9 29 Gras R Kuntz P et Régnier J C 2004 Significativité des niveaux d’une hiérarchie orientée en analyse statistique implicative Numéro spécial Classification Revue des Nouvelles Technologies de l’Information Cépaduès Gras R 2005 Panorama du développement de l'A S I à travers des situations fondatrices Actes de la 3ème Rencontre Internationale A S I Supplément n° 15 de la Revue Quaderni di Ricerca in Didattica p 9 33 Université de Palerme Gras R et Kuntz P 2005 Discovering R rules with a directed hierarchy Soft Computing A fusion of Foundations Methodologies and Applications vol 10 n°5 p 453 460 Kuntz P 2005 Classification hiérarchique orientée en ASI Actes de la 3ème Rencontre Internationale A S I Supplément n° 15 de la Revue Quaderni di Ricerca in Didattica p 53 62 Université de Palerme Lehn R 2000 Un système interactif de visualisation et de fouille de règles pour l’extraction de connaissances dans une base de données Thèse de doctorat Université de Nantes Lebart L Piron M et Morineau A 2006 Statistique exploratoire multidimensionnelle 4ème édition Science sup Dunod I R Gras et al RNTI X Lenca P Meyer P Vaillant P Picouet P et Lallich S 2004 Evaluation et analyse multi critères de qualité des règles d’association Mesures de qualité pour la fouille de données RNTI E 1 Cépaduès p 219 246 2004 Lent B Swami A N et Widow J 1997 Clustering association rules Proc of the 13th Int Conf on Data Engineering p 220 231 Lerman I C 1981a Classification et analyse ordinale des données Dunod Lerman I C R Gras et H Rostam 1981b Elaboration et évaluation d'un indice d'implication pour données binaires Mathématiques et Sc Humaines n°74 5 35 Suzuki E et Kodratoff Y 1999 Discovery of surprising exception rules based on intensity of implication Principles of data mining and knowledge discovery science Springer p 184 195 1999 Suzuki E et Zytkow J 2005 Unified algorithm for undirected discovery of exception rules Int J of Intelligent Systems vol 20 Wiley p 673 694 Summary In Rule Mining some exceptional situations are contrary to the common sense a → c and b → c and a et b → non c These rules are called exception rules Following the precursory work of E Suzuki and Y Kodratoff we study the conditions in which these rules appear in the framework of the Implicative Statistical Analysis S I A Une règle d’exception en Analyse Statistique Implicative RNTI X Annexe Nous avons construit un fichier fictif de 200 sujets sur lesquels nous observons les variables binaires a b a ∧ b c et non c Voici les 20 premières lignes du tableau Ce sont les 4 premières qui vont principalement intervenir dans l’apparition de la règle d’exception sujets a b a ∧ b c nonc 1 1 1 1 0 1 2 1 1 1 0 1 3 1 1 1 0 1 4 0 1 0 0 1 5 1 0 0 1 0 6 0 1 0 1 0 7 1 0 0 1 0 8 0 1 0 1 0 9 1 0 0 1 0 10 0 1 0 1 0 11 1 0 0 1 0 12 0 1 0 1 0 13 1 0 0 1 0 14 0 1 0 1 0 15 1 0 0 1 0 16 0 1 0 1 0 17 1 0 0 1 0 18 0 1 0 1 0 19 1 0 0 1 0 20 0 1 0 1 0 … … … … … … 