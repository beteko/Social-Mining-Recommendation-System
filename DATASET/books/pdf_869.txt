 Recherche de motifs spatio temporels de cas atypiques pour le trafic routier urbain Marc Joliveau � Florian De Vuyst � � Laboratoire Mathématiques Appliquées aux Systèmes ECP Grande Voie des Vignes 92295 Chatenay Malabry cedex France marc joliveau ecp fr florian de vuyst ecp fr Résumé Un large panel de domaines d’application utilise des réseaux de cap teurs géoréférencés pour mesurer divers évènements Les séries temporelles four nies par ces réseaux peuvent être utilisées dans le but de dégager des connais sances sur les relations spatio temporelles de l’activité mesurée Dans cet article nous proposons une méthode permettant d’abord de détecter des situations atypiques au sens de l’occurrence puis de construire des motifs spatio temporels relatant leur propagation sur un réseau Le cas étudié est ce lui du trafic routier urbain Notre raisonnement se fonde sur l’application de la méthode Space Time Principal Component Analysis STPCA et de la combi naison entre l’information mutuelle et l’algorithme Isomap Les résultats expérimentaux exécutés sur des données réelles de trafic routier dé montrent l’efficacité de la méthode introduite à identifier la propagation de cas atypiques fournissant ainsi un outil performant de prédiction de la circulation intraday à court et moyen terme 1 Introduction Durant les dernières décennies l’utilisation de réseaux de capteurs a été largement déve loppée pour mesurer et observer l’évolution de systèmes complexes à forte dynamique Les applications sont par exemple le trafic routier le transport d’énergie les processus d’entreprise et la météorologie Dégager des liens de corrélations dans un tel réseau à travers le temps per met par exemple d’établir des prévisions probabilistes à court ou moyen terme Dans ce qui suit on suppose que les capteurs effectuant des mesures sur le trafic routier urbain sont fixes et géoréférencés Un graphe de connexion logique représente les échanges ou les causalités directes possibles entre ces différents lieux géographiques Le graphe est supposé connu A l’aide d’un outil d’estimation efficace on peut prédire le comportement usuel du trafic de vant chaque capteur Cependant lorsque la circulation est atypique au sens de l’occurrence la qualité des prévisions s’en retrouve considérablement affectée Nous proposons d’identifier des motifs spatio temporels de propagation de ces cas atypiques ayant pour objectif d’aider à prévoir les conséquences d’un évènement inhabituel sur l’intégralité du réseau Les motifs se réfèrent généralement à des structures répétitives sur le graphe sous jacent dans Recherche de motifs spatio temporels de cas atypiques pour le trafic l’espace et le temps Des motifs décrivant des changements dans l’espace et le temps sont quali fiés de motifs spatio temporels spatiotemporal patterns La notion de motifs spatio temporels apparaît dans différents secteurs scientifiques tels que les géosciences Knopoff et al 2001 la météorologie Tourre et al 1999 Imfeld 2000 ou l’écologie Weigand et al 1998 Généralement on utilise des techniques d’analyse et de fouilles de données spatio temporelles discrètes pour identifier ces motifs dans de grands ensembles Tsoukatos et Gunopulos 2001 Bittner 2001 Dans cet article nous proposons dans un premier temps un outil permettant de détecter les comportements atypiques Nous introduisons ensuite une méthode fondée sur la combinaison de l’information mutuelle Shannon et Weaver 1963 et de l’algorithme Isomap Tenenbaum et Langford 2000 calculant une première version des motifs de propagation que nous tentons d’améliorer par la suite Les tests expérimentaux sont effectués sur des données réelles de trafic routier intra urbain Ces données nous ont été fournie par l’INRETS dans le cadre du projet CADDY norma ecp fr wikimas Caddy de l’ACI Masse de données 2003 2 Détection de cas atypiques 2 1 Définition d’une variable d’état de circulation continue Dans Joliveau et De Vuyst 2007 nous avons proposé une adaptation de la méthode Space Time Principal Component Analysis STPCA à un ensemble de données incomplètes calcu lant des estimations de séries temporelles définies pour chaque instant de mesure L’utilisation de cette méthode sur nos données de trafic intra urbain nous a permis de dégager un ensemble complet de données de débit et de taux d’occupation provenant d’un réseau de capteur Le débit moyen de véhicule nombre de véhicules instant correspond à la quantité de véhicules étant passés dans la zone d’activité du capteur lors du dernier intervalle de mesure Le taux d’occu pation exprimé en pourcentage symbolise quant à lui la densité de la circulation Plus le taux d’occupation est élevé plus la circulation est dense Une première difficulté est de combiner ces deux informations afin de posséder une variable ayant un sens pour l’état du trafic La loi fondamentale du trafic provenant de la théorie du transport indique la relation entre le flot et la densité des véhicules sur une route A partir du diagramme représentatif de cette loi nous proposons une nouvelle variable � continue sur � ����� � nous informant sur l’état de circula tion à un capteur et un instant donné Cette variable combine à la fois les informations de débit et de taux d’occupation et nous apporte une certaine intelligibilité sur le trafic � symbolisant un trafic inexistant � un trafic congestionné à débit nul et �� � une circulation optimale avec débit maximal Sur la figure 1 on peut voir les représentations de séries temporelles journalières d’état de cir culation obtenues pour deux capteurs choisis aléatoirement Nous avons également illustré les séries de débit et de taux associées 2 2 Estimation du comportement moyen et détection de situations inha bituelles La méthode STPCA définie dans De Vuyst et Joliveau 2007 offre un moyen de résumer efficacement des séries temporelles tout en conservant la majeure partie de l’information au M Joliveau et F De Vuyst 0 5 10 15 20 25 0 200 400 600 800 1000 1200 1400 1600 1800 2000 Capteur 1 Temps heure D eb it n b ve hi cu le s 0 5 10 15 20 25 0 10 20 30 40 50 60 70 80 90 100 Temps heure Ta ux d o cc up at io n % 0 5 10 15 20 25 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 0 Temps heure E ta t d e ci rc ul at io n 0 5 10 15 20 25 0 200 400 600 800 1000 1200 1400 Capteur 2 Temps heure D eb it n b ve hi cu le s 0 5 10 15 20 25 0 10 20 30 40 50 60 70 80 90 100 Temps heure Ta ux d o cc up at io n % 0 5 10 15 20 25 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 0 Temps heure E ta t d e ci rc ul at io n FIG 1 – Exemple de séries temporelles d’état de circulation pour capteurs ligne3 Les séries de débit ligne 1 et de taux d’occupation ligne 2 correspondantes sont également illustrées sur la figure sens de l’énergie L’énergie est obtenue par la trace des matrices de corrélation � définie par ����� ��������� ����� ��� �� � " � � �%� où � � ��� représente la i ème valeur propre de � et le nombre de vecteurs propres Le principe de la STPCA est de procéder simultanément à une analyse en composantes princi pales dans les deux dimensions spatiales et temporelles Les paramètres de réduction de dimen sion ' et sont réglés en fonction de l’énergie capturée respectivement par les modes prin cipaux spatiaux et temporels représentatifs de l’activité usuelle dans l’ensemble de données Les figure 2 a et 2 b illustrent respectivement l’énergie cumulée par les premiers modes sur 1 5 10 15 20 25 30 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 0 Modes spatiaux Indices des valeurs propres E ne rg ie c um ul ee 1 5 10 15 20 25 30 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 0 Modes temporels Indices des valeurs propres E ne rg ie c um ul ee a b FIG 2 – Énergie cumulée des valeurs propres a spatiales et b temporelles les dimensions spatiale et temporelle lorsqu’on applique la STPCA aux données d’état Sur Recherche de motifs spatio temporels de cas atypiques pour le trafic chacune de ces deux dimensions le premier mode capture plus de +* de l’énergie En outre les ' �� premiers modes spatiaux sur �+�0 possibles ainsi que les 1�%2 premiers modes temporels sur *+� possibles contiennent à eux seuls plus de 3 � 4�3 de l’énergie dans les deux dimensions Une telle proportion de l’énergie suffit à reproduire très fidèlement les comporte ments les plus fréquents du trafic Nous proposons donc d’estimer les données par STPCA en paramétrant ' et de manière à capturer la majorité de l’information au sens de l’énergie dans nos expériences nous fixons le seuil minimal à + � 4�3 de l’énergie Pour détecter un comportement atypique il suffit de comparer la valeur réelle à son estimée par STPCA Si l’écart entre ces deux valeurs est élevé cela signifie que l’activité actuelle au capteur n’est pas représentative de la situation usuelle On détecte alors un comportement atypique au sens de l’occurrence Notre raisonnement est illustré sur la figure 3 On remarque que les deux courbes étant très 0 5 10 15 20 25 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 0 Capteur 1 0 5 10 15 20 25 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 0 Capteur 2 0 5 10 15 20 25 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 0 Capteur 3 FIG 3 – Détection de comportement atypique en utilisant la STPCA Les données réelles saisies par les capteurs sont représentées en pointillé les estimées par une ligne en noir proches la série issue du capteur � est représentative du comportement usuel journalier à cette localisation En ce qui concerne les deux autres capteurs on peut identifier certaines périodes où l’activité est plus atypique Pour le capteur par exemple on remarque que les valeurs mesurées entre �6587 et 8�37 sont largement supérieures à leur estimation Ces mesures relèvent un trafic surchargé inhabituel à cette période de la journée Il ne faut cependant pas confondre évènement atypique et congestion Par exemple bien que le capteur 9 illustre certaines courtes périodes de congestion qui ne sont pas habituelles vers 37 et ��2 7 on peut également obser ver un écart entre les deux courbes en fin d’après midi L’estimation nous indique que le trafic est habituellement chargé sur cette période l’état de circulation est supérieur à �� 4� Or les mesures réelles relèvent une activité plus fluide que d’habitude Dans ce cas le comportement atypique détecté correspond à une fluidité inhabituelle du trafic Dans le cadre où on cherche à établir des prévisions sur le trafic à court ou moyen terme l’utilisation de la STPCA sur la variable � est un outil très pratique Si l’écart entre la valeur mesurée par un capteur et son approximation est faible on se réfère à la série estimée par l’algorithme STPCA pour établir notre prévision Dans le cas contraire on détecte un com portement atypique On s’appuiera alors sur des motifs spatio temporels de propagation pour prédire la circulation M Joliveau et F De Vuyst 3 Recherche de motifs spatio temporels Les motifs intraday que nous cherchons à identifier ont pour but de nous aider à faire des prévisions sur le trafic Ceux ci se focalisent plus particulièrement sur l’anticipation de la propagation d’une situation atypique à travers le réseau La propagation d’une situation atypique sur un réseau est une notion de voisinage locale en espace et en temps indiquant sur quels points du réseau on observe un comportement atypique suite à la réalisation d’un évènement inhabituel à l’instant précédent FIG 4 – Exemple d’un motif spatio temporel se propageant sur 9 instants successifs La figure 4 représente un exemple de motifs spatio temporels de propagation sur un petit réseau de � capteurs au cours de 9 instants successifs Les motifs peuvent être représentés par une chaîne ou un graphe décomposable en niveau dans lequel chaque niveau correspond à un instant de mesure chaque sommet symbolise un capteur à un instant donné et un lien entre deux sommets représente la propension de propagation d’une situation atypique d’une période à la suivante Les arcs peuvent être pondérés par la tendance de propagation Sur cet exemple de motif la détection d’une circulation inhabituelle au capteur en � nous incite à anticiper une situation atypique aux capteurs et à la période suivante Deux outils principaux sont utilisés pour identifier les motifs spatio temporels de propagation l’information mutuelle Shannon et Weaver 1963 et l’algorithme Isomap Tenenbaum et Langford 2000 3 1 L’information mutuelle L’information mutuelle est tirée de la théorie des probabilités et de la théorie de l’infor mation Cette quantité mesure la dépendance statistique entre deux variables L’information mutuelle mesurant la quantité d’information apportée en moyenne par une réalisation d’un évè nement sur les probabilités de réalisation d’un évènement et en considérant qu’une dis tribution de probabilité représente notre connaissance d’un phénomène aléatoire on peut me surer l’absence d’information en utilisant l’entropie de Shannon Shannon et Weaver 1963 de cette distribution Ainsi l’information mutuelle est donnée par < � =�> ���A � B�DCE � F� ���A � B�HGI � �DCE � =�J � Recherche de motifs spatio temporels de cas atypiques pour le trafic où � B� et � K� mesurent l’entropie respective des évènements et et � =�J � l’en tropie croisée entre ces évènements L’information mutuelle est comprise entre � et � Plus sa valeur est élevée plus les évènements sont liés une information mutuelle de � étant synonyme d’évènements indépendants L’information mutuelle est utilisée dans une grande variété de domaines comme la fouille de données l’imagerie ou la biologie moléculaire pour déterminer des relations dans le compor tement de variables Dans Liang et al 1998 par exemple les auteurs utilisent l’information mutuelle afin de détecter des liens d’inférence permettant de dégager des connaissances sur la régulation des gènes 3 2 Isomap Isomap est une méthode introduite par Tenenbaum et Langford 2000 dont l’objectif est d’identifier la structure cachée dans des observations multivariées de grandes dimensions Le principe de cette méthode est de projeter les points d’un ensemble de données dans un espace de plus faible dimension L’avantage d’Isomap est que contrairement aux méthodes classiques telles que l’analyse en composantes principales ACP ou l’échelonnement multidimension nel multidimensional scaling MDS l’algorithme est capable de découvrir des relations non linéraires régissant certaines observations complexes Une fois le plongement ou embedding calculé la distance entre deux points sur celui ci est représentative de la similitude globale entre les évènements mesurés par ces points Isomap se décompose en trois étapes définies de manière détaillée dans le tableau 1 Lors de la première étape on cherche à déterminer pour chaque élément les points qui lui sont le plus proche en fonction d’une distance LNM �PO �RQ � définie entre une paire de points O et Q dans l’es pace d’origine On peut au choix utiliser un rayon de distance préfixé S ou calculer les K plus proches voisins de chaque élément Cette relation de voisinage permet de construire un graphe T où un arc pondéré par la distance LNM �UO �RQ � relie chaque point O à l’ensemble de ses voisins Q Une fois le graphe T déterminé les distances géodésiques entre chaque paire de point de l’en semble sont calculées en déterminant les valeurs LWV �PO �XQ � des plus courts chemins entre chaque paire de sommet de T Dans le résumé de la méthode nous proposons d’utiliser l’algorithme de Floyd de complexité polynomiale Y �PZH[ � Z étant le nombre de sommets La dernière étape d’Isomap consiste à appliquer un MDS classique à la matrice des distances du graphe \]V^�`_0L3V �UO �RQN�ba �4c afin de construire un plongement dans un espace d de dimen sion L qui préserve au mieux l’estimation de la géométrie intrinsèque de l’espace On introduit l’opérateur e convertissant les distances en produits internes qui caractérisent uniquement la géométrie des données dans une forme compatible à une optimisation efficace e � \]�f�gCh�0i+ Ijlknmoj où kHm est la matrice des distances au carré _ � k"m��qpsrK�%\ ��4c a et j représente la "matrice de centrage" _tj �sc �Au �sc Cv�6iw xa étant le nombre d’observations Les coordonnées des vecteurs y � des points de d sont choisies en minimisant une fonction de coût z|{�} ~ e � \]V��DCBe � \� ~ 1 M Joliveau et F De Vuyst TAB 1 – Algorithme de la méthode Isomap Étape 1 Construction du graphe de voisinage Définir le graphe  en connectant les points et  si N3 �P8 est plus petit que  ou si  est un des K plus proches voisins de relativement à + Pondérer les arcs par la valeur 33 �P8 2 Calcul des plus courts chemins Initialiser 3 �P8H83 P6 si et  sont reliés par un arc + �P6HF sinon Ensuite pour Hb> remplacer+ �P6 par hsWw+ �P6J�+ � �=+DU�P6 La matrice des valeurs finales ¡¢£F + �P8 contient les distances des plus courts chemins entre chaque paire de points de  3 Construction du plongement Soit ¤3¥ la p ième valeur propre triées en ordre décroissant de la matrice ¦§U¡|H et ¨ª©¥ la i ème composante du p ième vecteur propre On affecte à la p ième composante des coordonnées du vecteur © de dimension  la valeur p ¤+¥�¨ª©¥ où \ représente la matrice des distances euclidiennes _tLW¬ �UO �RQN�� ~ y � CFy c ~ a et ~ ­B~ la norme de Frobénius de la matrice ­ donnée par ® ¯ �P° c ­ ��sc Le minimum global du problème de minimisation 1 est obtenu en affectant les L premiers vecteurs propres triés dans l’ordre décroissant de la matrice e � \]� aux coordonnées de y � 3 3 Construction des motifs spatio temporels 3 3 1 Calcul de motifs d’origine Afin de construire une première version de motifs spatio temporels de propagation de com portement atypique dans un réseau nous appliquons l’algorithme Isomap en utilisant l’infor mation mutuelle comme mesure de distance LNM �UO �RQN� sur l’ensemble des données d’origine L’information mutuelle ne se calculant que dans un cadre discret et la variable étudiée étant continue sur � ���� � nous décidons de la symboliser pour la discrétiser Pour cela nous propo sons sept états quantifiés de circulation – " ± " calme peu de véhicules circulant circulation nocturne typique – " ²�T´³ " Tendance à la grande circulation état intermédiaire entre ± et T´³ avec une tendance à l’augmentation du trafic – " � ± " Retour au calme état intermédiaire entre ± et Tµ³ avec une tendance à la diminu tion du trafic – " T´³ " Grande circulation état correspondant à une circulation quasi optimale un débit très élevé mais pas d’engorgement – " ¶·� " Saturation de niveau 1 correspond à une petite congestion le débit de véhicule diminue alors que le taux d’occupation augmente – " ¶ " Saturation de niveau 2 correspond à une congestion assez grosse les véhicules circulent lentement et le trafic est très chargé – " ¶9 " Saturation de niveau 3 le trafic est quasiment ou totalement saturé et les véhicules à l’arrêt Recherche de motifs spatio temporels de cas atypiques pour le trafic La transformation de la variable � à sa version symbolique est appliquée à l’aide d’intervalles ainsi que pour certains états par le signe de la dérivée de la série temporelle à l’instant me suré Le tableau 2 renvoie les seuils utilisés pour symboliser les séries Cette discrétisation a TAB 2 – Calcul des symboles à partir des données � Symbole Valeur de ¸ en ¹ Signe de la dérivé en ¹ c ¸AºB + ¼ rc + ¼¾½B¸AºB + ¿6À négatif TGC 8 ¼¾½B¸AºB + ¿6À positif GC 8 ¿0ÀÁ½B¸AºB + Àt¼ S1 + À�¼Á½E¸ÂºB + Ã S2 + ÃÁ½B¸AºB + Ä S3 ¸AÅB + Ä été choisie dans le but de calculer les dépendances entre les capteurs en fonction d’informa tions intelligibles et utiles pour un utilisateur L’application d’Isomap avec l’information mutuelle sur les données journalières en différen ciant chaque période nous fournit autant de plongements que d’instants de mesure Sur chaque plongement les distances entre les points chaque point symbolisant un capteur sont repré sentatives des similitudes de comportement entre les capteurs à une période donnée On norme les distances sur chaque plongement en fonction de la plus grande distance sur le plongement Ainsi pour chaque instant on possède une distance de similitude comprise entre � et � Nous construisons une première version de motifs spatio temporels à partir des plongements fournis par Isomap Pour chaque période � pour chaque capteur O on identifie les capteurs les plus proches de O sur le plongement correspondant à la période � G� et on relie ces deux couples capteur instant par un arc De cette manière on obtient un graphe du même type que sur la figure 4 représentant les premiers motifs de propagation de cas atypiques La notion de capteur le plus proche peut être définie par un rayon de distance minimale S ou par l’algorithme des K plus proches voisins Dans nos expériences nous avons combiné les deux approches en choisissant les K plus proches voisins dans un rayon de S 3 3 2 Amélioration des motifs Suite à la combinaison d’Isomap et de l’information mutuelle on dispose de premiers mo tifs spatio temporels de propagation pouvant être représentés par une chaîne reliant les capteurs d’un réseau entre les périodes de mesure Nous proposons de pondérer les arcs de cette chaîne par la tendance de propagation du caractère atypique Pour cela on simule le déroulement du temps en détectant les cas atypiques par le procédé ex pliqué dans la section 2 et on calcule les probabilités Æ �PÇ cJ° ÈUÉ � Ç �P° È � qu’il y ait un évènement atypique en Q à l’instant � GÂ� sachant qu’il y a un évènement atypique en O à l’instant � Cette valeur considérée comme la tendance de propagation sert à pondérer les arcs �UO �RQ � de la chaîne des motifs A partir de ces tendances de propagation deux types d’amélioration peuvent être appliquées aux motifs D’un coté on peut retirer les capteurs dont la tendance de propagation est trop faible c’est à dire inférieure au seuil de probabilité final Ê�Ë�Ì M Joliveau et F De Vuyst D’un autre coté on cherche également à agréger aux motifs certains capteurs qui seraient sus ceptibles d’augmenter la qualité des prédictions Dans cet objectif nous définissons les notions de voisins directs et indirects Les voisins directs d’un couple capteur temps �UO � � � sont les couples capteurs temps � Q3� � GI�0� liés au premier couple dans la chaîne des motifs Les voisins indirects de �UO � � � sont les voisins directs issus des voisins directs de �PO � � � dont la tendance de propagation est élevée c’est à dire supérieure au seuil de voisinage ÊÎÍ Le calcul des voisins indirects est itératif Si un voisin indirect renvoie une tendance de propa gation suffisamment forte on l’ajoute aux motifs puis on le considère comme un voisin direct lors de l’itération suivante 4 Expériences numériques Les expériences ont été réalisées à partir du jeu de données réelles de trafic routier urbain fourni par l’INRETS dans le cadre du projet CADDY Le jeu de données utilisé considère les valeurs de débit et de taux d’occupation issues de �+�0 capteurs sur ���+� jours de semaine Les mesures ont lieu toutes les 9 minutes A partir de ces données on déduit les séries temporelles d’état de circulation pour la même quantité de jour et de capteur à une échelle temporelle identique 4 1 Expériences sur l’ensemble des données Un taux d’échantillonage des séries temporelles fixé à 9 minutes nous permet de tester notre méthode d’identification de motifs à court terme Dans nos expériences différents éléments de mesure vont être calculés – La moyenne de faux positifs FP par alarme Cette valeur est calculée par le ratio entre le nombre total de faux positifs anticipation erroné d’une situation atypique et le nombre total de situations atypiques – La moyenne de faux négatifs FN par alarme Cette valeur est calculée par le ratio entre le nombre total de faux négatifs évènement atypique non anticipé et le nombre total de situations atypiques – L’efficacité moyenne Cette variable calculée par le ratio entre le nombre de situations atypiques prévues et le nombre total de situations atypiques réelles renvoie le pourcen tage de cas atypiques anticipés à bon escient Ces trois mesures sont calculées en simulant des prévisions en temps réel sur l’intégralité des données à partir des motifs identifiés par la méthode Le tableau 3 indique les résultats obtenus par la prévision de situations atypiques à l’aide des motifs de propagation calculés selon diffé rentes valeurs des paramètres Ê�Ë�Ì et Ê§Í La colonne "voisins directs" correspond aux résultats obtenus à l’aide de la première version des motifs tandis que la colonne "voisins indirect" se réfère à la méthode avec les améliorations On remarque que la solution basée sur l’utilisation exclusive des voisins directs déjà de bonne qualité permet de prévoir jusqu’à *+���b�3 des si tuations atypiques avec un taux de faux positifs acceptable Bien que notre but soit de prévoir la propagation de cas atypiques au sens de l’occurrence il nous faut distinguer les éléments atypiques reproductibles des éléments atypiques trop ponctuels Le réglage du seuil Ê§ËÌ per met de gérer ce compromis De son coté l’ajout des voisins indirects augmente la précision Recherche de motifs spatio temporels de cas atypiques pour le trafic Avec Ï ¥ Ð x Voisins directs Voisins IndirectsÏWÑ·x ÏWÑ·x + Ä ÏNÑ·I 8 Ò moyenne de FP par alarme t ¼�Ó ¼8 0Ä t Ó0Ä � ¿0Ò moyenne de FN par alarme + ¼ +s Ä +swÓ 8swÒ Efficacité moyenne en % Ót 8 À Ó0¼8 Ä Ó0¼8 ¼ Ó8t Avec Ï ¥ Ð x + ¼tÀ Voisins directs Voisins IndirectsÏWÑ·x ÏWÑ·x + Ä ÏNÑ·I 8 Ò moyenne de FP par alarme + Ô0¼ + ¿3 + ÔtÒ 8 Ô+ moyenne de FN par alarme + ¼8 +swÒ +swÒ 8 ¼� Efficacité moyenne en % Ä�Ò8 À Ó+t Ót + Ã Ó� + Avec Ï ¥ Ð x + ÄtÀ Voisins directs Voisins IndirectsÏWÑ·x ÏWÑ·x + Ä ÏNÑ·I 8 Ò moyenne de FP par alarme + tÓ + tÓ + tÓ 8 tÓ moyenne de FN par alarme + ¿0Ô + ¿0Ô + ¿0Ô 8 ¿0Ô Efficacité moyenne en % ÀtÄ6 ÀtÄ8s ÀtÄ8s À�Ä8 TAB 3 – Résultats obtenus sur l’ensemble des données ���+� jours avec un échantillonnage de 9 minutes pour différentes valeurs du seuil de probabilité final Ê�Ë�Ì et du seuil de voisi nage Ê§Í au niveau de l’efficacité de prédiction permettant un gain de � avec Ê�ËÌ�ÕÊ�Í=�Õ� Il faut cependant le paramétrer de manière à ne pas trop augmenter le nombre de faux positifs engendrés 4 2 Apprentissage sur un échantillon Entraînement sur À� jours Test sur w t jours moyenne de FP par alarme + ÔtÓ 8 ¿t moyenne de FN par alarme +swÒ 8 ¼�¼ Efficacité moyenne en % Ó+ts ÄÓ+ Ô TAB 4 – Résultats obtenus à court terme 9 minutes en entraînant l’algorithme sur �8� jours puis en le testant sur l’ensemble des dates avec ÊªÍ�A�� 45 et ÊWËÌK�A�� 4 +� Le but de notre travail étant de déterminer des motifs spatio temporels afin de réaliser des prévisions en temps réel nous aimerions estimer les facultés d’apprentissage de notre méthode Pour cela nous sélectionnons aléatoirement un échantillon de nos données et nous procédons aux différentes étapes de notre méthode à partir de cet échantillon détermination des modes principaux calcul de l’information mutuelle détermination des premiers motifs avec Isomap amélioration des motifs Finalement on teste les capacités de prédiction des motifs extraits de l’échantillon sur l’intégralité des données Le tableau 4 illustre les résultats obtenus en utilisant un échantillon de �8� jours et en fixant les valeurs des paramètres à Ê§Íh�A�� s5 et ÊWË�Ì �A�� 4 +� L’efficacité de prédiction reste élevée 58*� 9 M Joliveau et F De Vuyst par rapport à *+�� 2N lorsque les motifs sont calculés sur l’intégralité des données alors que la quantité de faux positifs demeure acceptable La figure 5 illustre un extrait des motifs identifiés dans ce cadre La partie gauche de la figure FIG 5 – Illustration d’un extrait des motifs spatio temporels de propagation représente la topologie du réseau les capteurs étant représentés par des carrés les routes par des traits gris clairs et les cours d’eau par des traits fins noirs La partie droite illustre un morceau de la chaîne de motifs correspondant aux instants entre 587� 3* et 5+7§�8 L’importance de la tendance de propagation est symbolisée par l’épaisseur des flèches 4 3 Prévisions à moyen terme En modifiant l’échantillonnage temporel on peut appliquer notre méthode sur des épisodes plus longs Le tableau 5 illustre les résultats de la méthode à moyen terme sur des épisodes de l’ordre du quart d’heure obtenus à partir d’un échantillon de �8� jours choisis aléatoirement avec Ê Í �Ö�� s5 et Ê Ë�Ì �A�� 4 3� L’efficacité est légèrement altérée mais reste tout à fait acceptable 2 �W 2 avec une proportion Entraînement sur À� jours Test sur w t jours moyenne de FP par alarme + ÔtÒ 8 ¿+ moyenne de FN par alarme + Ô0¼ 8 Ô¿ Efficacité moyenne en % ÃtÓ+ ¼ ÃtÀ8 Ã TAB 5 – Résultats obtenus à moyen terme �t� minutes en entraînant l’algorithme sur �+� jours puis en le testant sur l’ensemble des dates avec Ê�Ëµ�A�� s5 et ÊNË�Ì �A�� 3� de faux positifs similaire aux prévisions à court terme 5 Conclusion Dans ce papier nous avons proposé une méthode de génération de motifs spatio temporels de situations atypiques Cette méthode s’applique principalement à des données issues d’un réseau de capteurs fixes géoréférencés Nous utilisons l’algorithme STPCA comme outil de prévision du comportement usuel de séries temporelles issues d’un réseau de capteurs nous permettant également de détecter les situations atypiques Nous avons également introduit une méthode d’identification de motifs spatio temporels de propagation de situations atypiques fondée sur la combinaison d’Isomap et de l’information mutuelle Ces motifs ont pour fonction Recherche de motifs spatio temporels de cas atypiques pour le trafic d’aider à réaliser des prévisions à court et moyen terme sur le réseau Les expériences numériques réalisées sur un ensemble de données réelles de trafic routier ont su démontrer la qualité des motifs en terme de prédiction et les facultés d’apprentissage de la méthode à court et moyen terme Références Bittner T 2001 Rough sets in spatio temporal data mining In Workshop on Temporal Spatial and Spatio Temporal Data Mining pp 89–104 De Vuyst F et M Joliveau 2007 Space time principal component analysis for multivariate time series MAS Lab Research Rapport 0604 mas ecp fr download_publication php type=techreport referenc%e=0604 file=url Imfeld S 2000 Time points and space towards a better analysis of wildlife data in gis In Disserta tion University of Zürich Joliveau M et F De Vuyst 2007 Space time summarization of multisensor time seires case of missing data In Int Workshop on Spatial and Spatio temporal data mining IEEE ICDM To appear Knopoff L A Gabrielov et M Ghils 2001 IMA Workshops on Spatio Temporal Patterns in the Geosciences University of Minnesota Liang S S Fuhrman et R Somogyi 1998 Reveal a general reverse engineering algorithm for infe rence of genetic network architectures In Pacific Symposium on Biocomputing Volume 3 pp 18–29 Shannon C et W Weaver 1963 The Mathematical Theory of Communication University of Illinois Press Tenenbaum J et J Langford 2000 A global geometric framework for nonlinear dimensionality reduc tion Science 290 2319–2323 Tourre Y B Rajagopalan et Y Kushnir 1999 Dominant patterns of climate variablility in the atlantic ocean during the last 136 years Journal of Climate 12 2285–2299 Tsoukatos I et D Gunopulos 2001 Efficient mining of spatio temporal patterns In Proc of Ä8×Ø Int Symp on Spatial and Temporal Databases pp 425–442 Weigand T K Moloney et S Milton 1998 Population dynamics disturbance and pattern evolution Identifying the fundamental scales of organization in a model ecosystem The American Natura list 152 321–337 Summary A wide variety of application domains uses sensors networks to measure differents events Times series returned by such networks can be then used to extract knowledge on activity spatio temporal relationships In this paper we introduce a method able to detect non typical situations and then to build spatio temporal patterns given information about their propagation in the network Our idea is based on the application of the so called Space Time Principal Component Analysis STPCA method and the combination between mutual information and Isomap algorithm Experimental tests applied on real life road trafic data demonstrate the ability of the proposed method to identify spread of non typical cases giving an accurate tool to make prediction of the circulation at short term and mid term 