 PerForecast un outil de prévision de l’évolution de séries temporelles pour le planning capacitaire Colin Leverger Régis Marguerie Vincent Lemaire Thomas Guyet Simon Malinowski Orange Labs {prenom nom} orange com IRISA Rennes {prenom nom} irisa fr Univ Rennes INRIA CNRS IRISAr AGROCAMPUS OUEST IRISA UMR 6074 Résumé Nous présentons PerForecast un outil qui vise à automatiser le pro cessus de planning capacitaire en utilisant des données temporelles univariées et des modèles prédictifs configurés automatiquement L’objectif est d’antici per les problèmes de dimensionnement dans les infrastructures d’Orange qui assurent la délivrance d’un service aux clients Il s’agira par exemple de prévoir au plus tôt la surcharge d’un serveur afin de commander en avance de nou velles machines avant la détérioration du service considéré Les démarches de dimensionnent et d’achat étant longues et coûteuses plus elles sont effectuées tôt meilleure sera la qualité de service 1 Introduction Les logiciels et services d’une entreprise sont souvent hébergés sur des serveurs infor matiques Ces derniers ont une capacité limitée et fixe Par exemple il arrive qu’un serveur devienne sous dimensionné lorsque le nombre de clients augmente au fil du temps Dans ce cas il faut commander de nouveaux serveurs les installer et les configurer Ces actions sont à la fois longues et coûteuses Avoir des machines surdimensionnées est également possible si une application n’utilise au maximum que 2% des capacités d’un serveur cela signifie que le travail pourrait être fait par un serveur beaucoup plus petit et donc beaucoup moins cher L’an ticipation de l’installation de nouvelles infrastructures est une tâche qui s’appelle le planning capacitaire Wang et Nguyen 2017 et elle se démocratise depuis quelques années Le planning capacitaire est une vraie valeur ajoutée en entreprise lorsqu’il évite l’interrup tion inopinée de certains services Un site web qui fait défaut à un utilisateur a de fortes chances de ne pas être revisité par la suite c’est donc une perte de clients que les entreprises cherchent à éviter La plupart des serveurs physiques ou virtualisés remontent périodiquement des don nées techniques souvent stockées et exploitées par un gestionnaire de supervision Celles qui concernent l’évolution de l’utilisation de la mémoire RAM ou des processeurs sont de très bons indicateurs de la bonne santé d’un matériel et les afficher permet de vérifier l’état d’un hardware en temps réel Un serveur qui consomme 100% de sa mémoire RAM pourra en effet être ralenti indisponible et ne plus rendre le service escompté 455 PerForecast un outil d’automatisation de planning capacitaire Les experts en performance connaissent les limites physiques des serveurs mais il leur est difficile de savoir avec précision la date à laquelle elles seront atteintes Utiliser des modèles prédictifs avec les données collectées permettrait d’avoir une meilleure vision de l’évolution des points de mesure et d’évaluer les échéances Ces données assimilées à des séries tempo relles peuvent donc être exploitées pour effectuer des prédictions Le rôle des modèles prédic tifs sera d’analyser les tendances et leurs directions Visualiser ensuite de manière simultanée ces séries temporelles ainsi que leurs prédictions associées permet à l’expert de discerner une échéance à laquelle un serveur risque d’atteindre ses limites physiques de fonctionnement Il devient alors possible d’anticiper la commande et l’installation des serveurs pour gagner du temps et pour assurer une meilleure qualité de service C’est dans ce contexte que nous présentons l’outil PerForecast Il automatise le processus de planning capacitaire en offrant à l’utilisateur le moyen i de téléverser ses données uni variées sur un site web ii d’effectuer des prédictions simplement en cliquant sur un seul et unique bouton iii d’analyser les résultats grâce à un affichage dynamique des courbes pré dites Ce logiciel se décompose en cinq modules et utilise quatre modèles prédictifs qui seront explicités ci dessous 2 Architecture de PerForecast PerForecast est une application composée de 5 modules c f Figure 1 Le module 1 per met à l’utilisateur de téléverser ses fichiers univariés sur une interface web avant de lancer le processus de prédiction Les fichiers doivent avoir un format prédéfini ils doivent comporter l’en tête date val et les colonnes doivent être séparées par un point virgule FIG 1 – Architecture technique de PerForecast Respecter le format des données est important pour que le module 2 puisse i préparer les données reçues sur l’interface ii formater les dates et les valeurs numériques iii stocker et référencer les données brutes dans une base de données NoSQL iv lancer les prédictions Les données présentant des ruptures sont souvent plus difficiles à traiter La modification plus ou moins brusque d’une tendance ou d’une moyenne dans une série temporelle peut biai ser les prédictions car les modèles ne sont pas tous capables de considérer les ruptures comme 456 C Leverger et al telles Il est alors important de détecter ces dernières pour s’en affranchir et améliorer la robus tesse de nos prédictions Le module 3 utilise donc la technique des fenêtres glissantes Bondu et Boullé 2011 pour détecter les ruptures dans les données Pour chaque nouveau jeu de données plusieurs modèles prédictifs vont être alimentés tes tés et comparés dans le module 4 Celui qui aura les meilleures performances sera affiché en bout de chaîne à l’utilisateur Les données sont donc fournies aux différents modèles prédic tifs par le module 3 directement sous le bon format Les modèles sont les suivants i le modèle ARIMA sans considérer aucune saisonnalité ii le modèle ARIMA en considérant une possible saisonnalité Box et al 2015 iii le modèle ETS pour Error Trend et Seasonality modèle suivant un framework de lissage exponentiel iv le modèle TBATS également un modèle suivant le framework de lissage exponentiel mais supportant de mul tiples saisonnalités ainsi que des saisonnalités complexes Hyndman et Khandakar 2008 Les modèles i et ii sont configurés automatiquement grâce à R les modèles iii et iv n’ont pas besoin de paramètres particuliers Les modèles sont enfin comparés grâce au critère AIC Akaike Information Critera Le modèle avec la plus petite valeur pour AIC sera considéré comme le plus précis et sera alors affiché à l’utilisateur D’autres indicateurs seront étudiés par la suite de nos travaux Le module 5 de PerForecast stocke et affiche les données calculées Une base de données spécialisée dans les données temporelles est déployée pour le stockage des informations Elle est directement utilisée par une interface web cf Figure 2 pour l’affichage des résultats FIG 2 – Interface graphique d’affichage des résultats Les trois premiers modules sont développés dans le langage Scala Le troisième module uti lise également un classifieur issu du logiciel Khiops Boullé 2016 pour détecter les ruptures dans les données temporelles Le quatrième module utilise une librairie qui porte le langage R dans une librairie Scala cela facilite l’industrialisation du code R en créant une interface entre les deux langages Enfin le cinquième module est composé d’un agrégat de deux produits libres utilisés pour stocker les résultats base de données NoSQL InfluxDB spécialisée dans le stockage des données temporelles qui offre un langage de requêtage riche et des performances intéressantes et les afficher interface utilisateur Grafana 3 Cas d’usage PerForecast a été testé avec des données fournies par Orange Money Ce projet phare du groupe permet aux usagers de s’échanger de l’argent sur la base d’un simple SMS et il connaît 457 PerForecast un outil d’automatisation de planning capacitaire une nette croissance depuis deux ans ce porte monnaie virtuel est maintenant déployé dans seize pays africains Nous disposions des données représentant le nombre maximum de per sonnes connectées à chaque serveur sur 1 semaine sur une durée de 4 années Les valeurs numériques varient de 0 à 150 avec des tendances globalement montantes Les limites des systèmes sont par ailleurs connues des experts métiers et intégrées directement dans l’outil d’affichage sous la forme de lignes horizontales rouges et oranges pour l’analyse des résultats par les opérateurs 4 Conclusion Nous avons présenté PerForecast un outil qui vise à automatiser le planning capacitaire dans l’entreprise Orange Cet outil est d’ores et déjà utilisé par les services d’Orange dans le cadre de preuves de concept Plusieurs axes d’amélioration sont envisagés Nous souhaitons par exemple rendre l’outil entièrement automatique PerForecast pourrait se brancher sur des systèmes existants en limitant les actions humaines Ensuite le traitement de données multiva riées est important pour avoir une vision d’ensemble de tous les indicateurs d’un serveur sur un seul tableau de bord Enfin la découverte des corrélations entre différents indicateurs sans a priori ni connaissance métier pourrait améliorer la précision des alertes Références Bondu A et M Boullé 2011 A supervised approach for change detection in data streams In Proceedings of International Joint Conference on Neural Networks pp 519–526 Boullé M 2016 Khiops Outil d’apprentissage supervisé automatique pour la fouille de grandes bases de données multi tables In Actes de la conférence Extraction et Gestion des Connaissances pp 505–510 Box G E G M Jenkins G C Reinsel et G M Ljung 2015 Time series analysis forecasting and control John Wiley Sons Hyndman R J et Y Khandakar 2008 Automatic Time Series Forecasting the forecast Package for R Journal of Statistical Software July 27 3 Wang K j et P H Nguyen 2017 Capacity planning with technology replacement by sto chastic dynamic programming European Journal of Operational Research 260 2 739– 750 Summary We present PerForecast a tool that aims at making the process of capacity planning au tomatic by using univariate time series datasets to make predictions Those predictions are based on classical predictive models They are all compared to select the best one – the one we display to the customer The objective is to anticipate the sizing of Orange infrastructures in order to predict the power loss of a server and to order new machines in advance Indeed those procedures are long and costly and the sooner the better for our Quality of Services QoS 458 