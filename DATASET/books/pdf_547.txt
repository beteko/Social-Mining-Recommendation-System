 Intégration de données haptiques brutes dans des systèmes experts de diagnostic des connaissances Sébastien Lallé Vanda Luengo Laboratoire LIG MeTAH Grenoble prénom nom imag fr Résumé Cet article a pour cadre un environnement informatique pour l’appren tissage humain EIAH dédié à la chirurgie orthopédique et plus précisément sur le diagnostic des connaissances des apprenants Pour ce faire un réseau bayésien infère à partir d’exercices que les étudiants réalisent sur un simulateur avec bras articulé Ce réseau résulte d’une approche centrée expert du domaine comme très souvent dans les EIAH Pourtant dans un domaine comme la chirurgie où les connaissances sont tacites le geste de l’apprenant semble intéressant à consi dérer Le but de nos travaux est donc d’adopter une démarche plus centrée sur les données en incorporant au réseau bayésien les données haptiques continues issues du simulateur Divers problèmes se posent néanmoins d’une part sur le besoin d’étudier la nature des données pour conserver la généricité du système et d’autre part pour trouver des méthodes de validation pertinentes concernant leur traitement 1 Introduction L’analyse des connaissances est depuis longtemps une composante essentielle du domaine de l’apprentissage humain notamment via le développement d’environnement informatique pour l’apprentissage humain EIAH Le but étant de proposer à des apprenants des outils informatiques qui permettent en leur proposant exercices et problèmes de déterminer s’ils connaissent et utilisent de manière valide les connaissances à mettre en œuvre afin de leur pro poser la rétroaction la plus pertinente possible Bien sûr ces applications sont très dépendantes du domaine mathématiques physique linguistique dans cet article nous allons nous in téresser plus précisément à la chirurgie orthopédique à travers un projet d’EIAH nommé TE LEOS TELEOS propose une plateforme d’apprentissage qui comporte un simulateur avec bras articulé lequel permet à des internes de réaliser des exercices de chirurgie à partir des traces des données qui sont observées le système diagnostique ensuite les connaissances mises en jeu de façon valide ou invalide afin de proposer un retour à l’apprenant sous forme de renvoi à un cours d’autres exercices de consultation des cas cliniques etc Nous nous intéressons ici au diagnostic sa mise en œuvre est compliquée puisque les connaissances ne sont pas tangibles dans la tête si bien que l’on ne peut déterminer avec Données haptiques pour le diagnostic des connaissances certitude si elles sont correctement utilisées De plus dans le domaine qui nous intéresse elles sont souvent tacites c’est à dire innées ou acquises et difficile à définir formellement Donc pour modéliser cette incertitude le diagnostic des connaissances repose dans TELEOS sur un réseau bayésien dynamique Cependant c’est un réseau centré expert où des spécialistes en didactique et médecine ont identifié les connaissances puis défini les tables de probabilités du réseau bayésien 1 1 Motivations Le simulateur étant basé sur un bras robotisé qui collecte des données de vitesse de posi tions dans l’espace il paraît intéressant de passer à une approche plus centrée donnée pour le diagnostic Les motivations nous paraissent nombreuses – réduire le rôle subjectif de l’expert – gérer les formulations imprécises des connaissances empiriques et tacites par exemple la vitesse ne doit pas être trop rapide dans un corps peu dense – réduire les erreurs d’interprétation – affiner le diagnostic – pouvoir aisément tester et valider différentes approches automatiquement c’est à dire augmenter la flexibilité L’approche centrée donnée est encore récente dans les EIAH parce qu’elle implique des méthodes de data mining et d’apprentissage dont la validation s’avère compliquée Les avan tages en ont cependant été montrés à de nombreuses reprises dans des domaines d’apprentis sage non professionnel en ce qui concerne l’apprentissage de paramètres ou de poids d’un modèle ici notamment les probabilités du réseau bayésien nombreuses et soumises à l’im précision de l’expert Quant aux données issues du bras articulé elles sont de nature haptiques la science du toucher brutes c’est à dire directement fournie par un outil mécanique sans information sémantique associée À notre connaissance l’utilisation de données de cette nature pour le diagnostic des connaissances n’a jamais été expérimentée Nous pouvons apporter plusieurs raisons à cela – les domaines d’application sont complexes – le type de connaissances associées à des paramètres haptiques ne peut être qu’empirique et tacite ce qui est fréquent en médecine – la valeur de ces données dépend de l’instance de l’exercice courante manque de géné ralité 1 2 États de l’art On trouve dans les EIAH trois approches pour modéliser un réseau bayésien de diagnostic des connaissances M Mayo 2001 La première est l’approche centrée expert dans laquelle un spécialiste donne la structure et les tables de probabilités elle a cependant pour inconvé nients de souvent produire trop de variables aléatoires dans le réseau pour pouvoir inférer en un temps raisonnable ainsi que de rendre difficile l’estimation des probabilités Par exemple S Lallé et V Luengo dans DT Tutor R C Murray 2000 cette approche fut un problème dans l’évaluation du réseau La seconde approche est centrée efficacité le modèle est simplifié ou restreint de telle manière que ce sont les connaissances du domaine qui doivent s’y adapter Le but est d’amé liorer l’efficacité c’est à dire diminuer la complexité et ou les temps de calcul Comme pointé par Mayo et Mitrovic l’inconvénient est que les restrictions apportées peuvent introduire des simplifications ou des assertions erronées sur le domaine Enfin la troisième approche est centrée donnée c’est à dire que la structure et les tables de probabilités du réseau sont apprises automatiquement à partir de données Ce type de mo dèle permet de se dispenser des variables cachées car liées à l’expertise du domaine pour se concentrer sur les relations entre les données observées Mayo et Mitrovic indiquent cependant dans leurs travaux qu’un grand nombre de données observées est nécessaire pour la pertinence du modèle appris À notre connaissance aucun travail ne se ramène à notre approche d’analyse des don nées haptiques en vue de diagnostiquer les connaissances Pour être plus précis l’on trouve divers expérimentations qui recoupent partiellement notre sujet Premièrement les interfaces haptiques commencent a être utilisées dans les EIAH avec un but pédagogique comme l’ap prentissage de l’écriture J Bluteau 2008 mais les données n’y sont pas analysés et seules les courbes d’apprentissage finales sont mesurées L’autre partie de notre approche c’est à dire adopter une démarche centrée donnée dans les EIAH est un sujet récent mais étudié comme discuté ci dessus cependant les données traitées ne sont pas de type haptiques brutes Le traitement par des méthodes de data mining des informations haptiques en vue d’en déduire des connaissances est donc un verrou auquel nous nous sommes intéressés Dans la suite de cet article nous allons tout d’abord présenter plus en détail le projet TE LEOS et le réseau bayésien qui ont servi de cadre pour notre travail Ensuite nous présenterons les moyens et méthodes étudiés pour incorporer les données haptiques et nous proposerons quelques méthodes d’analyse des résultats afin de déterminer la validité et l’intérêt des mé thodes expérimentées Enfin nous situerons ce travail par rapport à l’état actuel de la recherche dans ce domaine 2 Contexte TELEOS et le diagnostic des connaissances Bien que ce travail ne s’intéresse spécifiquement qu’à la prise en compte de données hap tiques une présentation plus générale du projet est nécessaire à la bonne compréhension des motivations de ce travail Le projet TELEOS Technology Enhanced Learning Environment for Orthopaedical Sur gery L Vadcard 2004 soutenu par l’ANR 1 a pour objectif principal de favoriser l’ap prentissage de gestes percutanés en chirurgie orthopédique Pour ce faire nous tentons d’ana lyser les caractéristiques propres aux connaissances empiriques déclaratives et perceptivo gestuelles dans l’enseignement de la chirurgie orthopédique de façon à pouvoir déterminer les modèles de représentation de connaissances les plus appropriés 1 Code du projet ANR 06 BLAN 0243 Données haptiques pour le diagnostic des connaissances Par ailleurs les opérations chirurgicales orthopédiques percutanées se décomposent en deux notions distinctes le geste chirurgical et le repérage de l’outil chirurgical par le biais des ra diographies Effectivement lors d’une intervention dite mini invasive le chirurgien est capable de repérer la trajectoire de son outil grâce aux radiographies prises tout au long de l’opération et grâce aux pressions ressenties lors de la progression de l’outil dans le corps Ce sont ces deux composantes principales qui sont implémentées dans le simulateur indépendamment du type d’opération simulé A Larcher 2010 Du point de vue d’un outil dit de diagnostic des connaissances nous avons besoin d’un modèle de connaissance Dans TELEOS les connaissances sont le résultat d’une analyse di dactique de l’activité en chirurgie orthopédique et ont été formalisées par un modèle didactique nommé cKc L Vadcard 2005 L’idée de ce formalisme est de modéliser les conceptions à travers quatre ensembles Balacheff 1995 – un ensemble P de problèmes – un ensemble O d’opérateurs qu’il est possible d’utiliser pour résoudre un problème de P pour nous des actions – un ensemble Σ de contrôles pour nous de connaissances à appliquer pour valider ou invalider le résultat de l’application d’un opérateur – un ensemble L pour les systèmes de représentation utilisés dans la résolution par exemple les radiographies Ce que nous voudrons diagnostiquer dans ce modèle ce sont les contrôles Σ pour dé terminer si elles sont utilisées de manière valide ou non Ci dessous figure un exemple afin d’illustrer le formalisme Problèmes Opérateurs Représentations Contrôles Opération d’une vertèbre thoracique Prendre une radio de face Radio 2D Les pédicules doivent être centrés sur les radios Opération d’une vertèbre lombaire Impacter l’os Anatomie du corps 3D Si le trocart est en dessous des pédi cules alors il lèse les foramens vertébraux TAB 1 – Exemple de modèle cKc Ces quatre ensembles peuvent être intuitivement transposé en un réseau bayésien des connais sances qui permettra par la dimension dynamique de calculer le diagnostic V Minh Chieu 2009 tel que représenté ci dessous figure 1 La question le calcul d’inférence posée au réseau sera toujours de la forme soit une action effectuée par un étudiant représentés par les nœuds verts du réseau pour un problème donné représentés par les nœuds jaunes les connaissances associées nœuds gris sont elles bien utilisées au bon moment S Lallé et V Luengo FIG 1 – Détail du réseau bayésien On retrouve les problèmes en jaune les opérateurs en bleu les contrôles en gris et les systèmes de représentation en rose Les nœuds ovales verts absent du modèle didactique servent à faire le lien avec le simulateur Dans la suite de cet article nous allons expérimenter la prise en compte de ces données haptique pour aller d’un modèle expert à un modèle plus basé sur les données 3 Incorporation des données haptiques FIG 2 – Exemple naïf de tra jectoire dans une vertèbre lom baire La nature des données haptiques est très dépen dante du domaine ici il s’agit de la force de la vi tesse et de la position la combinaison des trois per mettant de recréer la trajectoire de l’outil chirurgical dans la vertèbre Pour prendre en compte ces données il convient en premier lieu de considérer leur nature force et vitesse sont des données en une dimension tan dis que la position est en 3D coordonnées dans l’es pace Ces données étant de type continues leur intégration pose divers problèmes le comportement des courbes étant lié au comportement de l’humain ces dernières ne suivent pas une loi de probabilité De plus l’objectif de notre réseau de diagnostic n’est surtout pas de copier le geste de l’expert appelé système overlay dans le domaine des EIAH J F Nicaud 1988 différentes tra jectoires peuvent être valides Il faut donc que la prise en compte de ces données soit flexible Données haptiques pour le diagnostic des connaissances en gardant bien l’idée que nous cherchons à diagnostiquer des connaissances tacites D’un point de vue plus technique les nœuds continus dans les réseaux bayésiens ne peuvent avoir de fils discret ce qui est particulièrement contraignant dans un réseau de type diagnostic où les effets connus permettent d’en déduire les causes cachées Pour ces raisons cette étude s’est intéressée aux possibles discrétisations des données haptiques Dans la suite de cette sec tion nous allons présenter les techniques de discrétisation retenues en fonction de la nature des données c’est à dire d’abord à une dimension force et vitesse puis en trois dimensions trajectoire 3 1 Une dimension Les données à une dimension calculée par le robot sont la valeur de la force et de la vitesse de progression en fonction du temps La discrétisation de ces données n’est pas à première vue complexe d’autant plus que les limitations du bras robotisé permettent de borner les do maines de 0 à 3 Newtons Une méthode efficace et répandue consiste donc à utiliser des algorithmes de clustering type k moyennes Joita 2009 Trois questions sont alors posées quel algorithme choisir Quelle sensibilité au bruit En combien de sous ensembles faut il discrétiser Les diverses méthodes de clustering testés k means EM DBScan donnent des résultats très similaires — y compris en les relançant plusieurs fois ces algorithmes étant dépendants de leur initialisation — nous en concluons que nos traces sont facilement séparables Reste le nombre de clusters qui influera clairement sur le diagnostic À ce stade une approche statistique a été expérimen tée en cherchant à optimiser le taux de remplissage des sous ensembles De fait notre base de traces étant importante surtout vis à vis du bornage du domaine on peut fixer un seuil de pertinence à partir duquel un cluster ne recoupe plus assez de données Les deux tableaux ci dessous illustrent ce critère avec la force on constate qu’avec quatre clusters le plus petit sous ensemble ne recoupe que 2 % des données on estime alors qu’il est plus pertinent de demeurer à trois Cette approche numérique paraît cohérente car le volume des données traitées est ici très grand et l’intervalle des valeurs bien délimité Nombre de données cluster 1 193261 67 % cluster 2 29221 10 % cluster 3 64553 22 % TAB 2 – Répartition des données sur trois clusters Nombre de données cluster 1 176045 61 % cluster 2 5703 2 % cluster 3 77791 27 % cluster 4 27496 10 % TAB 3 – Répartition des données sur quatre clusters Il est intéressant de s’interroger sur la signification sémantique des clusters Sur le schéma 3 a on observe la séparation des traces abscisses en trois clusters selon leur valeur ordonnée intuitivement il est possible de dire que le cluster rouge signifie qu’il ne faut pas S Lallé et V Luengo forcer le bleu qu’il faut et le vert est une période intermédiaire de décision Ce jugement in formel après coup est cependant limité à notre capacité d’abstraction Par conséquent nous avons aussi expérimenté une discrétisation tout aussi statistique basée sur le comportement est ce que la force et ou la vitesse augmente diminue stagne Pour cela nous avons cal culé le coefficient directeur des courbes puis appliqué le même type de clustering Le résultat illustré par la figure 3 b est sensiblement équivalent en terme de nombre de clusters Leur interprétation sémantique après coup sera en revanche différente en vert sont représentés les moments de développement de force le coefficient directeur est élevé en rouge l’arrêt de l’effort et en bleu les périodes stables souvent au repos Au niveau de l’implantation pratique la discrétisation sur valeur est plus simple à mettre en place elle est aussi moins soumise à interprétation Expérimenter et valider l’outil de diag nostic permettra d’en mesurer pleinement l’impact a Discrétisation en trois clusters en tenant compte des valeurs b Discrétisation en trois clusters basés sur le comportement de la courbe FIG 3 – Exemple de discrétisation sur les mesures de la force 3 2 Trois dimensions Bien que nous pourrions théoriquement appliquer les mêmes méthodes de discrétisation pour les positions de l’outil chirurgical dans l’espace il est bien évident que leur nature ne le permet pas parce qu’elles sont dépendantes du patient une valeur absolue en x y z ne corres pond pas à la même chose d’un cas à un autre en d’autres termes une trajectoire parfaite chez un sujet pourra se révéler néfaste chez un autre Si l’on prend garde de bien analyser nos traces nous comprenons que nous cherchons en fait à discrétiser une trajectoire il est dès lors naturel de s’intéresser aux techniques de segmentation de trajectoire telles qu’on les trouve dans la littérature Essentiellement deux approches sont proposées La première propose de découper l’espace en grille et la seconde de déterminer des trajectoires de référence auxquelles toutes les autres se réduiront Bar Gera 2005 Comme la seconde approche ne permet ni généricité ni flexibilité par rapport au geste de l’expert nous devons considérer la première Données haptiques pour le diagnostic des connaissances FIG 4 – Discrétisation de trajectoire en 2D Sur la figure 4 est représenté un exemple en deux dimensions dans lequel le plan est segmenté par une grille il est alors possible de suivre la trajectoire case par case Cela fonctionne c’est bien mais qu’en est il de la généricité La réponse se trouve dans le côté médical du travail en effet pour chaque vertèbre les experts peuvent isoler une quinzaine de points d’intérêt c’est à dire des points de l’anatomie cruciaux pour les opérations orthopédiques de la vertèbre citons par exemple les coordonnées intérieures des pédicules entre les quelles se situe la colonne vertébrale soit une zone dangereuse En positionnant notre grille non pas de manière régulière comme sur l’exemple mais selon ces points d’intérêt nous garantissons la gé néricité La figure 5 est un exemple concret de la discrétisation selon cette méthode Quant à l’algorithme formel il est le suivant 1 pour chaque point d’intérêt de coordonnées a b c ajouter dans l’espace trois plans d’équations cartésiennes x=a y=b z=c 2 pour tous plans p1 et p2 supprimer p2 si ||x1| − |x2|| < e ||y1| − |y2|| < e ou ||z1| − |z2|| < e La seconde étape consiste à nous assurer que la distance entre deux plans ne soit pas infé rieure à un seuil de pertinence e estimé expérimentalement à 2 mm le but étant avant tout qu’il n’y ait pas de superposition FIG 5 – Segmentation 3D d’une vertèbre S Lallé et V Luengo Nous pouvons à présent insérer des nœuds haptiques dans le réseau de diagnostic suite à ces discrétisations figure 6 Nos ensembles discrets tels que définis ci dessus forment les valeurs des nœuds haptiques et la table de probabilité de ces derniers est de type déterministe c’est à dire que les poids du nœud ne peuvent prendre que la valeur 0 ou 1 puisque le traitement se fait sur les données envoyées par le simulateur et correspondant à la situation courante Ces variables agissent donc comme des entrées du réseau utilisées pour déterminer les valeurs des connaissances FIG 6 – Détail du réseau centré sur une connaissance avec la présence d’une partie haptique en rose qui se décompose en fait en trois nœuds force vitesse et position 4 Résultats Les résultats proposés visent à déterminer si l’injection de données haptiques dans une ar chitecture fortement centrée expert où chaque variable a un sens sémantique fort permet une amélioration ou un affinement du diagnostic inféré Pour ce faire des expériences ont été me nées auprès de chirurgiens et d’internes en médecine durant lesquelles il leur était demandé de réaliser une série d’opérations sur le simulateur À partir de trajectoires réalisées par les sujets nous avons centralisé une partie des données pour en calculer nos ensembles discrets Sur le reste nous avons appliqué les calculs d’inférence pas à pas premièrement avec le réseau expert et ensuite avec le réseau étendu aux nœuds haptiques dans le but de comparer les deux Données haptiques pour le diagnostic des connaissances FIG 7 – Courbe d’évolution de la validité d’une connaissance calculée par le réseau bayé sien avec et sans haptique Les paramètres ont été établis selon les connaissances à priori par exemple les bordures de l’os sont plus soumises à risque que le centre du corps vertébral En fin d’exercice les résultats de l’inférence sont très sensiblement les mêmes l’analyse didactique ayant mené au système expert étant suffisamment fine En revanche en étudiant la courbe d’évolution de la validité des connaissances au cours du temps on se rend compte que les données haptiques permettent une meilleure anticipation des événements cela est in fine logique puisqu’une erreur dans l’exercice résulte souvent d’une erreur plus en amont dans la trajectoire par exemple une force trop grande développée dans un os peu dense Nous cherchons donc à calculer ce que nous avons appelé le facteur d’anticipation c’est à dire le rapport à chaque temps t de la validité des connaissances sans et avec données haptiques La courbe 7 en est un exemple éclairant au temps t=4 un événement a permis au réseau de dé terminer avec une bonne certitude que la connaissance avait été bien utilisée par l’apprenant Au temps précédent nous constatons que le réseau haptique anticipe légèrement ce résultat puisqu’il estime la validité à p=0 35 alors que le réseau expert demeure plus incertain p=0 3 On a ainsi pu mettre en exergue sur nos traces des gains substantiels dans l’anticipation des évolutions positives ou non de la validité des connaissances sur plusieurs exercices nous avons calculé le rapport entre le résultat de l’inférence avec l’haptique sur le résultat sans haptique pour chaque connaissance Comme expliqué ci dessus nous n’avons considéré que les temps précédant un événement ou une action portant directement sur une connaissance afin de ne pas comparer le résultat final mais seulement l’anticipation permise avant un événement Par conséquent si le rapport est inférieur à un l’anticipation est mauvaise supérieure à un S Lallé et V Luengo elle est meilleure La moyenne des résultats est indiquée dans le tableau 4 Méthode Divergence Réseau sans haptique 1 Réseau avec clustering sur valeur 1 32 Réseau avec clustering sur comportement 1 44 TAB 4 – Comparatif du facteur d’anticipation selon les réseaux le cas sans haptique servant de référence 5 Discussion La méthode proposée ici pour l’intégration des données haptiques utilise principalement des techniques de data mining Bien que la question de la prise en compte de la sémantique des données ait été abordée avec la discrétisation sur le comportement des courbes il serait possible d’aller plus loin sur ce sujet par exemple en incluant des experts dans le cycle L’in térêt serait notamment de pouvoir comparer les résultats des discrétisations et l’influence sur le diagnostic Si la discrétisation est un moyen simple de prendre en compte ces données il est néanmoins évident que cela pose le problème de l’estimation des poids dans un réseau bayésien Très sou vent dans les EIAH c’est un expert qui donne les tables de probabilités liées aux nœuds Il devient donc nécessaire de mettre en place des techniques d’apprentissage des para mètres pour gagner en objectivité et en simplicité Dans le cadre de notre réseau bayésien nous avons testé diverses techniques classiques maximum de vraisemblance maximum a posteriori et algorithme EM en cas de manques Heckerman 1995 sur une base de traces constituée expérimentalement des étudiants ont réalisé des exercices sur le simulateur et un expert s’est chargé de diagnostiquer les connaissances Cet aspect bien qu’indirectement lié va de pair avec la prise en compte de données brutes Références A Larcher V Luengo J T 2010 Conception of a simulator for a TEL system in orthopaedic surgery Medecine and Surgery VRIC 2010 Balacheff N 1995 Conception propriété du système sujet milieu IREM de Clermont Ferrand Bar Gera H 2005 Continuous and Discrete Trajectory Models for Dynamic Traffic Assign ment Networks and Spatial Economics Heckerman D 1995 A Tutorial on Learning with Bayesian Networks Springer Berlin Heidelberg Microsoft Données haptiques pour le diagnostic des connaissances J Bluteau S Coquillart Y P E G 2008 Haptic Guidance Improves the Visuo Manual Tracking of Trajectories PLoS ONE J F Nicaud M V 1988 Les tuteurs intelligents réalisations et tendances de recherche Technique et Science Informatique vol 7 numéro 1 pp 21 45 Joita D 2009 Unsupervised Static Discretization Methods in Data Mining Titu Maiorescu University L Vadcard V Luengo J T D M A P M 2004 Le projet TELEOS Technological En hanced Learning Environment for Orthopaedic Surgery Congrès IPM Internet et Pédagogie Médicale L Vadcard V L 2005 Réduire l’écart entre formation théorique et pratique en chirurgie conception d’un EIAH Conférence EIAH M Mayo A M 2001 Optimising ITS Behavior with Bayesian Networks and Decision Theory International Journal of Artificial Intelligence in Education R C Murray K V 2000 DT Tutor A Decision Theoretic Dynamic Approach for Optimal Selection of Tutorial Actions Lecture Notes in Computer Science V Minh Chieu V Luengo L V 2009 Student Modeling in Orthopedic Surgery Training Exploiting Symbiosis between Temporal Bayesian Networks and Fine grained Didactical Analysis International Journal of Artificiel Intelligence in Education Summary This paper is based on an Intelligent Tutoring System ITS in orthopedic surgery This project includes a simulator with haptic device that allows to diagnosing the knowledge of the learner tanks to a bayesian network This network is the result of an expert approach yet in the domain of surgery knowledge usually are implied and gestures may give a lot of information on it Consequently this paper aims to take a more data centric approach by taking into account the continuous haptic data registered by the simulator directly into the bayesian network This idea raises issues first we need to keep the genericity of the model and then find some relevant ways for assessing the methods chosen 