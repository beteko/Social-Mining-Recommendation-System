 Reconnaissance automatique d’évènements survenant sur pa tients en réanimation à l’aide d’une méthode adaptative d’extraction en ligne d’épisodes temporels Sylvie Charbonnier* *Laboratoire d'Automatique de Grenoble BP 46 38402 St Martin d’Hères France tel 33 476 82 64 15 fax 33 476 82 63 88 email Sylvie Charbonnier inpg fr Résumé Ce papier présente la version adaptative d’un algorithme d’extraction d’épisodes temporels développé précédemment Les trois paramè tres de réglages de l’algorithme ne sont plus fixes Ils sont modifiés en ligne en fonction de la variance estimée du signal que l’on veut décomposer en épiso des temporels La version adaptative de l’algorithme a été utilisée pour recon naître automatiquement des aspirations trachéales à partir de plusieures varia bles physiologiques enregistrés sur des patients hospitalisés en réanimation Des résultats préliminaires sont présentés dans ce papier 1 Introduction Les patients hospitalisés en unités de réanimation sont soumis à une surveillance étroite de la part du personnel soignant Un grand nombre de variables physiologiques sont enregis trées en ligne à des fréquences élevées une mesure par seconde sur ces patients Ces enre gistrements produisent des flots de données temporelles importants que le personnel soi gnant doit analyser à chaque visite au patient Les services de réanimation sont en demande d’outils d’aide à l’interprétation de ce flot de données afin de limiter la charge cognitive que leur interprétation représente Calvelo et al 99 Lowe et al 01 Hunter and McIntosh 99 Afin d’aider le médecin dans sa tâche d’analyse des données nous avons développé une méthode d’extraction en ligne d’épisodes temporels permettant de transformer une série temporelle univariée en une succession d’intervalles décrivant l’évolution de la variable L’information fournie par la méthode est de la forme suivante la variable est stable de puis l’instant t1 jusqu’à l’instant t2 à la valeur v1 Elle est croissante de l’instant t2 à l’instant t3 de la valeur v1 à la valeur v2 … L’information fournie sur la tendance du signal {stable croissant décroissant} correspond au vocabulaire utilisé par les médecins pour décrire l’évolution d’un e physiologique La méthode d’extraction d’épisodes se règle à partir de 3 paramètres de réglages dont les valeurs dépendent des variables physiologiques traitées mais sont indépendants du patient ou de l’enregistrement l’hypothèse sous jacente étant que le bruit s’ajoutant sur une variable biologique ne dépend pas du patient mais de la variable monitorée Or dans la pratique cette hypothèse n’est pas toujours vérifiée La va riance des variables monitorés peut changer suivant l’état physiologique du patient ou le contexte des soins Par exemple la variance des variables respiratoires ex la fréquence respiratoire sera très différente suivant que le patient est en ventilation spontané ou en mode 137 RNTI E 6 Reconnaissance automatique d’évènements survenant sur patients en réanimation de ventilation contrôlé par le ventilateur Les informations sur la tendance à extraire ne sont alors plus les mêmes Une petite modification de la fréquence respiratoire pourra être por teuse d’information modification de l’état du patient si le patient est en mode de ventilation débit contrôlée alors qu’une modification du même ordre ne sera pas significative pour un patient en ventilation spontanée Actuellement pour que la méthode d’extraction d’épisodes temporels fonctionne de façon optimale il faut préciser le mode de ventilation du patient Le réglage d’un des paramètres de la méthode sera alors automatiquement divisé par 2 L’objectif de ce papier est de présenter la version adaptative de la méthode d’extraction d’épisodes et son utilisation pour reconnaître de manière automatique des aspirations tra chéales Les résultats obtenus par cette méthode sur des variables enregistrées sur des pa tients dans des contextes de soins différents seront présentés Dans un premier temps nous rappellerons le principe de la méthode d’extraction d’épisodes temporels puis nous présente rons les modifications apportées pour rendre la méthode adaptative Nous présenterons en suite quelques résultats obtenus en utilisant cette nouvelle méthode pour reconnaître des évènements particuliers à partir des signaux les aspirations trachéales 2 Extraction d’épisodes temporels en ligne La méthode d’extraction d’épisodes temporels se décompose en quatre phases successi ves Charbonnier 2005 décomposition en ligne des données en segments de droites classi fication des segments en 7 formes temporelles transformation des formes en épisodes tem porels semi qualitatives agrégation de l’épisode temporel courant avec les précédents 2 1 Décomposition en segments de droite Un algorithme de segmentation consiste à décomposer en ligne les données en une suc cession de segments de droite Charbonnier 2005 La technique utilisée pour déterminer l’instant où l’algorithme doit recalculer une nouvelle approximation linéaire est celle de la CUSUM qui correspond à une intégration numérique des différences entre le signal et l’extrapolation par la dernière droite calculée La valeur absolue de la cusum est comparée à chaque période d’échantillonnage à 2 seuils appelé th1 et th2 Si la CUSUM est inférieure à th1 l’approximation linéaire est acceptable Si la CUSUM est supérieure à th1 la valeur du signal et le temps correspondant seront stockés dans une liste appelée Liste des valeurs anormales Si la CUSUM est supérieure à th2 l’approximation linéaire n’est plus acceptable et une nouvelle approximation linéaire sera calculée par la méthode des moindres carrés à partir des données stockées dans la liste des valeurs anormales si la taille de la liste est supé rieure à 3 Dès qu’une nouvelle approximation linéaire a été calculée la cusum est remise à zéro La décomposition en segments de droite est essentiellement réglée par le seuil th2 Si th2 est petit les segments seront recalculés fréquemment et des petites oscillations dans le signal seront segmentées alors que si th2 est grand les segments seront plus longs et certains phénomènes transitoires seront filtrés 2 2 Classification en formes temporelles Chaque nouveau segment calculé par l’algorithme de segmentation associé au segment précédent constitue une forme qui peut être classée dans l’une des 7 catégories retenues 138 RNTI E 6 S Charbonnier stable croissant décroissant échelon positif ou négatif échelon positif transitoire croissant décroissant ou décroissant croissant La classification est effectuée en calculant des caractéristiques sur les segments diffé rence entre la fin du segment précédent et la fin du segment courant différence entre la fin du segment précédent et le début du segment courant différence entre le début du segment courant et la fin du segment courant Un arbre de décision permet le classement en 7 formes à partir d’un seuil de réglage thc Ce seuil correspond à la valeur à partir de laquelle une variation sur la variable sera considé rée significative Si la valeur d’une des 3 caractéristiques dépasse le seuil fixé thc la forme temporelle est du type croissant ou décroissant Sinon la forme est stable Si le seuil thc est grand les petites variations sont considérées comme non significatives et n’apparaissent pas dans les épisodes temporels extraits Seules les grandes variations sont exprimées sous forme d’épisodes 3 Les formes temporelles sont ensuite découpées en 1 ou 2 épisodes temporels élémen taires définis par trois grandeurs {stable croissant décroissant} 4 Les épisodes temporels courants sont ensuite agrégés avec les épisodes précédents La méthode est donc réglé par 3 paramètres th1 et th2 qui déterminent la segmentation du signal et thc qui fixe le niveau de variation à partir duquel une forme est considérée comme croissante ou décroissante plutôt que stable Dans la version non adaptative de l’algorithme ces seuils gardent une valeur fixe qui dépend de la variable à traiter et pour certaines variables respiratoires du mode de ventilation 3 Adaptation des seuils de réglages de l’algorithme d’extraction d’épisodes La variance des variables physiologiques peut varier en fonction du contexte de soins dé livrés au patient Afin de prendre en compte ce changement de variance sur les variables nous avons développé une version adaptative de la méthode d’extraction de tendance Les seuils th1 th2 et ths ne sont plus fixes et réglés en fonction du mode de ventilation mais s’adaptent en ligne en fonction de la variance estimée du signal 3 1 Estimation de la variance du signal L’estimation de la variance du signal s’effectue à partir des résidus On appelle résidus la différence à chaque période d’échantillonnage entre le signal et l’approximation linéaire calculé par l’algorithme de segmentation Cette différence résidu correspond à la partie du signal qui n’est pas expliquée par l’approximation linéaire La variance des résidus est alors estimée à chaque période d’échantillonnage sur une fenêtre glissante de 60 secondes et la médiane de la variance obtenues sur les x dernières secondes est calculée Nous noterons cette valeur Mx Nous avons choisi une fenêtre glissante de 60 secondes car c’est une durée suffisamment courte pour que l’hypothèse de stationnarité du signal reste plausible et suffi samment longue pour faire une estimation peu biaisée de la variance Le calcul final de la variance se fait par valeur médiane sur une fenêtre d’apprentissage de x secondes ce qui 139 RNTI E 6 Reconnaissance automatique d’évènements survenant sur patients en réanimation permet de filtrer les augmentations de variance dues à des artéfacts sur le signal La taille de la fenêtre x a été choisi égale à 300 secondes C’est un compromis entre la durée de l’information passée à prendre en compte et la sensibilité de la mesure Mx à des artéfacts sur le signal qui sont d’autant mieux filtrer que la période d’apprentissage est longue 3 2 Algorithme d’adaptation des seuils A chaque nouvelle segmentation de nouvelles valeurs sont affectées aux seuils th1 th2 et ths en fonction de la valeur de Mx La fonction d’adaptation que nous avons choisi est un cycle d’hystérésis 2 jeux de seuils { th1 th2 ths}important et { th1 th2 ths }faible sont applicables à l’algorithme Ils correspondent aux jeux optimaux de réglage quand la variance du signal est faible et quand elle est plus importante { th1 th2 ths }important correspondent aux valeurs de seuils proposés dans Charbonnier 2005 { th1 th2 ths }faible correspondent aux valeurs de { th1 th2 ths }important divisé par 2 L’utilisation d’un cycle d’hystérésis permet de limiter des alternances répétées entre les 2 jeux de réglages quand la mesure de Mx est proche du seuil de commutation 3 3 Choix des seuils de commutation Afin de ne pas augmenter trop fortement le nombre de seuils à régler sur l’algorithme les seuils de commutation Com1 et Com2 du cycle d’hystérésis ont été normalisés pour chaque variable physiologique à partir de la fonction de répartition de la variance des différentes variables La fonction de répartition de la variance des différentes variables physiologiques a été estimée à partir d’une ensemble d’enregistrements obtenus sur une vingtaine de pa tients différents La variance du signal a été estimée à chaque période d’échantillonnage en utilisant une fenêtre glissante de 60 secondes sur l’ensemble de ces enregistrements L’ensemble des mesures de variance calculées sur chaque enregistrement et sur une variable a été mis en commun et un tirage aléatoire a été effectué Un sous ensemble constitué du quart des valeurs de la base de données a été réalisé et a servi à estimer la fonction de réparti tion de la variance pour chaque variable physiologique La valeur correspondante au 95 ème percentile a été relevée pour chaque variable Les seuils de commutation du cycle d’hystérésis ont été choisis arbitrairement à 15% et 25% de la valeur du 95 ème percentile pour chaque variable physiologique Le jeu {th1 th2 et ths}faible est appliqué à l’initialisation de l’algorithme et est maintenu tant que la valeur de Mx ne dépasse pas 25% du 95 ème percentile Quand la commutation vers le jeu {th1 th2 et ths}important a eu lieu le jeu sera maintenu jusqu’à ce que la valeur de Mx devienne inférieure à 15% du 95 ème percentile 4 Résultats Nous avons appliquée la méthode adaptative sur l’ensemble de la base de données dont nous disposons La version adaptative de l’algorithme a été appliquée aux variables physio logiques suivantes Pression artérielle systolique PAS fréquence cardiaque FC pression 140 RNTI E 6 S Charbonnier maximale dans les voies aériennes Pmax débit maximal dans les voies aériennes Dmax volume expiré VE fréquence respiratoire FR ventilation minute VM Afin de valider les résultats obtenus nous avons utilisé les épisodes temporels extraits pour reconnaître un évènement particulier les aspirations trachéales Cette validation a été effectuée hors ligne L’algorithme a été appliqué sur chaque enregistrement sur l’ensemble des variables physiologiques et les épisodes temporels extraits ont été stockés Un algorithme de reconnaissance d’évènements a ensuite été appliqué qui utilise ces épisodes Une forme temporelle multivariable correspondant à une aspiration trachéale a été modé lisée de la manière suivante {épisode Décroissant sur Pmax ou VE ou VM dont la valeur finale est inférieure à une valeur seuil} et simultanément {transitoire décroissant_croissant ou instabilité sur Pmax VE VM FR Dmax } Un transitoire décroissant_croissant est une forme temporelle monovariable composé de 3 épisodes successifs stable décroissant crois sant ou décroissant croissant stable Une instabilité est un intervalle de temps où la va riance des résidus d’une variable est supérieure ou égale au 95 ème percentile Un indicateur de la certitude de la présence d’une aspiration trachéale est proposé en ajoutant une valeur à chaque forme temporelle monovariable Ainsi un transitoire décrois sant_ croissant et une instabilité ont une valeur de 1 Une chute a une valeur de 2 si la valeur finale est inférieure à un certain seuil et une valeur de 3 pour un seuil plus petit La valeur attribuée à une variable correspond à la valeur maximale relevé sur cette variable FIG 1 Exemple de détection d’aspirations trachéales sur un enregistrement FIG 2 Histogramme des valeurs associées aux 51 aspirations détectées par l’algorithme Une aspiration trachéale est reconnue si la valeur totale de l’événement somme des va leurs de toutes les variables observées simultanément est d’au moins 3 qu’au moins deux variables différentes interviennent dans le calcul de la valeur totale et qu’on a détecté au moins une chute sur une variable Ainsi pour reconnaître une aspiration trachéale la condi tion minimale est que soient présents simultanément une chute d’une des variables sous une valeur seuil et une instabilité ou un transitoire sur une autre variable valeur totale égale à 3 Une analyse quantitative des résultats est en cours qui permettra de préciser le nombre d’aspirations trachéales correctement reconnues non reconnues et faussement reconnues Elle nécessite l’analyse de tous les signaux par un observateur extérieur qui n’a pas encore été effectuée Un exemple provenant d’un enregistrement sur un patient hospitalisé en réani mation est présenté figure 1 La méthode a détecté 3 aspirations trachéales au cours des 4 heures d’enregistrement Les zones d’aspirations sont représentées par les étoiles en haut des variables 141 RNTI E 6 Reconnaissance automatique d’évènements survenant sur patients en réanimation Les résultats préliminaires obtenus sur les 25 enregistrements de la base de données sont les suivants 51 aspirations trachéales ont été détectées par l’algorithme 29 d’entre elles correspondent à des formes temporelles détectées sur au moins 3 variables et 22 à des for mes temporelles détectées sur 2 variables seulement La figure 2 présente l’histogramme des valeurs obtenues sur ces 51 aspirations 28 aspi rations trachéales ont été détectées avec une valeur d’au moins 5 Ces aspirations semblent concordantes avec l’analyse visuelle des signaux Les 23 autres sont plus difficiles à classer et pourraient correspondrent à des toux ou des périodes d’instabilité du patient La méthode est capable de détecter des aspirations trachéales aussi bien sur des patients ventilés en mode débit contrôlé que sur des patients en ventilation spontanée 5 Conclusion Dans ce papier nous présentons des travaux en cours de développement la version adaptative d’un algorithme d’extraction d’épisodes temporels L’extraction des épisodes se fait en ligne et les seuils de réglages de la méthode sont recalculés en cours d’extraction Des choix ont été effectués pour définir l’algorithme d’adaptation des seuils Les résultats partiels semblent montrer qu’il est possible de reconnaître des évènements particuliers les aspira tions trachéales à partir des signaux sans connaître à priori le mode de ventilation du pa tient Références Calvelo D Chambrin M C Pomorski D and Ravaux P 2000 Towards symbolisation using data driven extraction of local trends for ICU monitoring Artificial Intelligence in Medicine 1 2 203 223 Charbonnier S 2005 On Line Extraction of Temporal Episodes from ICU High Frequency Data a visual support for signal interpretation Computer Methods and Programs in Biomedicine 78 115 132 Hunter J McIntosh N 99 Knowledge based event detection in complex time series data AIMDM’99 Lecture Notes in Artificial Intelligence 1620 271 280 Lowe A Jones R Harrison M 2201 The graphical presentation of decision support in formation in an intelligent anesthesia monitor Artificial Intelligence in medicine 22 173 191 Summary An adaptive version of an algorithm able to extract on line temporal episodes from a sig nal is presented The algorithm is tuned by three tuning parameters which values are no longer fixed but change on line depending on the signal variance The adaptive version has been used to recognize tracheal suctions from several physiological parameters recorded on patients hospitalised in Intensive Care Preliminary results are presented in this paper 142 RNTI E 6