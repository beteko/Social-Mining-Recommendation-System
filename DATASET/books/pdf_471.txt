 L’extraction de règles de dépendance bien définies entre ensembles de variables multivaluées Frédéric Pennerath UMI 2958 GeorgiaTech CNRS Supélec 2 rue Édouard Belin 57070 Metz Résumé Cet article étudie la faisabilité et l’intérêt de l’extraction de règles de dépendance entre ensembles de variables multivaluées en comparaison du pro blème bien connu de l’extraction des règles d’association fréquentes Une règle de dépendance correspond à une dépendance fonctionnelle approximative carac térisée principalement par l’entropie conditionnelle associée L’article montre comment établir une analogie formelle entre les deux familles de règles et com ment adapter à l’aide de cette analogie l’algorithme Eclat afin d’extraire d’un jeu de données les règles de dépendance dites bien définies Une étude expéri mentale conclut sur les forces et inconvénients des règles de dépendance bien définies vis à vis des règles d’association fréquentes 1 Introduction Dans de nombreux problèmes de fouille de motifs les données à analyser forment une collection d’échantillons décrits par différents attributs multivalués appelés variables dans ce qui suit Un tel jeu de données est illustré par l’exemple simplifié de la figure 1 a Les motifs V1 V2 V3 V4 D1 a 1 oui 1 D2 c 2 oui 1 D3 b 1 non 1 D4 c 2 non 1 a Avec variables multivaluées V1 V1 V1 V2 V2 V3 V3 V4 = = = = = = = = a b c 1 2 yes no 1 D1 × × × × D2 × × × × D3 × × × × D4 × × × × b Avec items ou attributs monovalués FIG 1 – Interprétation mono ou multivaluée d’un même jeu de données les plus souvent recherchés dans ces données sont des itemsets un itemset est un ensemble d’attributs monovalués appelés items représentant chacun une des valeurs possibles d’une des variables multivaluées Un jeu de données défini sur un ensemble d’attributs multivalués peut être représenté de façon équivalente par des items comme illustré sur la figure 1 b Un itemset couvre une donnée si tous les items de l’itemset sont aussi des items de la donnée La fréquence d’un itemset est la proportion des données couvertes par celui ci Une question consiste alors 203 L’extraction de règles de dépendance bien définies à se demander quelles sont les paires d’itemsets disjoints H et C telles que C apparaît suffi samment fréquemment dans les données couvertes par H Cette question a été formalisée et résolue par le problème de l’extraction des règles d’association fréquentes [1] Indépendam ment de cette direction de recherche des méthodes ont été proposées pour fouiller directement des données multivaluées à l’aide des dépendances fonctionnelles approximatives voir par exemple [3 6] ou d’extensions de l’ACF voir par exemple [5] Une dépendance fonction nelle DF X → Y entre deux ensembles disjoints de variables X et Y traduit le fait que pour le jeu de données considéré les valeurs des variables de Y peuvent être déduites des va leurs des variables de X Une DF est approximative DFA si les valeurs de Y peuvent être déterminées à partir de celles de X avec un risque d’erreur faible en de ça d’un certain seuil exprimé en nombre d’exceptions à la règle nombre de valeurs indéterminées etc L’article propose un rapprochement entre les DFA et les règles d’association fréquentes comme cela a déjà été fait notamment dans [6] L’originalité de ce rapprochement est de reposer sur une analogie formelle simple et élégante mettant en bijection les concepts des motifs fréquents avec ceux associés aux ensembles de variables multivalués caractérisés par des mesures entro piques Les DFA sont ainsi caractérisées principalement par l’entropie conditionnelle et sont alors appelées dans ce qui suit des règles de dépendance entre ensembles de variables multi valuées pour souligner l’analogie formelle au cœur de cet article mettant en correspondance règles de dépendance et règles d’association L’article introduit ainsi un cadre théorique simi laire à celui des règles d’association pour fouiller les ensembles de variables multivaluées à l’aide des règles de dépendance dites bien définies puis propose H Eclat une adaptation de l’algorithme Eclat [7] pour extraire rapidement ces règles La section 2 commence ainsi par souligner l’analogie formelle entre les deux formes de règles La section 3 décrit les principes de H Eclat puis présente les résultats expérimentaux obtenus avant de conclure à la section 4 2 Les ensembles de variables bien définis Étant donné un ensemble fini V = {V1 Vm} de m variables multivaluées à domaine fini un jeu de données défini sur V est un ensemble de n données D = {Di}1≤i≤n où chaque donnée Di est un vecteur à m composantes associant une valeur Di V à chaque variable V de V comme illustré sur la figure 1 a Les éléments de V sont appelés des va riables atomiques Un ensemble de variables est défini comme un sous ensemble de variables atomiques Les valeurs d’un ensemble de variables V ⊆ V sont les combinaisons de va leurs des variables de V dans les données Formellement si on suppose les variables ato miques ordonnées selon un ordre d’indexation arbitraire i e Vi précède Vj si i < j et si le domaine DV d’une variable V désigne l’ensemble des valeurs que peut prendre V alors l’ensemble ou domaine DV des valeurs de l’ensemble de variables V = {Vi1 Vik} tel que i1 < · · · < ik est défini comme le produit cartésien DVi1 × · · · × DVik Une valeur de V est donc un tuple élément de DV Dans l’exemple de la figure 1 a b oui est une des six valeurs de D{V1 V3} = {a b c} × {oui non} Un tuple t = v1 vk valeur de V = {Vi1 Vik} couvre une donnée D si et seulement si D Vij = vj pour tout entier j va riant de 1 à k La couvertureCD t d’un tuple t dans les donnéesD est l’ensemble des données couvertes par V Dans l’exemple le tuple c 2 1 de {V1 V2 V4} a pour couverture {D2 D4} Les valeurs d’un ensemble de variables V définissent une partition des données la partition de données PD V de l’ensemble de variables V est définie comme l’union des couvertures 204 F Pennerath non vides CD t pour les différentes valeurs t de DV La partition de l’ensemble de variables V = {V1 V2} dans les données de la figure 1 a est {CV a 1 CV c 2 CV b 1 } soit {{D1} {D2 D4} {D3}} Un ensemble de variables V contiendra donc d’autant plus d’in formation qu’il permettra de partitionner les données c’est à dire de distinguer les données à partir des valeurs que peut prendre V Ainsi la variable V4 contient peu d’information puisque sa partition PD V = {{D1 D2 D3 D4}} ne permet pas de distinguer les données Cette quantité d’information peut se mesurer par l’entropie associée à une distribution qui dans le cas présent correspond à la distribution PV des valeurs de l’ensemble de variables V dans le jeu de données obtenue par le tirage aléatoire équiprobable d’une donnée quelconque de D L’en tropie notéeH V de cette distribution PV est égale àH V = − ∑ v∈DV PV v ·log2 PV v L’entropie d’un ensemble de variables V est toujours positive ou nulle Elle est nulle seulement si sa valeur est parfaitement déterminée i e il existe un tuple v ∈ DV tel que PV v = 1 Un tel ensemble est dit parfaitement défini Par extension l’entropie de l’ensemble de variables vide est fixée à zéro H ∅ = 0 Par ailleurs l’entropie ne peut être supérieure à log2 |D| où |D| désigne le nombre de données Cette propriété permet de définir une entropie relative Hr V d’un ensemble de variables V comprise dans l’intervalle unité égale au rapport de l’entropie absolue H V sur log2 |D| de la même manière que la fréquence relative est le rapport du support d’un itemset sur la taille du jeu de données Dans la suite le terme entropie peut faire référence à l’entropie relative ou absolue L’entropie est une fonction croissante dans l’ensemble 1 2V ⊆ des ensembles de variables ordonnés par la relation d’inclusion ∀V1 ∀V2 V1 ⊆ V2 ⇒ H V1 ≤ H V2 Du fait de cette dernière propriété et pour toute valeur seuil Hmax ≥ 0 le prédicat H V ≤ Hmax d’un ensemble de variables V est anti monotone dans l’ordre 2V ⊆ des ensembles de variables ordonnés par la relation d’inclusion Un ensemble de variables vérifiant ce prédicat est dit bien défini relativement à Hmax par analogie avec le caractère fréquent σ I ≥ σmin d’un item set I Par conséquent la recherche des ensembles de variables bien définis relativement à la valeur seuil Hmax qui consiste à calculer l’entropie de tous les ensembles de variables bien définis constitue un problème analogue au problème de la recherche des itemsets fréquents Ce problème a déjà été abordé dans le contexte plus spécifique des itemsets [2 4] où les itemsets bien définis sont appelés des motifs de faible entropie ou low entropy patterns Contrairement à l’entropie l’entropie conditionnelle tient compte d’une connaissance a priori étant don nés deux ensembles de variables disjoints V1 et V2 l’entropie conditionnelle H V1|V2 est définie comme H V1|V2 = H V1 ∪ V2 − H V2 Sa valeur est positive ou nulle Elle est nulle lorsque la valeur de V1 se déduit de la valeur de V2 L’entropie conditionnelle H Vc|Vh permet de déterminer quelle est l’incertitude résiduelle que présente un ensemble de variables conclusion Vc lorsque un ensemble de variables hypothèse Vh est connu Cette entropie exprime donc un lien de dépendance de Vh vers Vc autrement dit est une mesure associée à une règle Vh → Vc que l’on nomme règle de dépendance dans la suite Pour cette raison on notera Hc Vh → Vc l’entropie conditionnelle H Vc|Vh associée à la règle Vh → Vc L’entropie conditionnelle de Vh → Vc est une fonction décroissante de Vh et croissante de Vc dans l’ordre des ensembles de variables ordonnés par l’inclusion à l’inverse de la confiance conf Ih → Ic = σ Ic∪Ih σ Ih d’une règle d’association Ih → Ic qui est une fonction croissante de Ih et décroissante de Ic De ce parallèle s’ensuit le problème analogue de l’extraction des règles d’association fréquentes[1] dans le domaine de la fouille d’ensembles de variables étant 1 La notation 2E désigne l’ensemble des parties de l’ensemble E 205 L’extraction de règles de dépendance bien définies donnés un jeu de données et deux seuils d’entropieHmax etHcmax le problème de l’extraction des règles de dépendance bien définies consiste à calculer l’entropie conditionnelle des règles bien définies Vh → Vc telles que l’ensemble de variables Vh∪Vc est bien défini relativement à Hmax et que Hc Vh → Vc ≤ Hcmax Le cas Hcmax = 0 correspond à l’extraction des règles de dépendance dites parfaites dont l’entropie conditionnelle est nulle par analogie avec les règles d’association parfaites de confiance égale à un 3 L’extraction des règles de dépendance bien définies Le problème de l’extraction des règles de dépendance bien définies peut être résolu en deux étapes selon le même principe déjà employé pour extraire les règles d’association fréquentes à partir des motifs fréquents [1] les ensembles de variables bien définis sont d’abord fouillés dans les données avant d’être utilisés dans une seconde étape pour construire les règles de dé pendance bien définies Cette dernière étape peut être réalisée en apportant des modifications mineures à l’algorithme d’extraction des règles d’association fréquente [1] La principale dif ficulté réside donc dans le calcul de l’entropie des ensembles de variables bien définis tâche équivalente au calcul de la fréquence des itemsets fréquents Une possibilité est d’adapter les principes de l’algorithme Apriori [1] comme cela a déjà été fait notamment dans [3 2 4] Toutefois cette solution n’est pas privilégiée car l’approche par niveau d’Apriori est connue pour souffrir d’une consommation mémoire importante et d’un niveau de performance relati vement faible en pratique La solution proposée s’inspire de l’algorithme Eclat de recherche des itemsets fréquents [7] L’idée principale d’Eclat est d’utiliser un codage dit vertical du jeu de données et la propriété selon laquelle la couverture d’un itemset I est l’intersection des couvertures de tous les items i ∈ I H Eclat repose ainsi sur une propriété analogue à celle utilisée par Eclat selon laquelle la partition PD V1 ∪ V2 de l’union de deux ensembles de variables V1 et V2 est l’intersection PD V1 ∩ PD V2 des deux partitions de V1 et V2 2 Les principales différences avec Eclat sont que les itemsets sont remplacés par des ensembles de variables que la contrainte anti monotone σ I ≥ σmin devient H V ≤ Hmax et surtout que les couvertures des itemsets sont remplacées par des listes de parties c’est à dire des listes de couvertures représentant des partitions de données et dont l’intersection peut se calculer selon une complexité linéaire par rapport au nombre de données Les tests réalisés ont visé d’une part à estimer les performances de l’algorithme H Eclat et de l’extraction des règles de dépendance bien définies vis à vis de celles de l’algorithme Eclat et de l’extraction des règles d’association fréquentes et d’autre part à estimer qualitativement l’utilité des règles de dépendance bien définies par rapport aux règles d’association fréquentes La figure 2 a représente le temps de calcul exprimé en fonction du nombre de motifs décou verts sur les jeux de données mushrooms soybeans et vote pour différentes valeurs seuil Hmax et σmin Les temps de calcul moyens par motif croissent linéairement avec le nombre de motifs découverts comme cela était prévisible H Eclat est plus lent que Eclat car l’intersection de partitions est une opération plus complexe que l’intersection de deux ensembles Le rapport des performances dépend du jeu de données mais pas des valeurs seuil Cette relative lenteur est toutefois compensée par le nombre d’ensembles de variables à rechercher bien inférieur à celui des itemsets correspondants par exemple H Eclat extrait en 10 secondes tous les 217=131072 2 L’intersection de deux partitions est la plus grand partition incluse dans chacune des deux partitions une parti tion P1 étant incluse dans une partition P2 si toutes les parties de P1 sont incluses dans une des parties de P2 206 F Pennerath 10 0 10 2 10 4 10 6 10 8 10 −2 10 −1 10 0 10 1 10 2 10 3 10 4 Nombre de motifs T em ps d e ca lc ul s a Temps de calcul de H Eclat et Eclat fonction du nombre de motifs extraits 10 −1 10 010 0 10 2 10 4 10 6 10 8 10 10 Seuil Hc max ou 1−σ min N om br e de r èg le s pa rf ai te s dépend mushrooms assoc mushrooms dépend vote assoc vote dépend soybean−large assoc soybean−large b Nombre de règles de dépendance bien définies et de règles d’association fréquentes FIG 2 – Temps de calcul et nombres de règles ensembles possibles de variables pour le jeu vote pour Hrmax = 1 quand Eclat trouve pour le même temps de calcul 500K d’itemsets fréquents soit seulement 2 5% des 22 millions d’itemsets ayant une fréquence non nulle Le même phénomène est observé entre règles de dépendance bien définies et règles d’association fréquentes Ainsi selon la figure 2 b vote contient au total seulement 835 règles de dépendance parfaites Hcmax = 0 et H r max = 1 à comparer à un peu moins d’un million de règles d’association parfaites cmin = 1 et σmin = 0 Contrairement à la recherche des motifs bien définis ou fréquents les temps de calcul moyens pour extraire règles de dépendance ou d’association sont approximativement les mêmes car contrairement à la recherche des motifs bien définis ou fréquents l’algorithme utilisé est le même Du point de vue de l’extraction de connaissances les règles de dépendance permettent d’exprimer une information plus synthétique mais parfois aussi moins précise que celles des règles d’association Par exemple la règle de dépendance parfaite extraite du jeu de données mushrooms forme du pied taille des lamelles changement de couleur couleur des spores → comestibilité permet de prédire si un champignon est comestible ou non Cette seule règle équivaut à la donnée de 55 règles d’association parfaites ayant pour hypothèse les 55 jeux de valeurs que prennent dans les don nées les quatre variables composant l’hypothèse de la règle de dépendance D’un autre côté les règles d’association permettent une analyse à un niveau de granularité plus fin Ainsi la règle d’association parfaite forme de tige effilée pas d’odeur → comestible permet d’identifier un cas particulier de champignon comestible quand la règle de dépen dance forme de tige odeur → comestibilité n’est pas parfaite Règles de dé pendance et règles d’association apportent deux points de vues utiles et complémentaires 4 Conclusions Cet article compare et oppose les règles de dépendance entre ensembles de variables mul tivaluées aux règles d’association entre itemsets Les premières présentent ainsi l’avantage sur les secondes d’être moins nombreuses et plus synthétiques avec toutefois l’inconvénient d’être 207 L’extraction de règles de dépendance bien définies moins précises L’article suggère aussi en perspective que l’analogie formelle entre règles de dépendance et règles d’association fréquentes qui a permis d’adapter Eclat soit davantage exploitée pour adapter les nombreuses techniques développées dans le cadre des itemsets fré quents au cas de la fouille des ensembles de variables multivaluées Références [1] R Agrawal and R Srikant Fast algorithms for mining association rules in large data bases In Proceedings of the 20th International Conference on Very Large Data Bases VLDB’94 Santiago de Chile Chile pages 478–499 Morgan Kaufmann 1994 [2] H Heikinheimo J K Seppänen E Hinkkanen H Mannila and T Mielikäinen Finding low entropy sets and trees from binary data In P Berkhin R Caruana and X Wu editors Proceedings of the 13th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining San Jose California USA pages 350–359 ACM 2007 [3] Y Huhtala J Kärkkäinen P Porkka and H Toivonen Tane An efficient algorithm for discovering functional and approximate dependencies Comput J 42 2 100–111 1999 [4] M Mampaey Mining non redundant information theoretic dependencies between item sets In Proceedings of the 12th International Conference on Data Warehousing and Know ledge Discovery DAWAK 2010 Bilbao Spain volume 6263 of Lecture Notes in Computer Science pages 130–141 Springer 2010 [5] R Medina and L Nourine A unified hierarchy for functional dependencies conditional functional dependencies and association rules In S Ferré and S Rudolph editors Formal Concept Analysis 7th International Conference ICFCA 2009 Darmstadt Germany May 21 24 2009 Proceedings volume 5548 of Lecture Notes in Computer Science pages 98– 113 Springer 2009 [6] D Sánchez J M Serrano I Blanco M J Martín Bautista and M A Vila Using as sociation rules to mine for strong approximate dependencies Data Min Knowl Discov 16 313–348 June 2008 [7] M J Zaki Scalable algorithms for association mining IEEE T Knowl Data En 12 3 372–390 2000 Summary This article studies the feasibility and interest for extracting dependance rules between sets of multivalued variables comparatively to those of frequent association rules A dependency rule is an approximate functional dependency mainly characterized by conditional entropy The article shows how to establish a formal analogy between both types of rules and how to adapt thanks to this analogy the algorithm "Eclat" in order to extract from a dataset said definite dependance rules An experimental study concludes on pros cons of dependance rules compared to association rules 208 