RNTI_Caquard Extraction d’un modèle numérique de terrain à partir de photographies par drone Andres Jacome* Christian Puech * Damien Raclot ** Jean Stéphane Bailly * Bruno Roux *** *UMR TETIS CEMAGREF Maison de Télédétection 500 rue JF Breton 34093 Montpellier Cedex 5 {jacome puech bailly} teledetection fr **UMR LISAH IRD 2 place Pierre Viala F 34060 Montpellier Cedex 2 raclot supagro inra fr ***l’Avion Jaune 361 rue JF Breton 34093 Montpellier Cedex 5 bruno roux montpellier cemagref fr RÉSUMÉ Dans le suivi et la modélisation de l’érosion en montagne la représentation fine du relief est une composante importante En effet la connaissance des zones de concentration des eaux notamment à travers l’apparition de rigoles élémentaires est fondamentale pour bien décrire les connectivités entre les zones de mobilisation des sédiments sur le versant et le réseau hydrographique stabilisé La résolution au sol permise par les photographies aériennes classiques ne permet pas d’accéder à une représentation 3D suffisamment fine des ravines élémentaires Nous testons l’utilisation de photographies stéréoscopiques à résolution centimétrique prises à basse altitude par un drone pour obtenir un MNT précis La question majeure concerne les règles à suivre pour un meilleur compromis entre précision et facilité d’élaboration et l’évaluation de l’importance relative de chaque étape sur la qualité finale de la restitution La zone d’étude est située dans les Badlands de Draix Alpes de Haute Provence 1 Introduction Suivre et modéliser les ravines d’érosion en montagne est un défi nouveau nécessaire pour développer des modélisations distribuées précises basées sur les processus hydrologiques élémentaires Les avancées récentes en modélisation distribuée exigent de plus en plus une connaissance fine des processus élémentaires associée à une description physique précise des objets d’intérêt Hessel et al 2003 Le mode de transport liquide et solide est à la base de la réaction des bassins versants pour ces modélisations elle se décline de plus en plus en interrogations sur les chemins de l’eau point qui apparaît à la fois fondamental et mal connu et souvent très simplifié dans les modèles En particulier en zones de badlands avec un relief très tourmenté il s’agit de la caractérisation physique des ravines et du modelé du relief à différentes échelles Pour atteindre ce but les techniques de télédétection semblent appropriées mais des questions de résolutions spatiales et temporelles se posent La précision exigée par la thématique varie de quelques mètres pour la description numérique des très grosses ravines mais elle devient de quelques décimètres quand on s’intéresse aux pentes locales ou aux 79 RNTI E 13 Extraction d'un modèle numérique de terrain ravines et rigoles élémentaires La précision peut encore atteindre quelques centimètres voire des millimètres pour les analyses des dépôts et ablations de versants Les photographies aériennes classiques prises par avion donnent des informations métriques Afin d’obtenir une résolution au sol de l’ordre de quelques centimètres notre choix s’est porté vers un vecteur lent drone avion pour éviter les effets de filés sur les photos volant à très base altitude et utilisant un appareillage photographique grand public donc facilement reproductible L’utilisation de drone semble tout indiquée pour cela bien qu’elle présente deux difficultés une connaissance de la position exacte de l’appareil en vol et une limitation de la charge utile La facilité initiale de prise de vue est alors compensée par une nécessité de travaux associés repérage de mires in situ pour effectuer une aérotriangulation correcte rectifications de lentille et corrections diverses que nous allons détailler En outre la validation des modèles numériques de terrain MNT très détaillée n’est pas une tâche facile La quantité et la précision des données vérité terrain requises ainsi que la souplesse d’utilisation de l’appareillage sur place sont souvent hors de portée pour les outils couramment disponibles GPS différentiel DGPS ou tachéométrie Ces méthodes pourraient être assez précises mais elles ne produisent pas assez de données pour une validation approfondie Néanmoins le LiDAR terrestre a la potentialité pour satisfaire les conditions de validation d’un MNT très détaillés L’objectif de cet article est de quantifier à chaque étape de la chaîne de traitement stéréophotogrammétrique le gain de précision obtenu dans la construction d’un MNT pour un vecteur et un milieu particuliers et peu favorables 2 Site d’étude et données disponibles Le Cemagref suit depuis 1975 des bassins versants expérimentaux d’érosion dans des zones de badlands à Draix dans les Alpes de haute Provence récemment transformés en Observatoire de Recherche en Environnement ORE Draix Mathys et al 2003 Les bassins sont situés sur des marnes noires très érodables l’érosion y est particulièrement importante les valeurs d’ablation sont supérieures à 100 t ha an Oostwoud et Ergenzinger 1998 Dans cette zone les chemins de l’eau prédominants se présentent sous forme de ravines d’érosion voire de rigoles ou griffures élémentaires Notre site porte sur une partie du bassin du Moulin figure 1 avec des dénivelées très fortes 40 m entre les points haut et bas à une distance de 100 m ravines de 10 à 20 m de large et 5 à 10 m de profondeur Les données utilisées sont essentiellement 1 des photographies dans le visible prises par drone Avion jaune lavionjaune fr avec un appareil photo numérique Sony DSC P150 à 7 2 méga pixels 2 des repères topographiques au sol ou points de contrôle terrestre PCT et des points de vérité terrain PV sur les thalwegs et les crêtes par une campagne mixte DGPS tachéométrie 3 un scan LiDAR terrestre ILRIS 3D dans une ravine du site d’étude mai juin 2007 avec une direction de balayage vers le Nord Est Dans la figure 1 nous pouvons observer la direction du scan ligne noire pointillée en haut ainsi que le nuage de points LiDAR en bas de l’image et la ravine sélectionné pour le contrôle de qualité du MNT drone polygone noir à partir des données LiDAR 80 RNTI E 13 A Jacome et al FIGURE 1 – Localisation des bassins versants expérimentaux de Draix et du site d’étude en haut le couple stéréoscopique d’images drone choisies 01 et 02 au milieu vue panoramique du site d’étude et du scan LiDAR terrestre en bas 81 RNTI E 13 Extraction d'un modèle numérique de terrain 3 Méthodologie Les grandes étapes de la méthode stéréophotogrammétrie numérique utilisée sont celles des techniques habituelles Kraus Waldhäusl 1998 1 préparation du vol et prise de vues stéréoscopiques 2 géométrie orientation interne et externe 3 aérotriangulation et 4 restitution numérique du relief La première étape est le point du départ du développement d’un MNT et comprend la sélection du vecteur d’après les objectifs de la mission des dates et des heures de vol du type de chambre photo de la hauteur et la vitesse de vol ainsi que le nombre et la précision des points de contrôle terrestre nécessaires L’étape suivante consiste à définir les caractéristiques de la chambre photo de prise de vue ainsi que les conditions de prise de vues position et orientation de l’appareil photo Ces paramètres d’orientation interne et externe généralement inconnus pour les appareils photo grand public et les vecteurs légers ou drones sont à la base des calculs à développer dans la prochaine étape d’aérotriangulation où un lien entre l’appareil photo les photos et le terrain doit s’établir colinéarité La dernière étape consiste à restituer le relief à partir des couples stéréoscopiques par corrélation locale des points homologues Les paramètres d’orientation inconnus entraînent des erreurs géométriques importantes pendant la restitution du relief Il est alors évident que la souplesse de la méthode entraîne des approximations et des incertitudes à résoudre Notre but est alors de préciser les points où la méthode devient particulière et de vérifier jusqu’où les incertitudes citées sont surmontables et à quel compromis qualité – souplesse d’utilisation il est possible d’accéder L’ensemble des éléments présentés correspond à des schémas classiques de constitution de MNT par couple stéréoscopique C’est l’application et l’adaptation de ces méthodes à des zones érodées avec de fortes pentes et avec des appareils photo grand public qui constituent le point original de notre contribution avec un grand effort de validation de la précision sur le terrain 3 1 Préparation du vol et prise de vue stéréoscopique Un véhicule aérien non piloté UAV Unmanned Aerial Vehicle ou drone avion est un vecteur piloté au sol Il supporte une charge utile de l’ordre de 3 à 4 kg ce qui permet d’embarquer un ou deux appareils photos grand public ainsi que des éléments de vol comme un GPS légers notamment Raclot et al 2005 Pour une utilisation en stéréoscopie la précision requise pour la position du capteur à l’instant de la prise de vue est toutefois nettement plus forte que celle permise par ces GPS légers mono fréquence et non différentiels Une qualité de positionnement requise de quelques centimètres impose la prise de points d’appui au sol afin de pouvoir faire un calcul a posteriori plus précis de la position du vecteur en fonction des éléments de l’image Les éléments de stéréophotographie sont particuliers dans les zones de ravines En effet dans la littérature on cite couramment le rapport B h comme élément de qualité stéréoscopique Kraus Waldhäusl 1998 Dans le triangle formé par le point photographié au sol et les deux positions de l’appareil photo au moment des prises de vues h représente 82 RNTI E 13 A Jacome et al l’altitude de la prise de vue et B est la base c’est à dire la distance entre les deux positions de prise de vue figure 2 Classiquement un rapport B h proche de 1 est préconisé pour une stéréoscopie optimale Néanmoins dans le cas de zones très tourmentées où les pentes des versants analysés sont excessivement fortes les lignes d’incidence de la prise de vue doivent être nettement plus verticales pour éviter des parties cachées Dans ces conditions nous préconisons un rapport B h plus petit de l’ordre de 0 2 à 0 3 ce qui permet un bon compromis entre altitude distance focale et recouvrement entre clichés Par rapport au calcul des coordonnées de PCT plusieurs solutions sont possibles DGPS en mode RTK qui présente des avantages en terme de rapidité de mesure et de contrôle de qualité en temps réel Mora et al 2003 tachéomètre avec une qualité millimétrique FIGURE 2 – Rapport B h en fonction du terrain 3 2 Géométrie La géométrie interne de l’appareil photo est définie par la distance focale le point principal de symétrie ainsi que les déformations de lentilles L’orientation interne est fondamentalement utilisée pour transformer système de coordonnées pixel en système de coordonnées spatiales de l’image x y et z Afin de calibrer la chambre photo en ce qui concerne l’orientation interne nous analysons des photographies particulières représentant des zones dont la géométrie est parfaitement connue Ces prises de vue particulières peuvent être réalisées sur des mires planes parfaitement quadrillées Néanmoins il existe aussi des méthodes qui s’appuient sur des couples de prises de vue réalisées dans des bâtiments particuliers munies des repères mires 3D parking sous sol à l’IGN Paris ce qui conduit à une expression plus stable et rapide de la déformation de lentille Cette méthode permet d’accéder aux déformations de l’image liées aux imperfections de la lentille Ce résultat peut être modélisé par une fonction de déformation généralement polynomiale et exprimée en fonction de la distance au centre de l’image que l’on peut ensuite appliquer à l’image brute pour obtenir une image théoriquement corrigée des déformations L’équation du polynôme de distorsion radial est de la forme F r = a*r3+b*r5+c*r7 1 où r est la distance radiale en pixels a b et c sont des coefficients 83 RNTI E 13 Extraction d'un modèle numérique de terrain L’orientation externe définit la position et l’orientation angulaire de l’appareil photo au moment de la prise de vue Les paramètres de position de l’orientation externe incluent Xo Yo et Zo position du centre de perspective O par rapport au système de coordonnées terrestre X Y Z Zo est généralement égal à la hauteur de l’appareil photo au dessus du niveau de la mer En utilisant les trois angles de rotation omega ω phi φ et kappa κ le rapport entre le système de coordonnées spatiales d’une image x y et z et le système de coordonnées terrestres X Y et Z est déterminé Une matrice de rotation [M] à trois dimensions est employée [M] = m11 m12 m13 m21 m22 m23 m31 m32 m33 2 [M] = m11 m12 m13 m21 m22 m23 m31 m32 m33 m11 m12 m13 m21 m22 m23 m31 m32 m33 2 La matrice de rotation est définie par une rotation séquentielle d’omega ω autour de l’axe des abscisses de phi φ autour de l’axe des ordonnées et de kappa κ autour de l’axe z Un vecteur image → a peut se définir comme le vecteur qui part du centre de perspective O au point d’image p figure 3 Un vecteur terrain A → peut se définir comme le vecteur qui part du centre de perspective O au point terrain P Le vecteur image et le vecteur terrain sont situés sur la même ligne droite impliquant que centre de perspective point sur l’image et point sur le terrain sont colinéaires Le vecteur image et le vecteur terrain sont seulement situés sur la même ligne droite si l’un est le multiple scalaire de l’autre k → a = k A → 3 Une expression matricielle de cette même relation dans le système de coordonnées image va alors s’écrire sous la forme [a] = k[M][A] 4 [a] est la matrice colonne relative à → a en système image et [A] la matrice colonne relative à A → en système terrain L’équation finale qui définit le rapport entre le centre de perspective O de l’appareil photo au moment de la prise de vue et le point P sur le terrain point p sur l’image est la suivante 5 = xp xo yp yo f k[M] Xp Xo Yp Yo Zp Zo 5 = xp xo yp yo f k[M] Xp Xo Yp Yo Zp Zo Xp Xo Yp Yo Zp Zo où xp et yp sont les coordonnées image du point terrain xo et yo sont les coordonnées images du point principal et f est la distance focale Xp Yp et Zp sont les coordonnées terrain du point terrain Xo Yo et Zo sont les coordonnées terrain du centre de perspective figue 3 Cette équation est à la base de la colinéarité qui est employée dans la plupart des opérations photogrammétriques ERDAS OrthoBASE user’s guide 2002 84 RNTI E 13 A Jacome et al Des points additionnels communs aux deux images stéréo dits points homologues ou PH connus uniquement dans le système de coordonnées image sont intégrés afin d’améliorer l’ajustement du modèle d’aérotriangulation Ces PH peuvent être repérés manuellement ou de façon automatique par corrélation d’image FIGURE 3 – Paramètres d’orientation externe d’après OrthoBASE user’s guide 2002 3 3 Aérotriangulation Afin d’accomplir la restitution d’un couple stéréo une relation entre les paramètres de l’appareil photo des photos et du terrain doit être établie Pour définir cette relation on utilise les paramètres d’orientation interne et externe de chaque photo et une représentation précise du terrain par un ensemble de points de contrôle terrestres PCT Les paramètres d’orientation externe d’une photo aérienne sont normalement inconnus et le calcul de ces paramètres est l’obstacle les plus important de la stéréorestitution Selon les données d’entrée disponibles plusieurs techniques sont employées pour définir les variables exigées dans la stéréophotogrammétrie Parmi eux l’ajustement par paquet de blocs est le plus rigoureux considérant la minimisation d’erreurs et la distribution des résidus Casson 2002 signale que 85 RNTI E 13 Extraction d'un modèle numérique de terrain l’aérotriangulation en bloc présente les meilleures précisions et que ce résultat peut s’expliquer par la condition de coplanéité et la présence des PH distribués de manière homogène sur la zone de recouvrement des clichés stéréoscopiques ce qui compense une répartition des PCT parfois hétérogène La condition de coplanéité établit que les deux positions du capteur d’un couple stéréoscopique ainsi qu’un point au sol quelconque et sa position image correspondante sur les deux images doivent se situer dans un plan commun Une fois que chaque équation d’observation est formulée la condition de colinéarité peut être résolue en utilisant l’ajustement par moindres carrés Cette technique statistique est employée pour estimer les paramètres inconnus associés à une solution tout en minimisant l’erreur En ce qui concerne l’aérotriangulation cette technique est employée pour a estimer ou ajuster les paramètres d’orientation interne et externe b estimer les coordonnées X Y et Z des PH c minimiser l’erreur et distribuer les résidus dans l’ensemble des PCT Des erreurs systématiques subsistent à l’issue de l’aérotriangulation et se répercutent sur le MNT et les images associées En mode numérique il s’agit des effets de la non isotropie de la déformation de lentille ainsi que des effets d’une mauvaise disposition des mires dans la zone couverte par les clichés Maatouk 2004 a réalisé des essais par rapport à la disposition des mires sur modèle réduit Il montre des conséquences fortes sur la stabilité de l’aérotriangulation basculement par exemple Une dissymétrie dans la disposition des mires a entraîné un déplacement en X jusqu’à 5 2 cm dans l’estimation de la position d’un appareil photo situé à 1 60 m d’altitude Il existe plusieurs manières de réduire les erreurs systématiques comme la compensation a posteriori le calibrage par données complémentaires de terrain et l’approche par auto calibrage Tandis que les deux premières méthodes sont coûteuses en temps les approches par auto calibrage emploient des paramètres additionnels dans le processus de triangulation pour minimiser les erreurs systématiques Les paramètres additionnels sont un moyen extrêmement efficace pour compenser les erreurs systématiques quelle que soit leur provenance qu’il s’agisse d’une distorsion résiduelle de l’objectif de déformations du film en cas de photo argentique d’anomalies de réfraction ou de toute autre source d’erreur Kraus Waldhäusl 1998 La recherche et le développement intensif des modèles auto calibrage dans la stéréophotogrammétrie se sont intensifiés pendant les années 1970 et 1980 et plusieurs de ces résultats sont opérationnels Parmi eux la solution d’Ebner 1976 consiste en une recherche systématique de déformations types sur la restitution finale des images en utilisant 12 paramètres additionnels L’efficacité de cette correction dépend de l’importance relative entre erreur systématique et erreur aléatoire donc exige une bonne qualité des mesures des PCT Un nombre plus important de PCT et de PH est rendu nécessaire par l’introduction de ces paramètres additionnels 3 4 Restitution numérique et création du MNT La restitution numérique cherche à retrouver de manière automatique la position de chaque pixel de l’image 1 représentant le même objet sur l’image 2 dans la zone de recouvrement d’un couple stéréoscopique La corrélation d’images permet l’identification et la mesure automatiques des points homologues situés dans les zones de recouvrement des deux images 86 RNTI E 13 A Jacome et al La méthode de corrélation d’images à une dimension utilise la géométrie épipolaire comme contrainte géométrique Pour chaque point p1 dans une image les différentes positions possibles du point homologue p2 dans l’image associée varient selon l’altitude et le lieu de ces points constitue la courbe épipolaire La géométrie épipolaire est associée à la condition de coplanéité La recherche de l’optimum du coefficient de corrélation d’un pixel est donc orientée chaque point est cherché sur sa courbe épipolaire dans l’autre image La corrélation automatique d’images peut s’effectuer sur une large fenêtre par exemple 7*7 pixels pour une solution rapide mais qui implique un adoucissement local du relief Casson et al 2002 Elle est implémentée dans les logiciels de stéréophotogrammétrie disponibles ce qui fournit une solution valable pour la plupart des applications Le MNT final est obtenu au moyen d’une compensation par moindre carré qui s’appuie sur la relation de coplanéité Les résidus sont minimisés en ajustant chaque position sol A chaque pixel ne correspond pas forcément un couple de points homologues corrélés Le résultat se présente sous la forme d’un ensemble de points irrégulièrement distribués X Y et Z L’efficacité de la corrélation dépend du pas de la corrélation et de la taille de la fenêtre de corrélation et est également fonction du nombre de pixels effectivement corrélés Afin d’obtenir un MNT en surface continue il est nécessaire de faire une interpolation Ceci peut être effectué dans une grille régulière mais il est possible aussi de convertir le nuage de point 3D en format TIN par triangulation 4 Application à Draix 4 1 Le vol Une mission UAV drone a été effectuée sur la zone du Moulin à Draix le 15 juin 2005 à 11h30 avec des photographies numériques en couleurs naturelles Aucun système de guidage précis GPS embarqué n’était disponible à l’époque des prises de vue Le guidage du drone a été opéré de façon manuelle La répartition des mires dans les images n’a donc pu être optimisée a priori Nous avons préconisé finalement une altitude de vol entre 100 et 200 m selon la résolution spatiale au sol recherchée une focale courte 40 à 80 mm et un recouvrement entre clichés de 60% La vitesse de vol du drone est de l’ordre de 30 à 40 Km h ce qui permet d’obtenir des photos nettes sans effet de filé 39 photos ont été acquises en plusieurs passages avec une hauteur de vol d’environ 150 m Nous avons sélectionné le couple photo figure 1 qui remplit au mieux la demande de recouvrement établie précédemment La résolution au sol ou taille de pixel sur les images est d’environ 6 cm 4 2 Les points de terrain Le DGPS ne travaille pas avec la même précision dans toutes les conditions de relief notamment en fond des ravines profondes Etant donné cette limitation du système DGPS nous avons choisi une solution mixte DGPS Tachéométrie pour une précision satisfaisante ≤ 3 cm dans toutes les configurations de terrain 87 RNTI E 13 Extraction d'un modèle numérique de terrain A l’intérieur de la zone de recouvrement on a 8 mires PCT et 388 PV sur sol nu obtenus par une campagne mixte DGPS Tachéométrie La qualité de la donnée de terrain a été analysée en utilisant le levé tachéométrique comme référence Les résultats exprimés en erreur quadratique moyenne RMSE montrent un décalage des positionnements acquis par DGPS en mode RTK de 0 025 m selon les axes Est Ouest et Nord Sud et de 0 030 m en Altitude 4 3 Géométrie Les paramètres d’orientation interne ont été calculés au préalable avant aérotriangulation en utilisant le logiciel Poivilliers E Etalon IGN Une série de photos a été prise dans un bâtiment muni de 65 cibles disposées sur différents plans de façade avec la chambre Sony DSC P150 utilisée pendant le vol Les distorsions obtenues sur le bord de l’image sont beaucoup plus importantes qu’au centre L’impact du modèle de déformation de lentille calculé ci dessus sur la qualité finale du MNT sera évalué suivant le calcul des erreurs par rapport aux données de vérité terrain Les paramètres d’orientation externe sont inconnus et ils ont été calculés pendant l’aérotriangulation 4 4 Aérotriangulation Pour l’aérotriangulation nous disposons de 8 PCT en 3D et 326 PH détectés automatiquement par corrélation d’images à l’intérieur de la zone de recouvrement du couple choisi ainsi que 4 PCT à l’extérieur figure 4 La distribution des PH n’est pas homogène le coté Nord Ouest des images plus végétalisé a un faible potentiel de corrélation ce qui se traduit par une densité plus faible de PH que la zone non végétalisé Nous avons utilisé le modèle orthogonal d’Ebner 1976 avec 12 paramètres additionnels plus le modèle de déformation de lentille afin de réduire l’effet d’erreurs systématiques dans la solution final Le modèle d’aérotriangulation a été ajusté en utilisant le logiciel ERDAS Imagine LPS avec une valeur de convergence de 0 001 mètres Les résultats montrent des RMSE de 0 032 0 177 et 0 196 pour X Y et Z respectivement et une RMSE totale de 0 011 valeurs exprimées en pixels Le tableau 1 montre les paramètres de l’orientation externe calculés D’après les paramètres d’orientation externe nous obtenons un rapport B h de 0 28 favorable à la restitution automatique par corrélation d’images en zones à fortes pentes et un écart en Z de 29 5 m dans la hauteur de vol entre les images 88 RNTI E 13 A Jacome et al FIGURE 4 – Distribution des PCT cercles et des PH carrés sur le couple d’images 01 et 02 image ID Xo Yo Zo omega phi kappa 01 921 864 439 3 212 648 732 1 053 237 6 0819 7 0046 163 0634 02 921 870 597 3 212 688 243 1 023 656 0 9023 13 8752 153 4707 TABLEAU 1 – Paramètres d’orientation externe calculés XoYoZo mètres et ωφκ degrés Un écart d’altitude d’environ 30 mètres du vecteur au moment de l’acquisition d’images est une valeur importante puisque la hauteur de vol est de 158 24 m pour l’image 01 et 128 66 m pour l’image 02 ceci entraîne une importante différence d’échelle entre les deux clichés Les écarts dans les angles de rotation entre les deux images résultent de l’instabilité du vecteur drone avion et ils ne représentent pas les conditions de vol idéales pour une restitution précise du relief par des techniques de stéréophotogrammétrie C’est une des limitations de l’utilisation du vecteur drone et des conditions extrêmes d’acquisition des images Deux PCT ont été rejetés pendant l’ajustement du modèle d’aérotriangulation sur un total de 8 disponibles ainsi que 8 PH sur un total de 326 disponibles Dans le tableau 2 nous pouvons observer les résidus des PCT non rejetés après l’aérotriangulation Le PCT mire45 présente les résidus les plus importants ce qui est cohérent avec la position de la mire figure 4 au bord de la zone de recouvrement de deux images où les effets de la déformation de lentille sont plus forts La mire32 encore plus au bord de l’image a été rejetée pendant l’aérotriangulation 4 5 MNT par corrélation d’images Etant donné son meilleur contraste par rapport aux autres canaux disponibles le canal rouge a été utilisé pour la corrélation automatique des images La taille finale du pixel MNT 89 RNTI E 13 Extraction d'un modèle numérique de terrain a été fixée à 15 centimètres soit trois fois la taille originale moyenne du pixel dans le couple stéréoscopique ID PCT rX m rY m rZ m mire10 0 005 0 016 0 059 mire35 0 009 0 009 0 061 mire36 0 063 0 016 0 125 mire45 0 000 0 500 0 500 mire50 0 061 0 003 0 165 mireR1 0 016 0 016 0 085 TABLEAU 2 – Résidus des PCT non rejetés après l’ajustement du modèle d’aérotriangulation en mètres Afin d’apprécier le détail atteint dans la restitution du relief par stéréoscopie drone nous comparons qualitativement sur une ravine un MNT issu de restitution manuelle de photos argentiques au 1 4000° avec notre résultat Les courbes de niveau du MNT existant sont à espacement 2 m celles issues du couple drone sont à espacement 20 cm figures 5a et 5b respectivement La finesse de détail et le plan des courbes de niveau démontrent les potentialités de la restitution détaillée du relief à partir d’images drone 3 915 pixels ont été effectivement corrélés dans une fenêtre de 285 m2 points noirs figure 5b Cette densité représente environ 14 points par mètre carré mais elle n’est pas homogène sur la surface Ceci correspond à une grille régulière de 20 cm approximativement mais dans les zones densément corrélées la distance entre points peut atteindre la taille du pixel des images autour de 6 cm Il est important de rappeler qu’un couple de pixels effectivement corrélés n’exclut pas une fausse corrélation ce qui peut être à l’origine d’une anomalie du MNT un pic ou un fossé FIGURE 5 – a courbes de niveau sur une ravine à partir de photos aériennes 1 4000 b courbes de niveau et points effectivement corrélés en noir à partir d’images drone Les points effectivement corrélés suivent les zones de rupture radiométrique dans les images telles que les lignes d’ombres En absence de végétation les zones de rupture radiométrique sont les lignes de contraintes classiques d’un MNT les thalwegs et les crêtes 90 RNTI E 13 A Jacome et al En présence de végétation les points effectivement corrélés sont bien contrôlés par les bordures de la végétation et ses ombres La dépendance de la corrélation sur les points de rupture abrupte de la radiométrie laisse une grande partie de la surface des photos inexploitée dans la restitution du relief environ 2% du total des pixels disponibles dans la zone de recouvrement ont été effectivement corrélés La figure 6 montre une vue 3D du MNT calculé FIGURE 6 – Vue 3D du MNT drone démarquée en noir la ravine analysée dans la figure 5 en rouge les points de validation 5 Evaluation de qualité Pour tester l’effet des différents traitements pendant l’aérotriangulation dans la qualité de la restitution du relief trois MNT ont été construits à partir du même couple stéréoscopique d’images drone avec le même jeu de PCT et de PH a MNT sans correction de lentille et sans auto calibrage MNT o b MNT avec correction de lentille mais sans auto calibrage MNT L et c MNT avec correction de lentille et avec auto calibrage MNT LA Les résultats de l’évaluation de qualité altimétrique des MNT par rapport aux données de vérité terrain DGPS tachéométrie sont présentés dans la figure 7 91 RNTI E 13 Extraction d'un modèle numérique de terrain FIGURE 7 – Statistiques de contrôle de qualité a et histogrammes de fréquence des erreurs en Z b pour chaque MNT analysés unités en mètres L’amélioration la plus importante dans la qualité du MNT provient de la correction de la déformation de lentille cf figure 7a et 7b Avec l’auto calibrage toutes corrections 92 RNTI E 13 A Jacome et al l’erreur quadratique moyenne RMSE en Z pour le MNT LA diminue d’environ 80% par rapport à la RMSE du MNT o aucune correction En effet l’application de ces corrections permet de • ramener la moyenne de l’erreur pour le MNT LA à 8 cm ce qui est à peine supérieur à la taille initiale du pixel de l’image drone 6 cm • Améliorer fortement la précision du MNT écart type ce qui est garant d’une meilleure cohérence de la représentation du relief • Réduire fortement la plage de variation de l’erreur 5 11 m pour le MNT o contre 1 85 m pour le MNT LA La mise en œuvre de l’auto calibrage sur les images MNT LA nous permet d’améliorer encore de manière significative notamment en ce qui concerne les erreurs systématiques Ces affirmations sont bien évidentes en observant les histogrammes de fréquence des erreurs pour chaque MNT analysé figure 7b L’histogramme des erreurs pour le MNT o ligne bleue est plat et étendu avec une plage de variation très importante figure 7a Avec l’application de corrections MNT L et MNT LA lignes verte et rouge respectivement il se déplace vers l’axe des ordonnées et il se resserre les valeurs des erreurs sont plus concentrées Dans la figure 8 nous pouvons observer les séries des erreurs résidus correspondants à un profil de crête et un profil de thalweg La tendance générale des séries des erreurs montre l’effet de déformation radiale de lentille surtout pour le MNT sans aucune correction MNT o carré clair dans la figure 8 dans chaque profil Les résidus du profil thalweg sont d’une ampleur plus importante que ceux de la crête Après la correction de la déformation de lentille les résidus qui correspondent au MNT L cercle foncé figure 8 montrent déjà une amélioration significative surtout pour la crête Par rapport au thalweg nous pouvons observer toujours des erreurs systématiques même si elles ont été réduites en ampleur L’utilisation de l’approche par auto calibrage MNT LA triangles clairs dans la figure 8 ne représente pas une amélioration significative pour le profil qui correspond à la crête Toutefois ce n’est pas le cas du profil thalweg où le profil MNT LA semble plus affecté par l’erreur systématique 5 1 Analyse selon la distance au centre de l’image Afin d’avoir une vision générale de la distribution spatiale des erreurs nous avons calculé la distance au centre de l’image rayon de chaque point de validation figure 9 pour les trois niveaux de traitement étudiés L’effet de la déformation de la lentille dans la distribution des erreurs est bien évident l’erreur est plus forte dès qu’on s’éloigne du centre de l’image figure 9a L’application du modèle de déformation de lentille figure 9b montre une amélioration significative de la qualité du MNT L’effet d’erreur systématique du MNT est encore visible forme de la ligne de tendance mais cet effet a été significativement diminué La figure 9c correspond au MNT LA avec toutes corrections La distribution des erreurs est plus resserrée autour de l’axe des X correspondant à la baisse de la moyenne des erreurs en Z de 0 19 à 0 08 cm figure 7 L’effet des erreurs systématiques a été aussi diminué la pente de la ligne de tendance 0 0033 figure 9c est plus faible que dans le cas sans auto calibrage 0 0069 figure 9b 93 RNTI E 13 Extraction d'un modèle numérique de terrain FIGURE 8 – Séries des erreurs vérité terrain DGPS tachéométrie – différents MNT selon un profil de crête et un profil de thalweg La RMSE totale finale obtenue 0 22 m et la présence de résidus systématiques laisse encore la possibilité d’améliorations à faire surtout autour d’une estimation plus performante de paramètres d’orientation interne de l’appareil photo modèle de déformation de lentille distance focale 5 2 Analyse d’un versant validation par LiDAR terrestre Pour avoir une évaluation de qualité surface continue du MNT LA nous avons utilisé un scan LiDAR terrestre comme vérité terrain Le balayage au sol du faisceau laser a produit un nuage dense de données même s’il y a beaucoup d’espaces vides dus aux effets d’ombre portée Nous avons sélectionné une ravine où les données LiDAR étaient plus denses en enlevant aussi la végétation de l’information originale Cette ravine est délimitée par un polygone figure 1 en bas et figure 10 94 RNTI E 13 A Jacome et al FIGURE 9 – Distribution des erreurs en Z par rapport à la distance rayon au centre de l’image a MNT o b MNT L et c MNT LA 95 RNTI E 13 Extraction d'un modèle numérique de terrain Une nouvelle grille régulière a été calculée à l’intérieur du polygone LiDAR sélectionné Cette grille a été ré échantillonnée avec une maille de 5 cm en utilisant la valeur moyenne comme filtre de bruit dans l’information brute et puis une interpolation afin de créer un MNT LiDAR Une évaluation de qualité a été faite dans le polygone sélectionné figure 10 en comparant le MNT LA drone aux deux sources de données de vérité terrain 1 30 points de contrôle de qualité DGPS Tachéométrie et 2 101 912 pixels du MNT LiDAR terrestre pixel 5 cm Les résultats tableau 4 montrent que même si l’écart type en Z est similaire pour les deux jeux de données de vérité terrain la RMSE est plus importante pour le LiDAR terrestre DGPS Tachéométrie MNT LiDAR jeu de données confiance 26 96% 96 816 95% moyenne m 0 04 0 14 écart type m 0 12 0 13 RMSE m 0 12 0 19 TABLEAU 4 – Résultats de l’évaluation de qualité du MNT LA en mètres pour les deux jeux de données vérité terrain DGPS Tachéométrie et MNT LiDAR Malgré une évaluation un peu moins précise avec le LiDAR terrestre celui ci reste très intéressant parce qu’il propose un très grand nombre de points de validation y compris sur des zones d’accès difficile où on ne peut aller avec le GPS Nous avons établi une différence entre le MNT LA drone et le MNT LiDAR de référence afin d’effectuer une évaluation de qualité en surface continue MNT LA moins MNT LiDAR figure 10 Les valeurs positives de cette différence sont principalement situées en tête de ravine et moins évidemment le long de son côté droit dénotant une sur estimation de Z pendant la corrélation d’images drone Nous pouvons trouver une situation inverse au côté gauche de la même ravine où la sous estimation est plus évidente Les nombreuses taches bleues et rouges intenses sont associées à des anomalies locales de type pics et fossés respectivement dus aux fausses corrélations pendant la restitution numérique du relief Ces nombreuses taches isolées affectent la qualité finale du MNT mais aussi sa continuité et sa cohérence Elles pourraient être éliminées dans notre cas par un post traitement de type algorithme de lissage D’autres solutions en développement intègrent ces régularisations directement dans l’algorithme de corrélation d’image par exemple le logiciel MicMac Pierrot D 2007 Ces appréciations n’auraient pas été possibles en utilisant seulement les points de validation pris par DGPS Tachéométrie L’évaluation d’erreur en Z dépend non seulement du décalage en Z lui même mais également des décalages selon les axes X et Y particulièrement dans un relief très accidenté comme Draix Une optimisation 3D MNT LA au MNT LiDAR a été effectuée pour calculer le décalage moyen global dans chaque axe 0 004 0 014 et 0 272 tous en mètres pour X Y et Z respectivement Ces résultats montrent un décalage significativement plus important en Z par rapport aux axes X et Y 96 RNTI E 13 A Jacome et al FIGURE 10 – MNT LA moins MNT LiDAR moyenne 0 14 m écart type 0 19 m 6 Conclusion Le problème traité dans l’article concerne l’utilisation de drone dans l’acquisition d’images stéréoscopiques pour le développement de MNT précis et cohérents par stéréophotogrammétrie Les vecteurs légers ne permettent pas d’utiliser des appareils photo professionnels certes plus précis mais trop lourds pour être placé sur des drones Les prises de vue par appareil grand public permettent une grande souplesse d’utilisation Notre objectif était de préciser les points où la méthode devient particulière et de vérifier jusqu’où les incertitudes citées sont surmontables et à quel compromis qualité – souplesse d’utilisation on peut arriver L’application de la méthode IGN Poivilliers E pour le calcul des paramètres d’orientation interne a été traduite par une amélioration très significative dans la précision du MNT en passant d’une RMSE totale de 1 09 à 0 31 mètre A ce stade il reste toujours des erreurs systématiques résiduelles Elles sont probablement dues à plusieurs effets instabilité de vol et disposition non régulière des mires dans les images déformations de lentille non parfaitement corrigées liées au modèle polynomial de correction utilisé L’approche par auto calibrage Ebner 1976 compense en partie ces erreurs systématiques La moyenne finale de l’erreur est de 8 cm proche de la taille du pixel de l’image drone 6 cm La RMSE totale obtenue est alors de 22 cm soit trois fois et demie la taille de pixel initial de l’image Toutefois il faut remarquer que l’analyse de distribution d’erreurs par rapport à la position dans le paysage reflète que les observations sur les crêtes atteignent une précision 97 RNTI E 13 Extraction d'un modèle numérique de terrain significativement meilleure que sur les fonds des ravines Ceci est dû au contraste entre les images et les effets d’ombres portées toujours plus présentes au fond des ravines très profondes Afin de bien développer le potentiel des images drone pour la restitution du relief par stéréophotogrammétrie dans des zones à fortes pentes sans sacrifier la souplesse d’utilisation on doit surmonter plusieurs contraintes comme l’instabilité de vol et les déformations de lentille Un autre facteur perfectible est l’efficacité de la corrélation d’images qui contrôle la qualité de la restitution de relief La distribution de points effectivement corrélés montre en effet la dépendance pratiquement exclusive de la corrélation sur les points de rupture abrupte de la radiométrie en laissant ainsi une grande partie de la surface des photos inexploitée L’algorithme de corrélation d’images disponible sur ERDAS Imagine LPS ne dispose pas de mécanismes pour contrôler les fausses corrélations entre pixels d’un couple stéréoscopique résultant en nombreuses irrégularités dans la surface du MNT pics et fossés Les données vérité terrain par LiDAR terrestre ont permis de détecter ces irrégularités grâce à l’énorme densité de l’information disponible et elles constituent un excellent complément aux données DGPS Tachéométrie dans la validation de MNT très détaillés Le développement de routines plus performantes destinées à augmenter la densité de points effectivement corrélés en modifiant le critère de sélection des points seraient certainement une avancée dans ce domaine par exemple le corrélateur MEDICIS CNES qui recherche un optimum local en analysant le rapport signal à bruit des images Casson et al 2002 Nos résultats montrent une amélioration significative par rapport aux résultats de Henry et al 2002 Maatouk 2004 et Raclot et al 2005 dans les mêmes conditions de relief Les résultats révèlent le potentiel du vecteur drone pour le développement des MNT peu coûteux avec une très haute résolution spatiale malgré de nombreuses contraintes Bibliographie Casson B Delacourt C Baratoux D P Allemand 2002 Seventeen years of the “La Clapière” landslide evolution analysed from ortho rectified aerial photographs Engineering Geology 68 123 139 Ebner H 1976 Self calibrating block adjustment International Archives of Photogrammetry and Remote Sensing 21 Part 3 Henry J B Malet J P Maquaire O P Grussenmeyer 2002 The use of small format and low altitude aerial photos for the realization of high resolution DEMs in mountainous areas application to the Super Sauze Earthflow Alpes de Haute Provence France Earth Surface Processes and Landforms 27 1339 1350 Hessel R Jetten V Baoyuan L Yan Z J Stolte 2003 Calibartion of the LISEM model for a small Loess Plateau catchment Catena 54 235 254 Kraus K et Waldhäusl P 1998a Manuel de Photogrammétrie Principes et Procédés Fondamentaux Hermès editor Paris 407 pp 98 RNTI E 13 A Jacome et al Leica Geosystems GIS Mapping 2003 OrthoBASE OrthoBASE Pro User’s Guide 516 p Maatouk F 2004 Precise DEM Extraction from Drone Images Rapport de stage de DESS TRISIG Cemagref ENGREF GDTA 51 p Mathys N Brochot S Meunier M D Richard 2003 Erosion quantification in the small marly experimental catchments of Draix Alpes de Haute Provence Calibration of the ETC rainfall runoff erosion model Catena 50 527 548 Mora P Baldi P Casula G Fabris M Ghirotti M Mazzini E A Pesci 2003 Global Positioning Systems and Digital Photogrammetry for the Monitoring of Mass Movements Application to the Ca’ di Malta Landslide Northern Apennines Italy Engineering Geology 68 103 121 Oostwoud D J et P Ergenzinger 1998 Erosion and sediment transport on steep marly hillslopes Draix Haute Provence France an experimental field study Catena 33 179 200 Pierrot D M 2007 MicMac un logiciel pour la mise en correspondance automatique d’images dans le contexte géographique Bulletin d’Information Scientifique et Technique de l’IGN n° 77 12 p Raclot D Puech C Mathys N Roux B Jacome A Asseline J J S Bailly 2005 Photographies aériennes par drone et Modèle Numérique de Terrain apports pour l’observatoire sur l’érosion de Draix Géomorphologie Relief Processus Environnement N° 1 p 7 20 Summary Rills and gullies physical characterization is a key point in the study of erosion processes on badlands zones with a much tormented geomorphology and is fundamental for an accurate representation of connectivity between slope’s sediments mobilization zones and the stabilized hydrographical network Traditional aerial photographs ground resolution does not make it possible to reach the elementary gullies We test the use of a few centimetres resolution stereo pair photos obtained by Unmanned Aerial Vehicles UAV drones at low altitude to compute precise DEM on a badlands zone A particular focus concerns the ways to find out a better compromise between data accessibility and accuracy and the evaluation of the relative importance of each stage on final accuracy 99 RNTI E 13 Extraction d'un modèle numérique de terrain 100 RNTI E 13