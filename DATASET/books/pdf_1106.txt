 Apprentissage Automatique des Modèles Structurels d’Objets Cartographiques Güray Erus Nicolas Loménie Université de Paris 5 Laboratoire SIP CRIP5 45 rue des Saints Pères 75006 Paris France {egur Nicolas Lomenie} math info univ paris5 fr Résumé Pour reconnâıtre les objets cartographiques dans les images satellitales on a besoin d’un modèle d’objet qu’on recherche Nous avons développé un système d’apprentissage qui construit le modèle structu rel d’objets cartographiques automatiquement à partir des images satel litales segmentées Les images contenants les objets sont décomposées en formes primitives et sont transformées en Graphes Relationnels Attribués ARGs Nous avons généré les modèles d’objets à partir de ces graphes en utilisant des algorithmes d’appariement de graphes La qualité d’un modèle est évaluée par la distance d’édition des exemples à ce modèle Nous sommes parvenus à obtenir des modèles de ponts et de ronds points qui sont compatibles avec les modèles construits manuellement 1 Introduction 1 1 Position du Problème Au sein du laboratoire SIP dans le cadre d’un projet du CNES1 on a développé deux systèmes de détection d’objets cartographiques sur les images satellitales A la phase terminale de ces systèmes on a utilisé un modèle de l’objet recherché pour déterminer l’appartenance des candidats à une certaine classe d’objet Ce modèle est généré manuellement soit en utilisant des règles fixes Sanz et Loménie soit en précisant des contraintes géométriques Loménie et al Notre objectif est de générer ces modèles d’objets cartographiques automatiquement à partir d’une base d’images satellitales segmentées L’originalité de ce travail repose sur l’application de techniques d’apprentissage structurel à des objets cartographiques complexes et très variables Une étude détaillée de la reconnaissance d’objets en utilisant des modèles est présentée dans Pope Dans la plupart des travaux les objets sont représentés par des graphes et particulièrement par des ARGs Petrakis et Faloutsos proposent une métrique de distance entre deux ARGs pour détecter les images semblables dans une base de donnée images Dans Cordella et al on présente une méthode d’apprentissage des figures représentées par des ARGs L’objective d’apprentissage est de générer une séquence des ARGs Généralisés qui couvre tous les exemples Une étude des algorithmes d’appariement de graphes se trouve dans Bunke Notre système se compose de deux modules Fig 1 Nous disposons d’une banque de données objets dans lequel des ponts et des ronds points isolés sont extraites d’ 1Centre National d’Etudes Spatiales RNTI E 3445 Apprentissage Automatique des Modèles Structurels d’Objets Cartographiques Détection des formes primitives Détection des c onnexion des formes Transformation en ARGs Extraction des prototypes et du modèle Evaluation du modèle Images Segmentées Images Décomposées Modèle d'Objet Sous graphe Commun Max Sur graphe Commun Min Bas niveau Haut niveau Fig 1 – Le système général images SPOT5 THR à une résolution de 2 5 mètres L’objectif du module de pré traitement est la décomposition des images segmentées de ponts et de ronds points en figures géométriques primitives Au deuxième module nous transformons les images décomposées en ARGs Nous déterminons en suite les prototypes les plus fréquents de l’objet parmi tous les graphes et nous générons le modèle à partir de ces prototypes Pour évaluer la qualité du résultat la distance d’édition de chacun des graphes au modèle correspondant est calculé 2 Décomposition en Figures Géométriques En utilisant des figures géométriques simples on peut obtenir une décomposition qui préserve la topologie et les relations spatiales des parties d’un objet Nous avons proposé deux décompositions en parallèle une par des cercles et des rectangles et une autre par des cercles et des segments Nous avons d’abord détecté les cercles dans les images La transformée de Hough est une méthode classique de détection des formes simples comme des droites et des cercles dans une image Nous avons utilisé ce méthode pour détecter les cercles dans les images de ronds points Pour détecter les rectangles la première étape est l’extraction des contours en utilisant le gradient morphologique Le contour obtenu est une courbe Pour approximer ce courbe par des segments nous avons utilisé l’algorithme de la corde Parmi tous les segments nous avons choisi les segments parallèles et détectés les rectangles encadrées par ces segments parallèles Les figures géométriques obtenues ne sont pas en général connectées Nous avons appliqué un méthode de prolongation sur les rectangles pour détecter leur connexions Avec l’objectif d’obtenir une approximation plus fidèle à l’image originale nous avons proposé une deuxième décomposition en remplaçant les rectangles par des seg ments Pour extraire les segments nous avons implémenté l’algorithme d’amincissement de Zhang Suen L’algorithme de la corde est utilisé pour approximer le squelette obtenu par des segments Quelques exemples représentatives des résultats de la décomposition sont présentés au figure 2 RNTI 1 RNTI E 3 446 Erus et Lomenie Images Originales D écomposition en Cercles et Rectangles D écomposition en Cercles et Segments Fig 2 – Les images décomposées 3 Construction du Modèle 3 1 Construction des ARGs Les images décomposées sont transformées en ARGs Les attributs des sommets sont les suivants – Le type t d’un sommet choisi parmi un alphabet fini T = {cercle rectangle segment} de types possibles – Les rectangles ont les attributs centre longueur largeur et angle avec l’horizontal Les segments ont les mêmes attributs que les rectangles sauf le largeur Les cercles ont les attributs centre et rayon Les valeurs de ces attributs sont représentés par des entiers naturels Les attributs des arcs sont – Le type de l’arc un tuple de types des sommets connectés – La direction de connexion qui est discrétisée par l’ensemble {perpendiculaire parallèle} 3 2 Détection des Prototypes Nous avons proposé une méthode heuristique qui vise à réduire le nombre de graphes en détectant les prototypes entre eux Nous avons supposé que parmi les graphes ap partenant à une classe d’objet plus le nombre d’occurrence d’un graphe augmente plus ce graphe devient représentatif de l’objet En groupant les graphes isomorphiques et en triant les groupes par le nombre d’individu nous avons obtenu les graphes les plus fréquents Nous avons appliqué un algorithme d’appariement exact entre les graphes pour détecter les graphes isomorphiques Nous avons utilisé un sous ensemble des at tributs pour la comparaison des graphes au lieu de comparer tous les attributs Les attributs utilisés sont le type de sommet le type de l’arc et la direction de connexion Les deux premiers attributs assurent l’appariement des figures et le dernier RNTI 1 RNTI E 3447 Apprentissage Automatique des Modèles Structurels d’Objets Cartographiques attribut assure l’appariement des relations spatiales entre les figures Les prototypes détectés manquent de valeur pour des attributs numériques qui ne sont pas utilisés pour la comparaison des graphes Pour déterminer ces valeurs dans chaque groupe on utilise le graphe qui est le plus proche de la moyenne cumulative de ces attributs Le but de fixer les valeurs manquants est de visualiser les prototypes obtenus 3 3 La Construction du Modèle Nous considérons comme modèle le treillis déterminé par le sous graph commun maximal MaxSgC et le sur graph commun minimal MinSgC des prototypes c’est à dire tous les graphes G tels que G ⊆MinSgC et G ⊇MaxSgC Nous avons implémenté un algorithme récursif pour trouver le MaxSgC commun de deux ARGs G1 et G2 MaxSgC G1 G2 =        G2 si G2 ⊆ G1 max‖Mi‖{Mi} où Mi = MaxSgC G1 Gi et Gi = G2 − si ∀si ∈ Sommets G2 sinon Nous trouvons le MinSgC des deux graphes G1 et G2 en utilisant leur MaxSgC Soit M = MaxSgC G1 G2 Le MinSgC G1 G2 est obtenu en ajoutant G1 −M et G2 −M à M Les attributs numériques des modèles obtenues sont déterminé en utilisant les at tributs des prototypes comme on a fait à l’extraction des prototypes 3 4 La Distance d’édition des Exemples au Modèle Pour évaluer la puissance représentative du modèle généré nous avons calculé la distance d’édition de chacun des graphes au modèle en utilisant la métrique suivante proposé par Bunke et Shearer d G1 G2 = 1− ‖ MaxSgC G1 G2 ‖ max ‖G1‖ ‖G2‖ Nous avons adapté cette métrique à des ARGs en utilisant l’algorithme pour cal culer le MaxSgC des ARGs Le métrique est défini pour trouver la distance entre deux graphes Pour calculer la distance d’un graphe G1 au modèle M nous avons généré G l’ensemble de tous les graphes couverts par le modèle et trouvé le minimum des distances de G1 à chaque élément de G 4 Les Résultats Expérimentaux Nous avons testé notre système sur 4 groupes de test images de pont décomposées par rectangles PR ou par segments PS et images de ronds points décomposées par cercles et rectangles RPR ou par cercles et segments RPS Nous avons utilisé 62 images de ponts et 54 images de ronds points RNTI 1 RNTI E 3 448 Erus et Lomenie a P R RP R P S RP S Fig 3 – Les prototypes obtenus MaxSgC MinSgC P R P S RP R RP S Fig 4 – Les modèles obtenus Les prototypes obtenus sont présentés au figure 3 Le nombre de prototypes est déterminé en précisant un seuil minimal pour le taux des graphes qui ont un apparie ment exact avec un des prototype Le taux d’appariement est plus élevé pour PS et RPS C’est la conséquence d’une décomposition plus régulier en utilisant les segments Les prototypes des ponts sont assez similaires pour tous les deux décompositions Pourtant pour les ronds points on a obtenu des prototypes différents à cause des irrégularités à la connexions des routes avec des ronds points Figure 4 présente les modèles obtenus à partir des prototypes détectés à l’étape précédente Les modèles sont simples et semblables aux modèles générés manuellement Ils représentent assez bien les caractéristiques de l’objet recherché Les deux différents algorithmes de décomposition ont donné presque le même modèle de pont Pour évaluer la qualité d’un modèle qualitativement nous avons calculé la distance d’édition de tous les graphes d’une même classe d’objet au modèle de cette classe D’après ce critère le meilleur modèle est obtenu à PS avec une distance d’édition moyenne de 0 098 Ce moyen est 0 1572 pour PR 0 165 pour RPS et 0 1874 pour RPR La distance moyenne des exemples au modèle est assez petite pour tous les groupes 5 Conclusions et Perspectives Ce travail est un premier approche à un problème assez large et difficile Notre objectif est d’obtenir un système cohérent et complet qu’on pourra améliorer avec des extensions futures Nous sommes parvenus à obtenir des modèles de ponts et de ronds RNTI 1 RNTI E 3449 Apprentissage Automatique des Modèles Structurels d’Objets Cartographiques points assez proches des modèles générés manuellement La sélection des attributs des ARGs est sans doute le point central du problème Notre représentation est finalement assez directe La variance des objets géographiques nous a conduit à limiter le nombre des attributs utilisés à la construction du modèle Cette limitation a réduit la capa cité représentative de notre système Des raffinements seraient souhaitables Prendre en compte les attributs numériques utiliser une modélisation floue des concepts sym boliques ou intégrer les méthodes issues du raisonnement qualitatif spatial peuvent améliorer les résultats La réalisation de ce projet scientifique a été rendu possible grâce aux aides de – CNES Service Qualité G Pauc J C Favard et J Inglada – Le Service Culturel de l’Ambassade de France à Ankara et notamment Dr Z Hamrouni Références Bunke H 2000 Graph matching Theoretical foundations algorithms and applica tions in Proc Vision Interface 2000 Montreal 2000 82 88 Bunke H and Shearer K 1998 A Graph distance metric based on the Maximal Common Subgraph Pattern Recognition Letters Vol 19 1998 Cordella L P Foggia P Sansone C Vento M 2002 Learning structural shape descriptions from examples Pattern Recognition Letters 23 12 1427 1437 Loménie N Trias R Barbeau J 2003 Integrating Textural and Geometric Infor mation for an automatic bridge detection IGARSS’03 Toulouse France juillet 2003 Petrakis M and Faloutsos C 1995 Similarity Searching in Large Image Databases Technical Report 3388 Department of Computer Science University of Maryland Pope A 1994 Model Based Object Recognition A Survey of Recent Research Tech nical Report 94 04 The University of British Columbia Department of Computer Science Trias R et Loménie L 2003 Automatic bridge detection in high resolution satellite images 3rd International Conference on Computer Vision Systems ICCVS’03 ser LNCS Graz Austria Springer pp 172 181 Apr 2003 Summary A model of the target object is required for the recognition of cartographic objects in satellite images We developed a learning system that constructs the cartographic object model automatically using a database of segmented satellite images The images containing the objects are decomposed into primitive figures and are transformed to At tributed Relational Graphs We generated the object models applying graph matching algorithms on these graphs The quality of a model is evaluated by the edit distance of the examples to the model We obtained models of bridges and round abouts compa tible with manually generated models RNTI 1 RNTI E 3 450