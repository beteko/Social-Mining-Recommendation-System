 actes_non_num\351rotes pdf Acquisition annotation et exploration interactive d’images stéréoscopiques en réalité virtuelle application en dermatologie Mohammed Haouach* ** Karim Benzeroual* ** Christiane Guinot** * Gilles Venturini* * Laboratoire d’Informatique Université François Rabelais de Tours 64 avenue Jean Portalis 37200 Tours France {haouach benzeroual venturini} univ tours fr **CE R I E S Unité Biométrie et Epidémiologie 20 Rue Victor Noir 92521 Neuilly sur Seine France christiane guinot ceries lab com Résumé Nous présentons dans cet article le système Skin3D qui implémente tous les composants matériels et logiciels nécessaires pour extraire des informations dans des images 3D de peau Il s’agit à la fois du matériel d’éclairage et d’acquisition à base d’appareils photographiques stéréoscopiques d’une méthode de calibration de caméras utilisant les algorithmes génétiques de matériel de réalité virtuelle pour restituer les images en stéréoscopie et interagir avec elles et enfin d’un ensemble de fonctionnalités interactives pour annoter les images partager ces annotations et construire un hypermédia 3D Nous présentons une étude comparative concernant la calibration et une application réelle de Skin3D sur des images de visages 1 Introduction Le relief est une donnée complexe et importante dans de nombreux domaines Il nécessite des méthodes spécifiques afin d’une part d’effectuer une acquisition répondant aux critères du domaine applicatif et d’autre part d’offrir une restitution réaliste permettant à l’expert du domaine d’extraire des connaissances Dans le cadre de la dermatologie nous avons conçu un système complet et opérationnel appelé Skin3D et dont nous donnons une vue d’ensemble sur la figure 1 Skin3D est composé de trois modules principaux un module d’acquisition permet la prise de vue de plusieurs positions d’une mire servant au calibrage ainsi que la capture d’images stéréoscopiques en mode portrait ou macro d’une personne présentant des spécificités cutanées Le deuxième module s’occupe de la calibration des caméras i e l’estimation des paramètres des caméras rotation translation etc indispensables pour le calcul d’information en 3D Le dernier module permet l’exploitation des images stéréoscopiques à l’aide d’outils d’annotation de visualisation et d’exploration orientés dans un but d’extraction de connaissances et de partage de ces connaissances avec d’autres experts Acquisition annotation et exploration interactive d’images stéréoscopiques en réalité virtuelle FIG 1 – Vue d’ensemble de Skin3D 2 Système d’acquisition et de calibration avec un algorithme génétique Nous avons conçu dans Skin3D un module d’acquisition constitué d’un système d’éclairage de deux appareils photos assemblés par un support et déclenchés de manière synchrone avec la possibilité d’une prévisualisation et d’un système de calibration de couleur Le deuxième module traite de la calibration des caméras C’est une étape cruciale en stéréovision puisqu’elle va déterminer la précision de l’acquisition du relief Elle consiste à estimer les paramètres des caméras tels que la transformation 3D faisant passer de l’une à l’autre mais aussi d’autres paramètres internes à chaque caméra comme la distance focale la distorsion le décentrage de l’objectif par rapport au capteur CCD Il existe de nombreuses méthodes pour réaliser ce calcul Tsai 1987 sans un réel consensus même si récemment certains algorithmes se sont relativement répandus Zhang 1998 Le principe de ce calcul consiste à prendre des photos d’une mire dont on connaît parfaitement les dimensions puis à calculer les positions relatives des caméras par rapport aux mires et enfin à résoudre un système d’équations permettant d’estimer la transformation faisant passer d’une caméra à l’autre Les méthodes d’optimisation mathématique utilisées ont parfois des problèmes stabilité de la méthode point de départ initial et cela a poussé des chercheurs à tester des approches utilisant des algorithmes génétiques Dans ce cadre nous pouvons citer par exemple Zhang et Ji 2001 qui calibrent une seule caméra par rapport à une mire Cerveri et al 2001 qui utilisent des stratégies d’évolution pour la calibration de deux caméras ou encore Dipanda et al 2003 qui utilisent une caméra et un laser Nous avons défini une nouvelle méthode de calibration génétique qui se distingue des autres approches génétiques par les points suivants elle est spécifique à la stéréoscopie elle utilise la notion de distance entre points dans sa fonction d’évaluation nous cherchons à atteindre la plus grande précision possible dans nos mesures elle peut être appliquée aussi bien aux modèles d’objectifs dits sténopés que télécentriques hors du champ de cet article Cette méthode s’inspire de l’apprentissage supervisé car elle entraîne le système sur des données jusqu’à ce que celles ci soient correctement prédites Elle consiste à prendre des photos d’une mire ici un damier voir figure 1 étape 2 avec différentes orientations puis à détecter les points de ces mires dans les images gauches et droites Nous connaissons parfaitement la géométrie de cette mire et donc les distances entre les points détectés Notre M Haouach et al algorithme de calibration se base donc sur un ensemble de distances exactes entre points détectés Pour un jeu de paramètres des caméras nous pouvons calculer la position estimée des points et donc les distances estimées entre ces points A l’initialisation la population est remplie d’individus générés aléatoirement dans des bornes fixées de manière très lâche Ensuite nous sélectionnons deux individus parents par tournoi binaire et nous recombinons ces individus à l’aide d’un operateur de croisement au choix une combinaison linéaire ou un croisement uniforme et un opérateur de mutation bruit uniforme La fonction d’évaluation tient compte à la fois de l’erreur commise sur les distances mais aussi de l’erreur commise lors du calcul des coordonnées 3D des points estimation du point d’intersection de deux droites dans l’espace voir par exemple Cerveri et al 2001 Les paramètres que nous considérons dans cette optimisation sont donc la matrice de passage d’une caméra à l’autre les distances focales la distorsion barillet et coussinet et le décentrage Après une période de tests notamment sur des problèmes artificiels où nous connaissons les paramètres exacts à estimer nous avons retenu le paramétrage génétique suivant 1000 individus dans la population arrêt après 30000 générations un seul individu engendré à chaque génération si pas d’amélioration supérieure à un seuil Les temps d’exécution sont de l’ordre d’une minute L’optimisation de la distorsion et du décentrage n’apportent pas d’amélioration avec le matériel dont nous disposons voir résultats de la section 4 1 3 Visualisation en réalité virtuelle et exploration interactive 3 1 Utilisation de la réalité virtuelle et mesure d’information 3D Ce module du projet est très important car une fois les données acquises ces dernières doivent être restituées à l’expert de manière aussi fidèle que possible à la réalité et avec toutes les interactions permettant de découvrir des informations L’utilisation de techniques de réalité virtuelle est donc nécessaire à la fois pour restituer le relief en stéréoscopie mais également pour permettre de se déplacer dans les images et par exemple d’y effectuer des annotations Pour la visualisation stéréoscopique nous avons utilisé deux types de matériel de projection d’une part des écrans cathodiques classiques qui visualisent alternativement les images gauches et droites et qui nécessitent l’emploi de lunettes à obturation active et d’autre part des vidéo projecteurs à lunettes passives Pour la navigation dans les images l’utilisateur peut se déplacer selon 3 axes X Y et Z Pour effectuer ces déplacements l’utilisateur peut soit employer la souris soit utiliser un contrôleur 3D de type SpacePilot™ 6 degrés de liberté qui permet d’avoir une main contrôlant les déplacements et l’autre contrôlant le pointeur souris Nous n’utilisons que 3 axes sur ce matériel X Y et Z L’utilisation du SpacePilot est très intuitive car ces axes correspondent parfaitement aux déplacements effectués dans l’image 3D On peut calculer la profondeur d’un point particulier en utilisant les paramètres intrinsèques paramètres internes des caméras et extrinsèques position dans l’espace des deux cameras calculés durant l’étape de calibrage Pour cela nous utilisons un algorithme de mise en correspondance qui effectue une recherche séquentielle en utilisant une mesure de Acquisition annotation et exploration interactive d’images stéréoscopiques en réalité virtuelle corrélation couleur Chambon 2005 entre l’imagette de gauche centrée sur un point Pg et l’imagette de droite centrée sur le point candidat Pd Le point retenu est celui qui maximise la corrélation et qui vérifie certaines contraintes comme la réciprocité le point correspondant de Pd est Pg Si une erreur trop importante est constatée le système le signale à l’utilisateur Ensuite à partir de deux points 3D sélectionnés l’expert peut calculer des distances 3D entre les éléments qui l’intéressent voir figure 2 FIG 2 – Annotation mesure 3D et carte de profondeur calculée sur 0 1 % des pixels Le pointeur par défaut du système d’exploitation s’avère incompatible avec la visualisation stéréoscopique car la position du pointeur est relative à l’écran et non pas a l’image stéréoscopique ce qui crée une confusion visuelle pour l’utilisateur C’est pour cela que nous avons doté Skin3D d’un pointeur stéréoscopique positionné en 3D dans la visualisation 3 2 Annotations et construction d’un hypermédia Skin3D offre des outils qui permettent d’associer des annotations textuelles ou vocales à des zones de l’image voir figure 2 Les annotations peuvent être paramétrées de différentes manières On peut définir pour chaque annotation un nom une couleur et une forme Chaque annotation peut être à l’état visible ou masqué On peut lui associer ou non un événement souris affichage d’une bulle lors du passage du curseur déplacement automatique avec zoom lors d’un double clic L’auteur des annotations peut générer de manière intuitive un parcours interactif de l’image en fixant un ordre sur les zones sélectionnées et leurs annotations Skin3D peut alors parcourir automatiquement les zones sélectionnées dans l’ordre spécifié tout en lisant les commentaires enregistrés par l’expert Les annotations de l’expert se transforment ainsi en un film interactif L’expert peut si besoin ajuster la vitesse de déroulement De cette manière l’expert peut souligner certains faits les présenter en premier puis expliquer les conséquences de ces faits Cette fonctionnalité permet également à Skin3D d’être appliqué dans le cadre de l’enseignement de la dermatologie Enfin des hyperliens peuvent être construits entre les annotations d’une ou de plus images L’ensemble de ces informations sont stockées dans un format XML autorisant le partage des données et connaissance entre plusieurs experts M Haouach et al 4 Résultats 4 1 Calibration résultats comparatifs Nous avons comparé notre méthode de calibration avec un outil MatLab Bouguet 2008 Nos avons utilisé pour cela les images de mire damier utilisées dans la campagne de test décrite dans la section suivante 6 photos ont été prises selon différentes orientations Nous effectuons une validation croisée chaque photo est isolée et utilisée comme base de test alors que les 5 autres servent à l’apprentissage Les deux méthodes sont évaluées avec les mêmes ensembles de points et avec la même mesure d’erreur sur les distances entre ces points voir tableau 1 Images img1 img2 img3 img4 img5 img6 Erreur Moyenne 142 µm 45 µm 392 µm 53 µm 270 µm 73 µm 943 µm 41 µm 330 µm 42 µm 241 µm 55 µm Ecart Type 86 µm 36 µm 72 µm 40 µm 162 µm 53 µm 83 µm 35 µm 83 µm 35 µm 120 µm 48 µm Erreur Max 387 µm 175 µm 559 µm 192 µm 570 µm 265 µm 1147 µm 165 µm 546 µm 141 µm 579 µm 225 µm TAB 1 – Evaluation de la précision de la calibration en validation croisée sur 6 images 48 points par image et 82 distances En souligné et en italique l’outil Camera Calibration ToolBox for MatLab en gras notre approche 4 2 Etude réelle Afin d’évaluer notre système dans un cadre réel des tests ont été effectués sur 18 volontaires de sexe féminin âgé de 20 à 65 ans présentant des spécificités cutanées Pour chaque volontaire des prises de vue de face de profils gauche et droit ont été effectuées en utilisant notre dispositif Afin d’analyser les couples stéréoscopiques nous avons présenté notre système dans un cadre industriel devant un panel de spécialistes internationaux en dermatologie Ces dermatologues ont utilisé Skin3D pour visualiser les images en stéréoscopie les annoter lier les annotations entre différentes images et effectuer des calculs de profondeur La possibilité de visualiser en 3D de partager les analyses entre ces différents experts grâce l’enregistrement XML des images et des liens hypermédia entre ces dernières a amélioré considérablement le diagnostique des différents symptômes cutané en identifiant des informations difficilement perceptibles dans une photo standard 5 Conclusions et perspectives Nous avons développé le système Skin3D pour l’acquisition la visualisation et l’exploration interactive d’images stéréoscopiques spécialement dans le domaine de la dermatologie Nous avons défini une nouvelle méthode de calibration utilisant un algorithme génétique Nous avons proposé l’utilisation de matériel de réalité virtuelle afin de visualiser Acquisition annotation et exploration interactive d’images stéréoscopiques en réalité virtuelle les images en stéréoscopie soit sur un poste de travail individuel soit sur un grand écran Nous avons développé des possibilités de mesures 3D d’annotation et de partage des connaissances découvertes Plusieurs perspectives se dégagent de ces travaux En ce qui concerne le module d’acquisition nous allons utiliser de nouveaux appareils photos avec une résolution de 21 Mpixels afin de diminuer encore les erreurs de mesures Pour la partie visualisation nous comptons exploiter également de nouveaux matériels de visualisation meilleure résolution et restitution des couleurs Pour la partie exploration nous souhaitons augmenter les possibilités liées aux annotations Références Bouguet J 2008 Camera Calibration Toolbox for Matlab vision caltech edu bouguetj calib_doc algorithme adapté de Zhang 1998 Cerveri P A Pedotti et N A Borghese 2001 Combined Evolution Strategies for Dynamic Calibration of Video Based Measurement Systems IEEE Transactions on Evolutionary Computation Vol 5 No 3 Chambon S 2005 Mise en correspondance stéréoscopique d'images couleur en présence d'occultations Thèse de doctorat Université Paul Sabatier Toulouse III Dipanda A S Woo F Marzani J M Bilbault 2003 3 D shape reconstruction in an active stereo vision system using genetic algorithms The journal of Pattern Recognition society Vol 36 2143 2159 Hernandez Esteban C F Schmitt 2003 Silhouette and Stereo Fusion for 3D Object Modeling Computer Vision and Image Understanding Vol 96 Issue 3 367 392 Tsai R Y 1987 A versatile camera calibration technique for high accuracy 3D machine vision metrology using off the shelf tv cameras and lenses IEEE Journal of Robotics and Automation No 3 4 323–344 Zhang Y Q Ji 2001 Camera Calibration With Genetic Algorithms IEEE International Conference on Robotics and Automation Vol 31 Issue 2 120 130 Zhang Z 1998 A Flexible New Technique for Camera Calibration Technical Report MSR TR 98 71 of Microsoft Research Summary We present in this paper the Skin3D system that implements all hardware and software necessary to extract information from 3D images of skin It is composed of lighting equipment stereoscopic cameras a camera calibration algorithm that uses genetic algorithms virtual reality equipment to visualize the images and interact in 3D with them a set of interactive tools to annotate images and to create a 3D hypermedia We present comparative results and an application of Skin3D on images of faces 