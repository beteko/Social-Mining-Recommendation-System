 Sous bases k faibles pour des règles d’association valides au sens de la confiance Jean Diatta Régis Girard IREMIA Université La Réunion 15 Avenue Réné Cassin 97715 St Denis FRANCE { jean diatta rgirard} univ reunion fr Résumé Nous introduisons la notion de sous base k faible pour les règles d’as sociation valides au sens de la confiance Ces sous bases k faibles sont caractéri sées en termes d’opérateurs de fermeture correspondant à des familles de Moore k faiblement hiérarchiques 1 Introduction L’un des problèmes majeurs rencontrés dans la fouille des règles d’association valides au sens de la confiance est le nombre souvent très élevé de ces règles Plusieurs solutions à ce problème ont été proposées ou considérées dans la littérature Parmi ces solutions figurent les bases c’est à dire des familles génératrices minimales Zaki et Ogihara 1998 Pasquier et al 1999 La plupart de ces bases se caractérisent en terme d’un opérateur de fermeture de Galois sur l’ensemble des motifs du contexte considéré Or cet opérateur de fermeture correspond à une famille de Moore m faiblement hiérarchique où m ≥ 2 est un entier Diatta 2004 Plus précisément les fermés de cet opérateur de fermeture coïncident avec les classes faibles associées à une certaine mesure de dissimilarité m voies et forment donc de ce fait la hiérarchie m faible associée à cette mesure de dissimilarité Dans cet article nous considérons la caractérisation de ces bases pour les règles d’asso ciation en remplaçant l’opérateur de fermeture de Galois par un opérateur de fermeture cor respondant à la hiérarchie k faible associée à une mesure de dissimilarité k voies donnée où 2 ≤ k ≤ m Pour chaque valeur de k l’ensemble de règles ainsi caractérisé sera appelé sous base k faible Ces sous bases k faibles offrent une approximation de l’ensemble des règles valides relativement à des ensembles d’items classes k faibles ayant un certain degré d’ho mogénéité exprimé par le biais d’un indice d’isolation Par ailleurs la possibilité d’associer une sous base k− faible à une mesure de dissimilarité k voies permet d’intégrer la sémantique de cette mesure de dissimilarité dans le choix des règles à générer 2 Règles d’association 2 1 Définition générale Étant donné un contexte binaire K = E V où E désigne un ensemble fini d’entités et V un ensemble fini de variables booléennes ou attributs définies sur E On appelle motifs les Sous bases k faibles pour des règles d’association sous ensembles de V et on dit qu’une entité possède un attribut “x” si x e = 1 Une règle d’association de E V est un couple X Y de motifs notée X→Y où Y est non vide X et Y sont respectivement appelés “prémisse” et “conséquent” Étant donné un motif X X ′ désignera l’ensemble des entités qui possèdent tous les attri buts de X i e X ′ = {e ∈ E ∀x ∈ X x e = 1} Un contexte binaire E V contient 2|V| 2|V| − 1 règles d’association parmi lesquelles beaucoup ne sont pas pertinentes On utilise des mesures de qualité pour sélectionner unique ment les règles qui vérifient des contraintes données 2 2 Règles d’association confiance valides Une mesure de qualité pour les règles d’association d’un contexte K est une application à valeurs réelles définie sur l’ensemble des règles d’association de K Beaucoup de mesures de qualité on été proposées dans la littérature les plus utilisées d’entre elles étant le support et la confiance Agrawal et al 1993 Le support d’un motif X est la proportion des entités de E qui possèdent tous les attributs de X on le définit par Supp X = |X ′| |E| où pour un ensemble fini S |S| désigne le cardinal de S Si on note p la mesure de probabilité intuitive définie sur E P E par p E = |E||E| pour E ⊆ E alors le support de X peut s’écrire en termes de p par Supp X = p X ′ Le support d’une règle d’association X→Y est défini par Supp X→Y = Supp X ∪ Y = p X ∪ Y ′ = p X ′ ∩ Y ′ La confiance d’une règle d’association X→Y est la proportion des entités qui possèdent tous les attributs de Y parmi celles qui possèdent tous les attributs de X elle est définie par Conf X→Y = Supp X→Y Supp X = p X′∩Y ′ p X′ = p Y ′|X ′ où p Y ′|X ′ est la probabilité conditionnelle de Y ′ sachant X ′ Une règle d’association est confiance valide si sa confiance est au moins égale à un seuil minimum de validité fixé Une règle est dite confiance exacte si sa confiance est égale à 1 elle est dite confiance approximative si sa confiance est strictement inférieure à 1 3 Bases pour les règles confiance valides L’un des problèmes majeurs de l’extraction de règles d’association est le nombre très élevé de règles générées En effet pour une mesure de qualité donnée µ l’ensemble des règles d’as sociation µ valides contient fréquemment de nombreuses règles redondantes i e qui peuvent être déduites d’autres règles µ valides Pour palier ce problème on cherche à calculer une base de l’ensemble des règles valides c’est à dire un ensemble minimal au sens de l’inclusion de règles d’association valides à partir duquel toute règle valide peut être dérivée Dans ce papier nous considérons des bases qui se caratérisent en termes d’opérateurs de fermeture de Galois 3 1 Opérateurs de fermeture de Galois Le contexte binaire K induit une correspondance de Galois entre les ensembles ordonnés P E ⊆ et P V ⊆ définie par les applications f X 7→ ∩ x∈X {v ∈ V v x = 1} et J Diatta et R Girard g Y 7→ ∩ v∈Y {x ∈ E v x = 1} pour X ⊆ E et Y ⊆ V Barbut et Monjardet 1970 Par ailleurs la correspondance de Galois f g induit un opérateur de fermeture ϕ = f ◦ g sur P V ⊆ Birkhoff 1967 Cet opérateur de fermeture sera dit de Galois et un motif X sera dit fermé de Galois du contexte K ou ϕ fermé si ϕ X = X Pour un motif X ϕ X sera appelé sa ϕ fermeture 3 2 Bases de Guigues Duquenne et de Luxenburger L’ensemble des règles d’association confiance exactes est un système complet d’implica tions i e il satisfait les axiomes d’inférence de Armstrong 1974 Il en découle que la base de Guigues et Duquenne 1986 pour les systèmes complets d’implications est aussi une base pour les règles d’association confiance exactes La base de Guigues Duquenne pour les règles d’association confiance exactes est l’en semble GD = {X→ϕ X \X X est ϕ critique} où un motif X est ϕ critique s’il n’est pas ϕ fermé et contient strictement la ϕ fermeture de tout motif ϕ critique Y tel Y ⊂ X Pour tout motif X ϕ X est applelé la ϕ fermeture de X La base de Luxenburger 1991 pour les règles d’association confiance approximatives est l’ensemble LB = {X→Y X = ϕ X Y = ϕ Y X ≺ Y et Conf X→Y ≥ α} où X ≺ Y signifie que X ⊂ Y et qu’il n’existe aucun ensemble ϕ fermé Z tel que X ⊂ Z ⊂ Y 4 Sous bases k faibles pour les règles confiance valides 4 1 Opérateurs de fermeture et familles de Moore Soit E un ensemble Une famille de Moore sur E est une partie F de l’ensemble P E des parties de E telle que E ∈ F et F′ ⊆ F impliquent ∩F′ ∈ F Si F est finie donc si E est fini alors la seconde condition peut être remplacée par X Y ∈ F implique X ∩ Y ∈ F Par ailleurs étant donnée un famille de Moore F sur E l’application φF définie sur P E par φF X = ∩{Y ∈ F X ⊆ Y } est un opérateur de fermeture sur P E Réciproquement étant donné un opérateur de fermeture φ sur E la collection Fφ de sous ensembles de E définie par Fφ = {X ⊆ E φ X = X} est une famille de Moore sur E 4 2 Fermés de Galois et classes faibles Une mesure de dissimilarité mutuelle sur E est une fonction d2 E × E → R vérifiant les conditions d2 x x = 0 d2 x y ≥ 0 et d2 x y = d2 y x Dans ce papier nous rem plaçons les deux premières conditions par la condition moins forte d2 x y ≥ d2 x x Une justification de cet affaiblissement peut être trouvée dans Diatta 2006 Un sous ensemble X de E est une classe faible associée à une mesure de dissimilarité d2 ou classe d2 faible si son indice d’isolation d2 faible i w d2 X = minx y∈X z ∈X {max{d2 x z d2 y z } − d2 x y } Sous bases k faibles pour des règles d’association est strictement positif En d’autres termes pour tous x y dans la classe et tout z extérieur à la classe au moins l’une des dissimilarités d2 x z et d2 y z est strictement supérieure à la dissimilarité d2 x y Les mesures de dissimilarité mutuelle se généralisent naturellement en mesures de dis similarité dites multivoies permettant d’évaluer le degré de dissemblance globale entre entités d’un ensemble de plus de deux éléments Etant donnés un ensemble S et un entier k ≥ 1 désignons par S ≤k l’ensemble des sous ensembles non vides de S ayant au plus k éléments Alors en adoptant la définition ensem bliste proposée dans Diatta 2006 une mesure de dissimilarité k voies sur E est une fonction monotone croissante définie sur E ≤k à valeurs réelles positives ou nulles i e une fonction dk E ≤k → R+ telle que dk X ≤ dk Y lorsque X ⊆ Y On notera que les mesures de dissimilarité mutuelle correspondent au cas où k = 2 Par ailleurs on parlera de mesure de dissimilarité multivoies pour signifier une mesure de dissi milarité k voies quelconque pour k ≥ 2 De plus telle qu’observée dans Bandelt et Dress 1994 la notion de classe faible s’adapte tout aussi naturellement aux mesures de dissimilarité multivoies Ainsi un sous ensemble X de E est une classe faible associée à une mesure de dissimilarité k voies dk si son indice d’isolation dk faible min Y ∈X ≤k z ∈X { max Z∈Y ≤k−1 dk Z ∪ {z} − dk Y } est strictment positif Par ailleurs il a été montré dans Diatta 2004 qu’il existe un entier m ≥ 2 tel qu’un sous ensemble X de V est ϕ fermé si et seulement si X est une classe faible associée à une certaine mesure de dissimilarité m voies dm sur V Il découle de ce résultat que les motifs ϕ fermés forment une famille de Moore m faiblement hiérarchique appelée la hiérarchie m faible associée à la mesure de dissimilarité dm Ainsi ϕ est tout simplement l’opérateur de fermeture correspondant à cette famille de Moore au sens de la section 4 1 4 3 Sous bases k faibles Nous avons vu dans la section 3 qu’aussi bien la base de Guigues Duquenne que celle de Luxenburger pour les règles d’association confiance valides se caractérisent en terme de l’opé rateur de fermeture ϕ Par ailleurs nous venons de voir dans la section 4 2 que l’opérateur de fermeture ϕ correspond à une famille de Moore m faiblement hiérarchique pour un certain entier m ≥ 2 Ces deux observations nous conduisent à considérer les analogues respectifs des bases de Guigues Duquenne et de Luxenburger en remplaçant l’opérateur de fermeture ϕ par un opérateur de fermeture correspondant à une famille de Moore k faiblement hiérarchique quelconque où 2 ≤ k ≤ m Pour k = m on peut retrouver ces bases sous certaines condi tions mais dans le cas gńéral les ensembles de règles obtenus ne sont pas des bases au sens algébrique Ainsi nous appellerons sous base k faible de Guigues Duquenne pour les règles d’asso ciation confiance valides un ensemble de règles GDφk défini par GDφk = {X→φk X \X X est φk critique} où φk est un opérateur de fermeture correspondant à une famille de Moore k faiblement hié rarchique J Diatta et R Girard On notera que les règles de GDφk ne sont pas nécessairement exactes En effet certaines de ces règles peuvent avoir des exceptions pour la simple raison que la ϕ fermeture de la prémisse d’une telle règle peut être strictement contenue dans sa φk fermeture i e X φk critique et ϕ X ⊂ φk X On notera également qu’il a été montré dans Diatta 2005 que si F une famille de Moore k faiblement hiérarchique sur E contenant toutes les parties de E d’au plus k − 1 éléments alors X ⊂ E est φF critique si et seulement si X ∈ F et |X | = k Ce résultat généralise en fait son analogue obtenu par Domenach et Leclerc 2004 dans le cas particulier des familles de Moore faiblement hiérarchiques k = 2 De même nous appellerons sous base k faible de Luxenburger pour les règles d’associa tion confiance valides un ensemble de règles LBφk défini par LBφk = {X→Y X = φk X Y = φk Y X ≺ Y et Conf X→Y ≥ α} où φk est un opérateur de fermeture correspondant à une famille de Moore k faiblement hié rarchique et où X ≺ Y signifie X ⊂ Y et il n’existe pas de φk fermé Z tel que X ⊂ Z ⊂ Y On notera que les règles de LBφk ne sont pas nécessairement approximatives En effet certaines de ces règles peuvent être exactes si par exemple leur conséquent est contenu dans la ϕ fermeture de leur prémisse i e X = φk X ≺ φk Y = Y ⊆ ϕ X 5 Conclusion et discussion Nous avons introduit la notion de sous base k faible relative à l’opérateur de fermeture correspondant à une famille de Moore k faiblement hiérarchique Ces sous bases k faibles peuvent permettre de réduire le nombre de règles générées tout en assurant que les règles ainsi générées soient relatives à des ensembles d’items classes k faibles ayant un certain degré d’homogénéité exprimé par le biais d’un indice d’isolation Le degré d’homogénéité de ces classes peut dans une certaine mesure garantir la cohérence du lien entre la prémisse et le conséquent d’une règle En effet on sait que des règles générées dans l’approche classique peuvent lier des motifs qui sont en réalité très peu liés voire statistiquement indépendants Par ailleurs la possibilité d’associer une sous base k− faible à une mesure de dissimilarité k voies permet d’intégrer la sémantique de la mesure de dissimilarité dans le choix des règles à générer On notera qu’une sous base k faible n’est pas nécessairement une famille génératrice donc pas une base au sens algébrique du terme Toutefois cela ne nous semble pas être un handicap En effet l’intérêt d’un ensemble de règles générées nous parait être plus dans la pertinence des règles qu’il comporte que dans sa capacité à permettre de reconstruire toutes les règles valides Cela étant les idées présentées dans ce travail posent entre autres les deux questions suivantes a comment générer efficacement une sous base k faible b quel est le degré d’approximation des bases usuelles par les sous bases k faibles Références Agrawal R T Imielinski et A Swami 1993 Mining association rules between sets of items in large databases In P Buneman et S Jajodia Eds Proc of the ACM SIGMOD International Conference on Management of Data Volume 22 Washington pp 207–216 ACM press Sous bases k faibles pour des règles d’association Armstrong W W 1974 Dependency structures of data base relationships Information Processing 74 580–583 Bandelt H J et A W M Dress 1994 An order theoretic framework for overlapping clus tering Discrete Mathematics 136 21–37 Barbut M et B Monjardet 1970 Ordre et classification Paris Hachette Birkhoff G 1967 Lattice theory 3rd edition Coll Publ XXV Providence RI American Mathematical Society Diatta J 2004 A relation between the theory of formal concepts and multiway clustering Pattern Recognition Letters 25 1183–1189 Diatta J 2005 Charactérisation des ensembles critiques d’une famille de Moore finie In Rencontres de la Société Francophone de Classification Montréal Canada pp 126–129 Diatta J 2006 Description meet compatible multiway dissimilarities Discrete Applied Mathematics 154 493–507 Domenach F et B Leclerc 2004 Closure systems implicational systems overhanging rela tions and the case of hierarchical classification Mathematical Social Sciences 47 349–366 Guigues J L et V Duquenne 1986 Famille non redondante d’implications informatives résultant d’un tableau de données binaires Mathématiques et Sciences humaines 95 5–18 Luxenburger M 1991 Implications partielles dans un contexte Math Inf Sci hum 113 35–55 Pasquier N Y Bastide R Taouil et L Lakhal 1999 Closed set based discovery of small covers for association rules In Proc 15emes Journees Bases de Donnees Avancees BDA pp 361–381 Zaki M J et M Ogihara 1998 Theoretical Foundations of Association Rules In 3rd SIG MOD’98 Workshop on Research Issues in Data Mining and Knowledge Discovery DMKD pp 1–8 Summary We introduce the notion of a k weak sub basis for confidence valid association rules These k weak sub bases are characterized in terms of closure operators corresponding to k weakly hierarchical Moore families 