 ToTeM une méthode de détection de communautés adaptées aux réseaux d’information David Combe Christine Largeron Előd Egyed Zsigmond Mathias Géry Université de Lyon F 42023 Saint Étienne France CNRS UMR 5516 Laboratoire Hubert Curien F 42000 Saint Étienne France Université de Saint Étienne Jean Monnet F 42000 Saint Étienne France {david combe christine largeron mathias gery} univ st etienne fr Université de Lyon UMR 5205 CNRS LIRIS 7 av J Capelle F 69100 Villeurbanne France elod egyed zsigmond insa lyon fr Résumé Alors que les réseaux sociaux s’attachaient à représenter des entités et les relations qui existaient entre elles les réseaux d’information intègrent égale ment des attributs décrivant ces entités ce qui conduit à revisiter les méthodes d’analyse et de fouille de ces réseaux Dans cet article nous proposons une mé thode de classification des sommets d’un graphe qui exploite d’une part leurs relations et d’autre part les attributs les caractérisant Cette méthode reprend le principe de la méthode de Louvain en l’étendant de façon à permettre la mani pulation d’attributs continus d’une manière symétrique à ce qui existe pour les relations 1 Introduction L’objectif de la détection de communautés dans les graphes ou encore dans les réseaux so ciaux est de créer une partition des sommets en tenant compte des relations qui existent entre ces sommets dans le graphe de telle sorte que les communautés soient composées de sommets fortement connectés Fortunato 2010 Ainsi les principales méthodes de détection de com munautés proposées dans la littérature se concentrent sur la structure des liens en ignorant les propriétés des sommets Or dans de nombreuses applications les réseaux sociaux peuvent être représentés par des graphes dont les sommets ont des attributs qui peuvent être pris en compte pour détecter plus efficacement les communautés Ceci a conduit à revisiter cette probléma tique afin d’opérer cette détection non seulement à partir des relations décrites par le graphe mais aussi à partir d’attributs caractérisants les sommets et cela a donné lieu récemment à l’in troduction de méthodes qui exploitent ces deux types de données Moser et al 2007 Zhou et al 2009 Li et al 2008 Cruz Gomez et al 2011 Combe et al 2012 Dang et Viennet 2012 Dans cet article nous proposons ToTeM une méthode de classification de graphes à vec teurs d’attributs qui reprend le principe de la méthode de Louvain basée sur l’optimisation ToTeM détection de communautés pour réseaux d’information de la modularité en l’étendant de façon à permettre la prise en compte d’attributs numériques d’une manière symétrique à ce qui existe pour les relations Blondel et al 2008 Après avoir défini plus formellement le problème de la détection de communautés dans un réseau d’infor mation dans la section 2 nous rappelons brièvement le principe de la méthode de Louvain et introduisons ToTeM dans la section 3 avant de décrire des critères globaux de partitionnement dans la section suivante 2 Énoncé du problème et notations Étant donné un graphe G = V E où V = {v1 vi vn} est l’ensemble des som mets et E ⊂ V × V est l’ensemble des arêtes non étiquetées On suppose que chaque som met vi ∈ V est associé à un vecteur di = wi1 wij wiT à valeurs réelles de sorte que G forme un réseau d’information Zhou et al 2009 Dans un problème de partition nement de réseau d’information les liens et les attributs sont considérés de telle sorte que d’une part il doit y avoir de nombreuses arêtes au sein de chaque classe et relativement peu entre elles et d’autre part deux sommets appartenant à la même classe sont plus proches en termes d’attributs que deux sommets appartenant à des classes différentes Ainsi l’objectif est de partitionner l’ensemble V des sommets en r classes disjointes formant une partition P = {C1 Cr} où r est a priori inconnu et de telle sorte que les sommets appartenant à un même groupe soient connectés et homogènes vis à vis des attributs Dans la suite on notera A la matrice d’adjacence de G telle que Aij indique la valuation de l’arête entre i et j si elle existe et vaut 0 s’il n’existe pas d’arête entre i et j Le degré du sommet i noté ki est égal à∑ j Aij et ci désignera la classe d’appartenance de i dans la partition P 3 La méthode ToTeM La méthode ToTeM que nous proposons est une extension de la méthode de Louvain qui consiste elle même à optimiser le critère de modularité Blondel et al 2008 Newman et Girvan 2004 Q P = 1 2m Σii′ [ Aii′ − ki · ki′ 2m · δ ci ci′ ] 1 où i i′ prend toutes les valeurs de V × V m est la somme des poids de toutes les arêtes du graphe et δ est la fonction de Kronecker qui vaut 1 si ses arguments sont égaux et 0 sinon L’algorithme comporte deux phases À partir de la partition discrète la première phase consiste à essayer de déplacer successivement chaque sommet vers la classe de ses voisins et à l’affecter à la classe ayant apporté le plus fort gain de modularité Lorsque plus aucune amélioration n’est possible dans une seconde phase un nouveau graphe pondéré est formé à partir des classes obtenues à l’issue de la première phase Chaque classe devient un sommet du nouveau graphe et une arête entre deux sommets a pour poids la somme des poids des arêtes présentes entre des sommets contenus précédemment dans les classes correspondantes Les deux phases sont répétées jusqu’à ce qu’il n’y ait plus de modification possible Le gain de D Combe et al modularité induit par le déplacement d’un sommet isolé i vers une classe Cl est égal à ∆Q = [∑ in +2ki in 2m − ∑ tot +ki 2m 2] − [∑ in 2m − ∑ tot 2m 2 − ki 2m 2] 2 où ∑ in est la somme des poids des arêtes ayant leurs deux extrémités dans la classe Cl ∑ tot est la somme des poids des arêtes adjacentes aux sommets de Cl ki in est la somme des poids des arêtes de i aux sommets de Cl Blondel et al 2008 La méthode ToTeM que nous introduisons dans l’Algorithme 1 repose sur l’optimisation d’un critère global permettant de classer les sommets en se souciant à la fois de la qualité des classes d’un point de vue relationnel mais également du point de vue des attributs Algorithme 1 ToTeM Entrées Réseau d’information G Sorties Partition P 1 répéter 2 Placer chaque sommet de G dans une unique classe 3 Sauvegarder la qualité globale de cette décomposition 4 tant que il y a des sommets déplacés faire 5 pour tous les sommet x de G faire 6 l← classe voisine maximisant le gain du critère d’évaluation 7 si l induit un gain strictement positif alors 8 déplacer x de sa classe vers l 9 si le critère de qualité atteint est supérieur à sa valeur initiale alors 10 fin← faux 11 Afficher la décomposition trouvée 12 Transformer G en le réseau d’information entre les classes 13 sinon 14 fin← vrai 15 jusqu’à fin Pour ce qui est de la qualité par rapport aux relations on peut retenir la modularité Le gain est alors mesuré suivant la formule 2 Pour ce qui est de la qualité par rapport aux attri buts plusieurs mesures sont envisageables comme le taux d’inertie inter classes ou l’indice de Calinski détaillés dans les sections suivantes 4 Gain d’inertie et critères de qualité globale Il est possible d’améliorer l’efficacité de l’algorithme ToTeM lorsque le critère global est basé sur l’inertie inter classes d’une partition en remarquant que la variation d’inertie inter classes induite par la réaffectation d’un sommet peut être calculée uniquement à l’aide d’in formation locale Étant donné V l’ensemble des n sommets du graphe représentés dans un ToTeM détection de communautés pour réseaux d’information espace vectoriel défini par les attributs et muni d’une distance euclidienne à laquelle est asso ciée une norme ‖·‖ A tout sommet x de V est associé un poids positif mx et sans perte de généralité on peut supposer qu’initialement tous les sommets ont le même poids On note g le centre de gravité de V et pour toute classe Cl de P gl son centre de gravité et ml la somme des poids des éléments de cette classe Cl Considérons deux partitions P et P ′ telles que P = A B C1 Cr et P ′ = A \ {x} B ∪ {x} C1 Cr Par la suite A \ {x} désigne la classe A privée du sommet x et B ∪ {x} la classe B augmentée du sommet x L’inertie inter classes Iinter P associée à la partition P est égale à Iinter P = mA ‖gA − g‖2 +mB ‖gB − g‖2 + ∑ l=1 r ml ‖gl − g‖2 3 où gA respectivement gB est le centre de gravité de A respectivement B et mA respecti vement mB est le poids de A respectivement B L’inertie inter classes de la partition P ′ obtenue en retirant x de sa classe A et en l’affectant à la classe B vaut Iinter P ′ = mA\{x} ∥∥gA\{x} − g∥∥2 +mB∪{x} ∥∥gB∪{x} − g∥∥2 + ∑ l=1 r ml ‖gl − g‖2 4 La variation d’inertie inter classes induite par le déplacement du sommet x de la classe A vers la classe B est donnée par ∆Iinter = mA −mx · ∥∥gA\{x} − g∥∥2 + mB +mx · ∥∥gB∪{x} − g∥∥2 −mA · ‖gA − g‖2 −mB · ‖gB − g‖2 5 gA\{x} et gB∪{x} sont eux aussi calculés facilement en utilisant seulement l’effectif repré senté par le sommet x et les classes A et B ainsi que leurs centres de gravités gA gB gA\{x} = 1 mA−{x} ∑ i∈A\{x} midi = 1 mA −mx mA · gA −mx · dx 6 gB∪{x} = 1 mB +mx mB · gB +mx · dx 7 Les valeurs des poids associés aux classes peuvent aussi être recalculées à l’aide de l’informa tion locale mA\{x} = mA −mx et mB∪{x} = mB +mx 4 1 Synthèse des informations du graphe et des attributs dans la seconde phase L’opération de synthèse des informations du graphe consiste à l’instar de ce qui est opéré dans la méthode de Louvain à fusionner les sommets affectés à une même classe de façon à n’en faire qu’un seul sommet Ainsi à partir de la partition P ′ = C1 Cr obtenue à l’issue de la première phase un nouveau graphe G′ = V ′ E′ est crée Ce graphe comporte autant de sommets qu’il y a de classes dans P ′ et chaque sommet v′l de V ′ incarne une classe Cl de P ′ La valuation de l’arête éventuellement présente entre les sommets v′y et v ′ z de V ′ est égale à la somme des valuations des arêtes présentes entre des sommets de G appartenant aux D Combe et al classes Cy et Cz de P ′ qui ont été représentées par v′y et v ′ z dans V ′ Soit τ la fonction qui indique pour un sommet de V par quel sommet de V ′ il est représenté alors le poids associé à une arête se calcule de la façon suivante weight v′y v ′ z = ∑ va vb ∈V×V A va vb · δ τ va v′y · δ τ vb v′z 8 Enfin les arêtes internes aux classes de P deviennent des boucles dans G′ De plus il est nécessaire de transférer les informations relatives aux attributs sur le nouveau grapheG′ Pour cela on affecte les poids des classes d’origine aux sommets de destination et le centre de gravité de la classe d’origine devient le vecteur d’attributs du sommet de destination Ainsi pour tout sommet v′l de V ′ résultant de la classe Cl de P ′ on amv′l = mCl et dv′l = gCl 4 2 Critères de qualité globale Le critère de qualité globale intervenant dans l’algorithme ToTeM doit être une fonction d’une mesure de qualité de la partition par rapport aux relations et d’une mesure de sa qualité par rapport aux attributs La modularité peut être utilisée comme mesure de la qualité par rapport aux relations Pour ce qui est de la qualité par rapport aux attributs une première solution envisageable peut consister à prendre le taux d’inertie inter classes Ce qui conduit à une première mesure de qualité globale définie par CG1 = Iinter P I P ·mod P 9 où I P désigne l’inertie totale de V Cependant le taux d’inertie inter classes n’est pas conçu pour comparer des partitions ayant un nombre de classes différent En effet il varie structurellement avec le nombre de classes de la partition de sorte qu’il est maximum pour la partition discrète Une solution simple visant à palier ce biais structurel consiste à tenir compte du nombre de classes |P| de la partition pour définir un critère global CG2 = Iinter P |P| · I P ·mod P 10 Contrairement au précédent ce critère donne un avantage aux partitions à faible nombre de classes Une alternative pour palier cet inconvénient consiste à avoir recours à des indices conçus dans le but de déterminer le nombre de classes dans le cas du partitionnement de don nées vectorielles comme par exemple l’indice de Calinski Harabasz celui de Dunn ou celui de Davies Bouldin Calinski et Harabasz 1974 Davies et Bouldin 1979 Une autre solution pour comparer deux partitions P et P ′ de taille respective r et r′ consiste à utiliser la probabilité critique résultant de tests de comparaison de variance En effet sous l’hypothèse nulle selon laquelle les classes ne sont pas significativement différentes au sein de la partition P la statistique F P définie par FP = Vinter r − 1 VT − Vinter n− r 11 suit une loi de Fisher Snedecor F r−1 n−r à r−1 n−r degrés de liberté où Vinter désigne la variance entre les classes et VT la variance totale On peut donc calculer la probabilité ToTeM détection de communautés pour réseaux d’information critique PC associée PC = P F r−1 n− r > FP De même la statistique F P ′ peut être déterminée sur la partition P ′ et on peut en déduire PC ′ La comparaison des probabilités critiques associées à P et à P ′ conduira à préférer la partition pour laquelle cette probabilité est la plus faible Remerciements Ce travail est partiellement soutenu par la région Rhône Alpes et St Etienne Metropole agglo st etienne fr Références Blondel V D J L Guillaume R Lambiotte et E Lefebvre 2008 Fast unfolding of com munities in large networks Journal of Statistical Mechanics P10008 Calinski T et J Harabasz 1974 A dendrite method for cluster analysis Communications in Statistics Theory and Methods 3 1 1–27 Combe D C Largeron E Egyed Zsigmond et M Géry 2012 Getting clusters from struc ture data and attribute data In IEEE ACM International Conference on Advances in Social Networks Analysis and Mining ASONAM pp 731–733 Cruz Gomez J D C Bothorel et F Poulet 2011 Entropy based community detection in augmented social networks In Computational Aspects of Social Networks CASoN pp 163–168 Dang T A et E Viennet 2012 Community Detection based on Structural and Attribute Similarities In International Conference on Digital Society ICDS pp 7–12 Davies D et D Bouldin 1979 A cluster separation measure Pattern Analysis and Machine Intelligence 2 224— 227 Fortunato S 2010 Community detection in graphs Physics Reports 486 3 5 75–174 Li H Z Nie W C W Lee C L Giles et J R Wen 2008 Scalable Community Discovery on Textual Data with Relations In CIKM pp 1203–1212 Moser F R Ge et M Ester 2007 Joint Cluster Analysis of Attribute and Relationship Data Without A Priori Specification of the Number of Clusters In SIGKDD pp 510 Newman M et M Girvan 2004 Finding and evaluating community structure in networks Physical review E 69 2 1–16 Zhou Y H Cheng et J Yu 2009 Graph clustering based on structural attribute similarities Proceedings of the VLDB Endowment 2 1 718–729 Summary While social networks used to be handled through relations only information networks are integrating attributes describing the entities This lead us to revisit analysis and mining methods for these networks We present a combined classification method of the vertices of a graph taking into account relations and attributes This method uses the principles of the Louvain method extending it allowing the attribute manipulation in a symmetrical manner to what has been done for relations 