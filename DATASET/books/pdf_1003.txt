 Approche entropique pour l’analyse de modèle de chroniques Nabil Benayadi* Marc Le Goc* Philippe Bouché* *Laboratoire des Sciences de l'Information et des Systèmes LSIS UMR CNRS 6168 Université Paul Cézanne Avenue Escadrille Normandie Niemen13397 Marseille Cedex 20 – France {nabil benayadi marc legoc philippe bouche} lsis org Résumé Cet article propose d’utiliser l’entropie informationnelle pour analyser des modèles de chroniques découverts selon une approche stochastique Bouché et Le Goc 2005 Il décrit une adaptation de l’algorithme TemporalID3 Console et Picardi 2003 permettant de découvrir des modèles de chroniques à partir d’un ensemble d’apprentissage contenant des séquences d’occurrences d’événements discrets Ces séquences représentent des suites d’alarmes générées par un système à base de connaissance de monitoring et de diagnostic de systèmes dynamiques On montre sur un exemple que l’approche entropique complète l’approche stochastique en identifiant les classes d’événements qui contribuent le plus significativement à la prédiction d’une occurrence d’une classe particulière 1 Introduction La découverte de connaissances temporelles est un enjeu majeur pour le diagnostic de systèmes dynamiques Das et al 1998 Dousson et Vu Duong 1999 Keogh et Smyth 1997 Agrawal et al 1995 Faloutsos et al 1994 Récemment Bouché P et Le Goc M 2005 ont proposés une approche stochastique pour découvrir des modèles de chroniques à partir d’une séquence d’événements discrets Nos travaux visent à compléter cette approche pour identifier les classes d’événements contribuant le plus significativement à la prédiction de l’occurrence d’une classe particulière Les arbres de décisions Breiman 1984 Murthy 1998 sont largement utilisés pour classer des séquences de données Kadous 1999 Geurts 2001 Drucker et Hubner 2002 Rodriguez et Alonso 2004 Récemment l’algorithme ID3 Quinlan 1986 a été adapté pour construire des arbres temporels de décision Console et al 2003 à partir d’un ensemble de situations Cette adaptation montre que l’entropie informationnelle permet d’identifier les variables contribuant le plus significativement à une prise de décision Nous proposons donc d’utiliser un critère entropique pour analyser des modèles de chroniques Après un bref rappel sur les arbres temporels de décision cet article présente une adaptation de l’algorithme proposée par Console pour la déduction de modèles de chroniques à partir d’un ensemble de séquences d’occurrences d’événements discrets et montre sur un exemple comment l’approche entropique peut être utilisée pour compléter l’approche stochastique 511 RNTI E 6 Approche entropique pour l’analyse de modèle de chroniques 2 Arbres temporels de décision Un arbre de décision est une structure T= <r N E L> où N=NI∪NL est l’union d’un ensemble NI={xi} de nœuds internes désignant une variable xi et un ensemble NL={ai} de nœuds feuilles désignant une décision ai r∈N est le nœud racine de l’arbre E ⊆ NI × N est un ensemble d’arcs un arc attribuant une valeur vj à une variable xi et L est une fonction d’étiquetage définie sur N∪E qui retourne le nom de la variable xi associé au nœud de NI la décision ai associée à une feuille de NL ou la valeur vJ associée à un arc de E L’algorithme ID3 utilise l’entropie informationnelle dans un ensemble de cas Σ pour construire un arbre de décision de profondeur minimal Un cas e est une collection de valeurs vj prises par un ensemble de variables xi conduisant à une décision ai particulière A chaque nœud ID3 choisit la variable x qui minimise l’entropie ξ x Σ dans l’ensemble Σ des cas a P log a P vx P x jjj j vxi2 n 1i vxivx vx k 1j j = = == = = Σ×Σ−=Σ Σ×==Σ ∑ ∑ ξ ξξ 1 { }edansvvaleurlaaxiablevarlae jvx j Σ∈=Σ = 2 où jvx= Σξ est l’entropie de la partition jvx= Σ et a P jvxi = Σ est la probabilité de la décision ai dans cette partition jvx= Σ Temporal ID3 est une extension d’ID3 à des données datées selon une horloge à temps discrète Console et al 2003 Un arbre temporel de décision est un arbre de décision où un nœud est un couple xi tk xi désignant une variable et tk la date d’observation de sa valeur et un arc défini une valeur vj de xi à la date tk i e xi tk =vj Il s’agit donc d’une structure T= <r N E L Γ> dotée d’une fonction d’étiquetage du temps Γ NI→ℜ+ qui donne la date associée à un nœud interne L’ensemble d’apprentissage est une collection de situations S= {se=0 m} Une situation se est l’ensemble des valeurs vj prises par un ensemble de variables X= {xi} à chaque instant d’observation tk conduisant à une décision an particulière Table 1 Une situation se réfère à une horloge à temps discret où tk≡kT k∈ℵ et T∈ℜ+ T est une période d’échantillonnage x1 x2 x3 t0 t1 t2 t3 t0 t1 t2 t3 t0 t1 t2 t3 Dec Dl s1 n v n n h h n n l v v v a1 t3 s2 h h v h n n h n n a2 t2 TAB 1 – Exemple de table temporelle de décision Dans la table 1 les variables x1 x2 x3 prennent une valeur qualitative n h l ou v aux instants d’observations t0 t1 t2 t3 Dans la première situation s1 resp s2 la décision a1 resp a2 doit être prise au plus tard à la date t3 resp t2 Cette date est dite limite car la connaissance de la valeur des variables au delà de cette date est inutile à la prise de décision 512 RNTI E 6 N Benayadi et al [ ]{ [ ] [ ] { }ellekjki ejiekem 1 0et Ss s Dlmin S Dlt x sTtdt x sTtd Xx Ss s S Dl tt SSSS ∈=∧= ∈∀∈∀∈∀∈∀= =≈ 3 Une partition Se est un sous ensemble de S contenant des situations identiques sur un intervalle de temps ∀tk∈[tmin tmax] ∀x∈X ∀si sj ∈P Ttd[si x tk]=Ttd[sj x tk] ⇒ si≡sj Ainsi à chaque instant d’observation t S est partitionné en un ensemble de partitions S≈ t= {Se=0 m} équation 3 TemporalID3 construit un arbre en recherchant un intervalle de temps qui maximise un critère lié au nombre de partitions Puis de la même manière qu’ID3 TemporalID3 choisit la variable xi t qui minimise l’entropie sur cet intervalle 4 et créé le nœud correspondant Toutes les valeurs des variables à tous les instants précédent t sont éliminées du tableau y compris celle de xi t puis TemporalID3 recommence son traitement ∑ = =×== k 1j v t xjii S v t x P S t x ji ξξ 4 3 Représentation des séquences Nous proposons d’adapter l’algorithme TemporalID3 à un ensemble d’apprentissage Ω={ωn} contenant des séquences ωn d’occurrences d’événements discrets classées en séquences Ok et Ko selon qu’elle conduisent ou non à une occurrence d’une classe d’événements particulière L’adaptation consiste pour l’essentiel à représenter un ensemble de séquences dans une table similaire à celle de la table 1 mais où les valeurs sont datées selon une structure de temps continu i e tk+1 tk≠T une occurrence d’événement discret indique le fait qu’une variable change de valeur et la date de ce changement [ [ jit =∧=∈∀⇒ ∈≡≡∀ +++ ++ 1k1kk1kk 1k1kkk txt x t to o jx to ix to ω 5 Une séquence ω={ok}k=0…m 1 est une suite ordonnée de m occurrences ok≡ tk x i d’événements discrets ek≡ x i où tk∈Γ⊂ℜ+ est la date de l’affectation de la valeur i à la variable x Bouché P et Le Goc 2005 Un couple ok ok+1 de deux occurrences successives liées à une même variable x décrit l’évolution temporelle de la fonction discrète x t définie sur ℵ équation 5 L’ensemble des événements discrets Ed={ek≡ x i } est partitionné en un ensemble de classes Cj={ek} La notation “oi Ck” signifie que l’occurrence oi appartient à la classe Ck Une fonction d fournit la date d’une occurrence en sorte qu’une séquence ωn d’un ensemble Ω={ωn } définie son propre sous ensemble Γωn= {tj} de date inclus dans l’ensemble des dates Γ défini par Ω équation 6 où O désigne l’ensemble des occurrences de Ω Un modèle de chroniques est un ensemble de relations binaires temporellement contraintes entre des classes d’événements équation 7 ΓΓΓ do tod ix toΓ d k jkjk ⊆∧∈⇒∈Ω∈∀ =∈≡∀→ nnknn n o O ωωωω ω 6 [ ] [ ] +− +− ∈−∧∧ Ω⊆∈∃⇔ ττ ωττ kn i k o n kn oi ododCoCo ooCCR 7 Une séquence classée Ok notée ωnok est un exemple qui respecte toutes les contraintes logiques et temporelles d’un modèle de chroniques Une séquence classée Ko notée ωnko est un contre exemple Un contre exemple respecte toutes les contraintes d’un modèle de chroniques sauf la dernière relation binaire qui concerne la classe à prévoir 513 RNTI E 6 Approche entropique pour l’analyse de modèle de chroniques Par exemple considérons une séquence ω0 de 70 occurrences des classes A B C D décrivant l’évolution des variables v_a v_b v_c et v_d sur une période de temps donnée et un modèle de chroniques déduit sur cette séquence selon une approche stochastique P Bouché et Le Goc 2005 figure 1 Ce modèle de chroniques défini un ensemble d’apprentissage Ω={ωn} contenant 8 sous séquences de ω0 classées Ok et 16 classées Ko figure 2 Pour pouvoir être comparées les occurrences doivent être datées en temps relatif en prenant pour référence la date de la dernière occurrence Soit tmax la date de la dernière occurrence dans une séquence ωi définissant un ensemble Γωi de dates tmax = max{tk=0 … n tk∈Γωi } L’inversion des dates d’occurrences des classes dans une séquence ωi s’effectue simplement de la manière suivante ∀ok∈ωi d ok = tmax d ok La date limite Dl ωn d’une séquence ωn est la date la plus grande dans une séquence inversée Dl ωn = max{tk| ∃ o∈ωn d o =tk} Par extension la date limite globale Dl Ω d’un ensemble de séquences Ω = {ωn} est la plus petite des dates limites de chaque séquence Dl Ω = min {Dl ωn | ωn ∈ Ω} ω0 = { 0 8774 B 1 9313 A 2 8625 C 3 8718 A 4 4063 B 4 7837 D 6 0282 B 6 0874 C 6 2531 A 8 0034 D 8 4572 A 9 2311 A 9 4742 C 9 5447 B 9 8285 A 10 6631 B 11 3967 A 12 9826 B 13 4464 A 13 621 B 13 7333 C 14 1756 D 14 6806 A 15 9598 B 16 0240 A 16 7736 C 18 2447 D 18 3639 A 18 9228 B 19 0749 A 19 3406 C 21 1271 B 21 3377 A 22 6778 A 23 0197 D 23 8478 C 24 0392 B 24 3164 A 25 7974 A 26 1294 C 26 5961 A 26 882 B 28 3387 B 28 9188 D 29 1697 A 29 7840 B 31 1968 C 31 2985 A 32 1786 A 33 3798 B 33 798 A 33 8452 C 34 6423 B 35 1186 A 36 0294 A 37 0752 A 37 4236 B 37 4543 D 38 31 B 39 0201 C 39 1335 A 40 2009 B 41 1502 A 41 992 C 42 5301 A 43 0774 B 43 4958 A 43 8625 B 46 3524 C 49 6673 C } A C A B [ ]14 2 0 [ ]642 1 0[ ]51 1 0 FIG 1 – Séquence ω0 et modèle de chroniques déduit Ω défini un ensemble X=∪Xωi=0 n de variables xi et un ensemble Γ=∪Γωi=0 n d’instants d’observation tk Dans l’exemple X contient 4 variables et Γ 174 dates La construction d’une table temporelle de décision requiert la connaissance des valeurs de toutes les variables xi de X à tous les instants d’observation tk de Γ L’équation 5 ne permettant pas de déduire toutes les valeurs prises par une variable dans une séquence ωi donnée la table de décision doit être complétée en introduisant une occurrence d’événement de la forme ok≡ t x ok C où C désigne la classe des valeurs inconnues FIG 2 – Exemple de séquences Ok haut KO bas 4 Extraction d’un modèle de chroniques La table temporelle à temps continu est une matrice H définie sur Ω×X×Γ où un élément h[ωi x t] défini la classe liée à la valeur de la variable x à l’instant t dans la séquence ωi tel que si ok ≡ t x j ∈ ωi et ok Cl alors h[ωi x t] = Cl sinon h[ωi x t] est donné par l’équation 8 1 93 A 1 93 A 2 86 C 2 86 C 3 87 A 3 87 A 4 40 B 4 40 B 22 67 A 22 67 A 23 84 C 23 84 C 24 03 B 24 03 B 24 31 A 24 31 A 23 01 D 23 01 D 514 RNTI E 6 N Benayadi et al m i1kk1kk m 1k l k 1k1kkk Ct]x h[ω[ t [tt o oC oC o ω j x toi x to =∈∀⇒∧∧ ∈≡≡∀ +++ ++ 8 La date limite d’une séquence est la date de la dernière occurrence sans prendre en compte les occurrences ajoutées par complétion La figure 3 montre le résultat de l’application de TemporalID3 sur Ω C 〈v_a 0 092626〉 〈v_c 1 08452〉 Ok Ok 〈v_c 0 68979〉 A C C 〈v_a 1 471358〉 〈v_c 1 747701〉 〈v_c 1 784185〉 OkOk C A C C C C A B [ ]0 79 52 0 [ ] 660 47 0 C 〈v_a 0 092626〉 〈v_c 1 08452〉 Ok Ok 〈v_c 0 68979〉 A C C 〈v_a 1 471358〉 〈v_c 1 747701〉 〈v_c 1 784185〉 OkOk C A C C C C 〈v_a 0 092626〉 〈v_c 1 08452〉 Ok Ok 〈v_c 0 68979〉 A C C 〈v_a 1 471358〉 〈v_c 1 747701〉 〈v_c 1 784185〉 OkOk C A C C C C A B [ ]0 79 52 0 [ ] 660 47 0 C A B [ ]0 79 52 0 [ ] 660 47 0 FIG 3 Arbre temporel de décision et modèle de chronique déduit Le modèle de chroniques est construit en ne considérant que les branches menant à une décision Ok en parcourant l’arbre en profondeur d’abord depuis les feuilles terminales à la racine de l’arbre les dates ont été inversées Le modèle est initialisé par la classe C1 correspondant à la décision Ok i e B Pour tout arc n1→n2 ∈Ε de l’arbre la classe C2 associée n2 est créée dans le modèle de chroniques et une relation R C2 C1 [τ1 τ2] est créée avec τ1 = Γ n2 Γ n1 dm C2 et τ2 = Γ n2 Γ n1 +dm C1 où dm Ci est la moyenne des durées écoulées entre les occurrences de la même classe Ci dans les séquences ωn de Ω Le modèle de chroniques de la figure 3 est construit à partir de la branche v_a 0 092626 → v_c 0 68979 → Ok La relation R A C [0 2 14] du modèle de la figure 1 n’apparaît pas dans le modèle produit par l’approche entropique Cela induit l’idée que cette relation n’apporte que peu d’information pour prédire une occurrence de la classe B 5 Conclusion Cet article propose une adaptation de l’algorithme TemporalID3 pour la découverte des modèles de chroniques à partir d’un ensemble de séquences d’occurrences d’événements discrets L’intérêt de cette approche est d’utiliser un critère de minimisation entropique pour identifier les classes des modèles de chroniques les plus signifiantes afin de prédire l’occurrence d’une classe dans une tâche de diagnostic de systèmes dynamiques Les premiers résultats obtenus invitent à envisager une combinaison des approches entropiques et stochastiques pour découvrir des connaissances temporelles avec un fort pouvoir anticipatif Références Agrawal R K I Lin H S Sawhney et K Shim 1995 Fast similarity search in the presence of noise scaling and translation in time series databases In Proc of the 21st Int'l Conf on Very Large Databases pp 490 50 515 RNTI E 6 Approche entropique pour l’analyse de modèle de chroniques Bouché P et M Le Goc 2005 Analyse stochastique de séquences d'événements discrets pour la découverte de signatures Revue des Nouvelles Technologies de l’Information RNTI E 3 Extraction et gestion des connaissances EGC Volume 1 p 103 114 Breiman L J H Friedman R A Olshen et C J Stone 1984 Classification and Regression Trees Belmont CA Chapman Hall Console L C Picardi et D Theiser Dupré 2003 Temporal Decision Trees Model based Diagnosis of Dynamic Systems On Board Journal of Artificial Intelligence Research 19 pp 469 512 Das G K Lin H Mannila G Renganathan et P Smyth 1998 Rule Discovery from Time Series International Conference on Knowledge Discovery Data Mining p 16 22 Dousson C T Vu Duong 1999 Discovering Chronicles with Numerical Time Constraints from Alarms Logs for Monitoring Dynamic Systems the 1 th International Join conference on Artificial Intelligence IJCAI'99 pp 620 626 Drucker C S Hubner U Visser et H G Weland 2001 “As Time Goes by” Using Time Series Based Decision Tree Induction to Analyze the Behaviour of Opponent Players RoboCup 2001 Robot Soccer World Cup V LNAI 2377 pp 325–330 Berlin Springer Verlag Faloutsos C M Ranganathan et Y Manolopoulos 1994 Fast Subsequence Matching in Time Series Databases ACM SIGMOD Int Conf on Management of Data 419 429 Geurts P 2001 Pattern extraction for time series classication Principles of Data Mining and Knowledge Discovery LNAI 2168 pp 115–127 Berlin Springer Verlag Kadous M 1999 Learning comprehensible descriptions of multivariate time series Proceedings of the Sixteenth International Conference on Machine Learning pp 454– 463 San Francisco Morgan Kaufmann Keogh E et P Smyt 1997 A probabilistic approach to fast pattern matching in time series databases In Proc third international conference on knowledge discovery and data mining California AAAI Press Menlo Park California 24 30 Le Goc M P Bouché et N Giambiasi 2005 Stochastic Modeling of Continuous Time Discrete Event Sequence for Diagnosis 16th International Workshop on Principles of Diagnosis DX’05 Monterey California USA June 1 3 2005 p 133 138 Murthy S K 1998 Automatic Construction of Decision Trees from Data A Multi disciplinary Survey Data Mining and Knowledge Discovery vol 2 no 4 pp 345 389 Quinlan J R 1986 Induction of decision trees Machine Learning 1 81 106 Rodriguez J J et C J Alonso 2004 Interval and Dynamic Time Warping based Decision Trees Symposium on Applied Computing Proceedings of the 2004 ACM symposium on Applied computing 548 552 Summary This article proposes an adaptation of the TemporalID3 algorithm to analyze chronicle models discovered by a stochastic approach where discrete event sequences are alarms generated by a knowledge base system for monitoring and diagnosis of dynamic systems 516 RNTI E 6