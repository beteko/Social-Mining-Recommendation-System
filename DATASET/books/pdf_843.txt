 Interprétation d’images basée sur une approche évolutive guidée par une ontologie Germain Forestier Sébastien Derivaux Cédric Wemmert et Pierre Gançarski LSIIT CNRS Université Louis Pasteur UMR 7005 Pôle API Bd Sébastien Brant 67412 Illkirch France {forestier derivaux wemmert gancarski} lsiit u strasbg fr Résumé Les approches de fouille et d’interprétation d’images consistant à con sidérer les pixels de façon indépendante ont montré leurs limites pour l’analyse d’images complexes Pour résoudre ce problème de nouvelles méthodes s’ap puient sur une segmentation préalable de l’image qui consiste en une agrégation des pixels connexes afin de former des régions homogènes au sens d’un certain critère Cependant le lien est souvent complexe entre la connaissance de l’expert sur les objets qu’il souhaite identifier dans l’image et les paramètres nécessaires à l’étape segmentation permettant de les identifier Dans cet article la connais sance de l’expert est modélisée dans une ontologie qui est ensuite utilisée pour guider un processus de segmentation par une approche évolutive Cette méthode trouve automatiquement des paramètres de segmentation permettant d’identifier les objets décrits par l’expert dans l’ontologie 1 Introduction L’interprétation automatique d’images devient un processus de fouille de données de plus en plus complexe Pour les images à très haute résolution l’utilisation de l’approche dite ori entée objet consiste à identifier dans l’image souvent à l’aide d’une segmentation de l’image des objets composés de plusieurs pixels connexes et ayant un intérêt pour l’expert du domaine Il existe de nombreux algorithmes de segmentation Néanmoins ces techniques nécessi tent souvent une paramétrisation complexe telle que le choix de seuils ou de pondérations Le nombre de paramètres augmente bien souvent avec la complexité des algorithmes Ainsi l’util isateur amené à définir ces paramètres a souvent du mal à faire le lien entre sa connaissance sur les objets présents dans l’image et les paramètres adéquats pour les construire et les identifier dans une segmentation L’utilisation des algorithmes génétiques Goldberg 1989 est une solution à ce problème de recherche des paramètres optimaux Ils peuvent être utilisés pour optimiser un ensemble d’attributs si une fonction d’évaluation des paramètres est disponible Les méthodes existantes d’optimisation de segmentation par approche génétique Pignalberi et al 2003 Bhanu et al 1995 Song et Ciesielski 2003 Feitosa et al 2006 se basent sur des fonctions d’évalua tions demandant des exemples d’objets segmentés fournis par l’expert Si aucun exemple n’est disponible il est possible d’utiliser des critères non supervisés Bhanu et al 1995 Feitosa Interprétation d’images guidée par une ontologie et al 2006 c’est à dire jugeant la qualité intrinsèque que doit avoir une segmentation e g ho mogénéité des régions Néanmoins ces critères non supervisés sont souvent insuffisants pour obtenir une segmentation de bonne qualité notamment pour l’analyse d’images complexes Dans cet article nous proposons d’utiliser des connaissances du domaine afin d’évaluer la qualité d’une segmentation En effet l’approche orientée objet permet à l’expert d’exprimer ses connaissances sur les objets de l’image Ce nouveau cadre de discernement permet de raisonner sur des régions et non sur des pixels ce qui permet une description intuitive et naturelle des ob jets pouvant être présents dans une image Une ontologie ou base de connaissance peut alors être utilisée pour définir les différents types d’objets du domaine i e concepts de l’image ainsi que leurs caractéristiques Il devient alors possible d’évaluer la cohérence d’une segmen tation par rapport aux concepts définis dans cette ontologie Cette approche a l’avantage de ne pas nécessiter d’exemples et utilise la connaissance définie dans l’ontologie Le plan de cet article est le suivant Tout d’abord nous introduisons l’algorithme de seg mentation ainsi que ses paramètres Nous présentons ensuite la modélisation de la connais sance sous la forme d’une ontologie Nous étudions ensuite comment un algorithme génétique est utilisé pour choisir les paramètres de la segmentation grâce à une évaluation utilisant l’on tologie Finalement nous présentons des expérimentations dans le cadre de l’interprétation d’images pour l’observation de la Terre 2 Segmentation d’image Dans cet article nous utilisons l’algorithme de segmentation par ligne de partage des eaux Vincent et Soille 1991 ainsi que les méthodes de seuillage du gradient de la réduction de dynamique et de fusion de régions Ces différentes techniques sont utilisées simultanément pour réduire la sur segmentation provoquée par la ligne de partage des eaux et nécessitent donc de définir 3 paramètres le seuil du gradient le seuil de dynamique et le seuil de fusion Les valeurs optimales de ces paramètres sont difficiles à trouver car la valeur pour un paramètre donné dépend des valeurs choisies pour les autres paramètres De plus il existe de nombreux optima locaux ce qui accroît la difficulté de trouver la meilleure solution 3 Ontologie d’objets géographiques Nous présentons ici les principes de l’ontologie d’objets géographiques définie dans Bris son et al 2007 puis étendue dans Durand et al 2007 Cette ontologie se présente comme une hiérarchie de concepts ainsi que des relations entre ces concepts Un mécanisme d’ap pariement permet de comparer une région construite lors d’une segmentation et les différents concepts définis dans l’ontologie L’ontologie est formée d’une hiérarchie de concepts dont la figure 1 présente un extrait Dans cette hiérarchie chaque noeud correspond à un concept Chaque concept a une éti quette e g pavillon et est défini par des attributs Chaque attribut est associé à un inter valle de valeurs acceptées pour cet attribut e g [50 60] ainsi qu’une pondération dans [0 1] représentant son importance pour reconnaître l’objet géographique correspondant à ce concept 1 indiquant que cet attribut est très pertinent Les valeurs de ces concepts ont été renseignées par les experts géographes grâce à leur connaissance de la morphologie des objets urbains G Forestier et al Ombre EauVegetation Lac Pavillon_Orange Objet Non_Mineral Sol_Nu_Orange Mineral_Blanc Mineral_Gris_Blanc Batiment_Orange est_un est_un Mineral Mineral_Orange FIG 1 – Extrait de l’ontologie Certaines informations ont également été extraites de bases de données topographiques ou de connaissances sur les réponses spectrales de certains types de matériaux tuile bitume Un mécanisme d’appariement de région permet d’évaluer la similarité entre une région construite lors d’une segmentation et les concepts définis dans la hiérarchie de l’ontologie Ce mécanisme permet d’obtenir la signification sémantique d’une région si les caractéristiques de celle ci se rapprochent de la description d’un des concepts définis dans l’ontologie L’ap pariement d’une région consiste à vérifier la validité des caractéristiques extraites de celle ci réponse spectrale taille élongation en fonction des propriétés et des contraintes définies dans les concepts de l’ontologie 4 Algorithme génétique Les algorithmes génétiques Goldberg 1989 font partie des méthodes d’optimisations Ils sont reconnus pour être efficaces même lorsque l’espace de recherche est vaste et contient de nombreux maxima locaux Ces algorithmes sont d’inspiration biologique avec des notions d’individus i e solutions et de population d’individus qui évoluent pour s’améliorer à travers des opérations de sélection croisement et mutation Dans cet article un individu représente le vecteur des paramètres de la méthode de segmentation On considère que les valeurs de ces paramètres sont définies entre zéro et un on obtient donc un espace de recherche à 3 dimensions pour la ligne de partage des eaux trois seuils Nous utilisons un taux de mutation de 1% et un nombre de générations de 14 des tests ayant montré que plus de générations n’amélioraient pas les résultats La définition de la fonction d’évaluation est une des étapes les plus importantes dans un système d’évolution génétique Nous cherchons ici à utiliser les connaissances de l’ontologie pour guider le processus évolutif et trouver les paramètres qui permettent de maximiser la découverte d’objets dans l’image Nous allons donc utiliser comme fonction d’évaluation le pourcentage de la surface de l’image qui est identifié par l’ontologie Chaque individu i va donc produire un vecteur de paramètres produisant une segmentation de l’image Soit Ri les régions de la segmentation issue de l’individu i et Rio les régions identifiées par l’ontologie Rio ⊆ Ri Le pourcentage de la surface de l’image reconnu par l’ontologie est défini par F i = ∑ r∈Rio Aire r ∑ r∈Ri Aire r Interprétation d’images guidée par une ontologie a image brute b 5% reconnu sans paramètre c 29% reconnu 1ère génération d 33% reconnu 3ème génération e 37% reconnu 5ème génération f 51% reconnu 11ème génération FIG 2 – Extraits de segmentations obtenues à différentes générations au cours d’une évolu tion génétique Le contours des régions est affiché en blanc avec Aire r une fonction renvoyant la surface en pixel de la région r La surface des régions identifiées a été préférée à leur nombre pour évaluer le résultat comme nous cherchons ici à maximiser la surface de l’image reconnue par l’ontologie 5 Expérimentations La méthode proposée a été évaluée sur une image de Strasbourg prise par le satellite Quick bird La figure 2 présente des extraits de segmentations avec les paramètres obtenus au cours d’une évolution génétique aux générations 1 3 5 et 11 On observe une réduction de la sous segmentation trop peu de régions au cours des générations et une amélioration de la con struction des objets l’image étant de mieux en mieux interprétée par l’ontologie Pour valider ces résultats nous avons évalué la qualité des segmentations obtenues avec des vérités terrains de trois classes pavillon végétation et route Les évaluations sont effectuées sur des objets géographiques construits et labellisés manuellement par un expert Trois indices de qualité ont été utilisés pour évaluer la qualité des segmentations le rappel en considérant la reconnais sance de l’ontologie comme une classification pixel l’indice de Janssen Janssen et Molenaar 1995 et l’indice de Feitosa Feitosa et al 2006 qui évaluent la qualité des régions construites Nous avons évalué notre critère d’évaluation surface reconnue par l’ontologie par rapport à ces trois critères Pour chacun des critères une moyenne est calculée sur l’ensemble des objets G Forestier et al 0 0 1 0 2 0 3 0 4 0 5 0 6 0 50 100 150 200 0 0 05 0 1 0 15 0 2 0 25 0 3 0 35 0 4 0 45 rappel ontologie a Rappel 0 0 1 0 2 0 3 0 4 0 5 0 6 0 50 100 150 200 0 0 05 0 1 0 15 0 2 0 25 0 3 0 35 0 4 0 45 janssen ontologie b Janssen 0 100 200 300 400 500 600 700 800 0 50 100 150 200 0 55 0 6 0 65 0 7 0 75 0 8 0 85 0 9 0 95 1 feitosa 1 ontologie c Feitosa FIG 3 – Évolution des fonctions d’évaluation pour 200 individus ordonnés par le critère basé sur l’ontologie génération Ontologie Rappel Janssen Feitosa 1ère 29 64 % 24 98 % 0 32 25 19 3ème 33 92 % 27 83 % 0 35 17 55 5ème 37 56 % 31 74 % 0 42 6 63 11ème 51 91 % 49 72 % 0 48 7 10 TAB 1 – Résultat de l’évaluation de la méthode sur les objets experts pour 4 générations fournis par l’expert Le but de cette analyse est de vérifier que l’amélioration de notre critère conduit bien à une amélioration de la segmentation Au cours d’une évolution génétique nous avons évalué chaque individu en fonction de ces différents critères Ainsi 200 paramétrages possibles ont été évalués Ils ont ensuite été ordonnés en fonction de notre critère d’évaluation La figure 3 présente les courbes pour les différents indices Nous pouvons constater que dans les trois cas les deux courbes semblent avoir même comportement et être corrélées Ces résul tats montrent qu’optimiser notre critère est pertinent et permet d’effectuer des segmentations de qualité sans contraindre l’expert à fournir des exemples Enfin le tableau 1 présente les valeurs de ces indices avec les paramètres trouvés au cours des générations 1 3 5 et 11 la qualité n’évoluant plus après On constate que les différentes mesures d’évaluation sont optimisées au cours de l’évolution sauf une légère augmentation de l’indice Feitosa sur la dernière génération due à une sur segmentation de la végétation mais qui n’influe pas sur la reconnaissance de l’ontologie la taille d’une région n’étant pas discriminante pour caractériser la végétation 6 Conclusion Dans cet article nous avons présenté un mécanisme permettant de guider un processus automatique d’interprétation d’images grâce à une ontologie Cette ontologie représente la connaissance des experts sous la forme d’une hiérarchie de concepts d’une caractérisation de ces concepts et des relations entre ces concepts Un processus évolutif va alors chercher les paramètres de segmentation produisant des régions qui seront bien identifiées par l’ontologie Ainsi nous disposons d’une méthode d’interprétation automatique d’images de télédétection basée sur la connaissance des experts à propos des objets à identifier Interprétation d’images guidée par une ontologie Des résultats intéressants ont montré la validité du système Il est à noter que n’importe quel algorithme de segmentation nécessitant des paramètres peut remplacer celui présenté dans cet article Dans le futur nous souhaitons intégrer des connaissances contextuelles position des objets entre eux nécessaire à l’identification de certains objets Références Bhanu B S Lee et S Das 1995 Adaptive image segmentation using genetic and hybrid search methods IEEE Transactions on Aerospace and Electronic Systems 31 4 1268– 1291 Brisson R O Boussaid D P Gancarski A Puissant et N Durand 2007 Navigation et appariement d’objets géographiques dans une ontologie In 7ème Journées Francophones Extraction et Gestion des Connaissances EGC 2007 pp 391–396 Durand N S Derivaux G Forestier C Wemmert P Gancarski O Boussaid D et A Puissant 2007 Ontology based object recognition for remote sensing image interpretation In IEEE International Conference on Tools with Artificial Intelligence Patras Greece pp 472–479 Feitosa R Q G A Costa T B Cazes et F B 2006 A genetic approach for the automatic adaptation of segmentation parameters In International Conference on Object based Image Analysis Goldberg D E 1989 Genetic Algorithms in Search Optimization and Machine Learning Addison Wesley Professional Janssen L et M Molenaar 1995 Terrain objects their dynamics and their monitoring by the integration of gis and remote sensing In IEEE Transactions on Geoscience and Remote Sensing Volume 33 pp 749–758 Pignalberi G R Cucchiara L Cinque et S Levialdi 2003 Tuning range image segmenta tion by genetic algorithm EURASIP Journal on Applied Signal Processing 2003 8 780– 790 Song A et V Ciesielski 2003 Fast texture segmentation using genetic programming In IEEE Congress on Evolutionary Computation Volume 3 pp 2126–2133 Vincent L et P Soille 1991 Watersheds in digital spaces An efficient algorithm based on immersion simulations IEEE Pattern Analysis and Machine Intelligence 13 6 583–598 Summary Approaches for images mining and interpretation which consider pixels individually have shown theirs limits to analyse complex images To resolve this problem new methods use a segmentation of the image which consists in an aggregation of connected pixels to build homogeneous regions However the link is often complex between expert knowledge about objects he wishes to identify within the image and parameters needed for the segmentation step In this article we propose to modelise expert knowledge on objects present in an image through an ontology This ontology will be used to drive a segmentation process by an evolutionary approach This method finds automatically segmentation parameters which identify objects described by the expert in the ontology 