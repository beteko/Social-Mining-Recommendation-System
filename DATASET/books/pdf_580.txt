 gridSize epsSélection des variables informatives pour l’apprentissage supervisé multi tables Dhafer Lahbib Marc Boullé Dominique Laurent France Télécom R D 2 avenue Pierre Marzin 23300 Lannion dhafer lahbib orange ftgroup com marc boulle orange ftgroup com ETIS CNRS Universite de Cergy Pontoise ENSEA 95000 Cergy Pontoise dominique laurent u cergy fr Résumé Dans la fouille de données multi tables les données sont représentées sous un format relationnel dans lequel les individus de la table cible sont poten tiellement associés à plusieurs enregistrements dans des tables secondaires en relation un à plusieurs La plupart des approches existantes opèrent en transfor mant la représentation multi tables notamment par mise à plat Par conséquent on perd la représentation initiale naturellement compacte mais également on risque d’introduire des biais statistiques Notre approche a pour objectif d’éva luer l’informativité des variables explicatives originelles par rapport à la variable cible dans le contexte des relations un à plusieurs Elle consiste à résumer l’in formation contenue dans chaque variable par un tuple d’attributs représentant les effectifs des modalités de celle ci Des modèles en grilles multivariées sont alors employés pour qualifier l’information apportée conjointement par les nou veaux attributs ce qui revient à une estimation de densité conditionnelle de la variable cible connaissant la variable explicative en relation un à plusieurs Les premières expérimentations sur des bases de données artificielles et réelles montrent qu’on arrive à identifier les variables explicatives potentiellement per tinentes sur tout le domaine relationnel 1 Introduction Tandis que dans les méthodes de fouille de données classiques les données sont stockées dans une seule table la Fouille de données mutli tables en anglais Multi Relational Data Mi ning MRDM s’intéresse à l’extraction de connaissances à partir de bases de données relation nelles multi tables Knobbe et al 1999 Typiquement en MRDM les individus sont contenus dans une table cible en relation un à plusieurs avec des tables secondaires En apprentissage supervisé un attribut cible devrait être défini au sein de la table cible ce qui correspond à la variable à expliquer par analogie au cas mono table Pour prendre en compte les relations un à plusieurs la plupart des méthodes MRDM opèrent en transformant la représentation relationnelle dans le paradigme de la Program mation Logique Inductive ILP Džeroski 1996 les données sont recodées sous la forme de Sélection des variables informatives pour l’apprentissage supervisé multi tables                                                         FIG 1 Variable secondaire binaire prédicats logiques ce qui pose des problèmes de passage à l’échelle surtout sur de gros vo lumes de données Blockeel et Sebag 2003 D’autres méthodes dites par propositionalisation opèrent par mise à plat Kramer et al 2001 Elles cherchent à agréger l’information contenue dans les différentes tables les transformant ainsi sous un format tabulaire classique par créa tion de nouvelles variables Par conséquent non seulement on perd la représentation initiale naturellement compacte mais encore on risque d’introduire des biais statistiques notamment à cause des dépendances qui peuvent exister entre les variables nouvellement créées Notre objectif dans cet article est d’étudier l’informativité d’une variable explicative située dans une table secondaire en relation un à plusieurs 1 avec la table cible Elle peut être évaluée en mesurant la probabilité conditionnelle P Y | A où Y est la variable cible et A est une variable explicative secondaire Ceci peut être très utile pour une étape de sélection de variable de type filtre Guyon et Elisseeff 2003 ou encore pour proposer un algorithme de classification dans le contexte multi tables nécessitant un prétraitement univarié telle que les méthodes de type Bayésien Naïf ou les arbres de décision Après avoir présenté dans la section 2 les principes de notre approche nous décrivons dans la section 3 les résultat d’évaluation obtenus sur des données artificielles Enfin la section 4 conclut cet article 2 Approche Pour simplifier le problème nous nous limitons dans cet article au cas le plus simple celui d’une variable binaire qui ne peut prendre que deux valeurs a et b Dans le cas mono table à chaque individu correspond une seule valeur pour la variable considérée Dans le cas d’une re lation un à plusieurs un individu est décrit par une liste éventuellement vide de valeurs parmi a et b dont la taille varie d’un individu à l’autre Évaluer la pertinence de la variable avec cette représentation est difficile Une solution possible consiste à résumer la variable à l’aide d’une représentation équivalente plus compacte en introduisant deux nouvelles variables na et nb qui 1 Dans le cas des relations un à un on se ramène au cas mono table Précisons que pour des raisons de simplifi cation on se limite ici au premier niveau de relation tables en relation directe avec la table cible D Lahbib et al représentent respectivement le nombre d’occurrences de a et de b 2 Considérer ces deux nou velles variables indépendamment l’une de l’autre ne permet pas de saisir toute l’information sur la variable initiale l’information sur les ratios de chacune des valeurs na na+nb et nb na+nb ainsi que l’effectif total na + nb seront perdus La solution que nous proposons consiste à considérer les deux variables na et nb conjointement Ainsi toute l’information de la variable initiale est préservée La probabilité P Y | A sera alors équivalente à P Y | na nb Pour qualifier l’information prédictive contenue dans la paire de variables numériquesna et nb nous utilisons des modèles en grille de données selon l’approche MODL appliquée au cas bivarié Boullé 2007 La méthode consiste à discrétiser chacune des deux variables numériques en intervalles Les individus sont alors partitionnés en une grille dont les cellules sont définies par des paires d’intervalles La distribution de la variable à expliquer dans chaque cellule se déduit à partir du produit cartésien des deux partitions univariées qui répartit les individus sur la grille cf figure 1 C’est une représentation interprétable puisqu’elle permet de voir la distribution des individus sur la grille en faisant varier conjointement les deux variables Dans l’approche MODL le problème de partitionnement de deux variables numériques est transposé en un problème de sélection de modèles La meilleure grille de données est choisie selon une approche MAP maximum a posteriori qui consiste à maximiser la pro babilité d’un modèle en grille connaissant les données p Modèle|Données En appliquant la formule de Bayes le problème se ramène à maximiser p Modèle p Données|Modèle Notons par N le nombre d’individus de l’échantillon nombre d’enregistrements de la table cible J le nombre de valeurs de la variable à expliquer et Niaib le nombre d’individus de la cellule ia ib Les paramètres d’un partitionnement particulier sont le nombre d’intervalles Ia et Ib les bornes des intervalles {Nia }1"ia"Ia et {N ib }1"ib"Ib et les effectifs de la variable à expliquer {Niaibj}1"ia"Ia 1"ib"Ib par cellule ia ib Un modèle de partitionnement bivarié est donc entièrement défini par les paramètres {Ia Ib {Nia } {N ib } {Niaibj}} La distri bution a priori des modèles p Modèle et la vraisemblance des données p Données|Modèle sont calculées analytiquement en exploitant le caractère discret de la famille de modèles et en adoptant des hypothèses faiblement informatives sur les données La meilleure grille est celle qui minimise le critère de l’equation 1 Boullé 2007 log N + log N + log CN+Ia 1Ia 1 " + log CN+Ib 1Ib 1 " + Ia ia=1 Ib ib=1 log C Niaib +J 1 J 1 " + Ia ia=1 Ib ib=1 log Niaib Niaib1 Niaib2 NiaibJ 1 Les cinq premiers termes représentent la probabilité a priori du modèle le choix des nombres d’intervalles des bornes des intervalles et de la distribution de la variable à expliquer dans chaque cellule de la grille Le dernier terme correspond à la vraisemblance Le critère d’évaluation du partitionnement bivarié est optimisé en partant d’une solution initiale aléatoire et en alternant les optimisations partielles par variable Les optimisations partielles sont effectuées grâce à une heuristique gloutonne ascendante décrite dans Boullé 2006 Ce critère permet d’effectuer une sélection de variables de type filtre en classant celles ci par valeur de critère décroissante 2 Cette représentation est bien équivalente puisqu’on peut retrouver toute l’information initiale nous supposons que l’ordre des éléments dans la table secondaire n’a pas d’importance et nous ne considérons qu’une seule variable à la fois Sélection des variables informatives pour l’apprentissage supervisé multi tables 0 20 40 60 80 100 0 20 40 60 80 100 nb na a Motif "Aléatoire" P c = 0 = P c = 1 = 0 5 0 20 40 60 80 100 0 20 40 60 80 100 nb na b Motif basé sur les "Effectifs" si na seuil alors c = 1 si na < seuil alors c = 0 0 20 40 60 80 100 0 20 40 60 80 100 nb na c Motif basé sur les "Proportions" si na na+nb R alors c = 1 si na na+nb < R alors c = 0 0 20 40 60 80 100 0 20 40 60 80 100 nb na d Motif combinant "Effectifs et Proportions" si na N et nana+nb " R alors c = 0 avec 5% de bruit sinon c = 1 avec 5% de bruit 0 20 40 60 80 100 0 20 40 60 80 100 nb na e "Motif complexe" si na M1 2 + nb M2 2 R alors c = 1 avec 5% de bruit si na M1 2 + nb M2 2 < R alors c = 0 avec 5% de bruit FIG 2 Motifs et diagrammes de dispersion des bases de données artificielles générées 3 Expérimentations Pour évaluer l’intérêt de notre approche des tests ont été effectués sur des données artifi cielles 3 Les bases de données présentent une structure relationnelle composée de deux tables une table cible en relation un à plusieurs avec une table secondaire contenant une seule va riable explicative binaire Les paramètres du générateur de données sont le nombre d’individus enregistrements de la table cible et le nombre maximal d’enregistrements reliés à chaque in dividu dans la table secondaire La valeur de la variable à expliquer booléenne est générée selon un motif dans la variable secondaire La figure 2 illustre les diagrammes de dispersion des bases de données artificielles générées ainsi que les motifs utilisés ici le nombre d’enre gistrements secondaires par individu est aléatoire entre 0 et 100 Pour chaque base de données on applique l’approche décrite dans la section 2 afin d’obtenir la grille bivariée optimale correspondante Cette grille est utilisée comme une table de décision Pour classifier un individu en test On recherche la cellule de la grille associée aux valeurs de l’individu pour la paire de variables et on prédit la valeur de la classe majoritaire de la cellule d’après les effectifs collectés en apprentissage La pertinence d’une variable explicative se condaire est évaluée en se basant sur le taux de bonne prédiction et l’aire sous la courbe ROC AUC en test du classifieur en grille correspondant Pour cela nous appliquons une validation 3 D’autres tests sur la base réelle STULONG ont été également faits mais non commentés ici faute de place D Lahbib et al 0 0 2 0 4 0 6 0 8 1 10 100 1000 10000 100000 Ta ux d e bo nn e pr éd ic tio n en te st Nombre d’individus Aléatoire Effectifs Proportions Effectifs−Proportions Motif complexe a Test Accuracy en fonction du nombre d’individus 1 10 100 10 100 1000 10000 100000 Ta ille d e la g ril le e n no m br e de c el lu le s Nombre d’individus Aléatoire Effectifs Proportions Effectifs−Proportions Motif complexe b Taille de la grille en fonction du nombre d’individus FIG 3 Résultats obtenus sur les données artificielles de la figure 2 croisée stratifiée d’ordre 10 La taille de la grille optimale informe sur la complexité du motif éventuel dans la variable explicative La figure 3a illustre les résultats de classification pour les 5 bases de données artificielles et ceci pour un nombre d’individus variable Comme première constatation les résultats montrent que la méthode permet de détecter facilement un motif totalement aléatoire L’absence de l’in formation prédictive dans la grille bivariée se matérialise par une discrétisation en un seul intervalle figure 3b et un taux de bonne prédiction de l’ordre de 50% Le modèle nul est d’autant plus confirmé qu’il y a d’individus La méthode permet également de détecter des motifs plus ou moins complexes La figure 3a montre que les performances en classification s’améliorent avec le nombre d’individus dans la base et qu’avec suffisamment d’individus les taux de bonne prédiction atteignent approximativement les performances théoriques vu l’exis tence de bruit La taille de la grille bivariée varie selon la complexité du motif pour un motif assez simple basé sur les effectifs la grille est toujours composée de deux cellules pour des motifs plus complexes la taille de la grille augmente avec le nombre d’individus permettant ainsi d’approximer finement le motif 4 Conclusion Dans cet article nous avons proposé une approche pour évaluer la pertinence d’une variable explicative dans le contexte de l’apprentissage supervisé à partir des données relationnelles La méthode consiste à changer la représentation relationnelle initiale en une représentation tabulaire équivalente Les attributs générés représentent les effectifs des valeurs de la variable initiale Un modèle de discrétisation en intervalles de chacun de ces attributs est alors généré ce qui induit une partition multivariée Cette partition permet de qualifier l’information ap portée conjointement par tous les nouveaux attributs sur la variable cible L’information sur la variable explicative initiale n’est pas perdue ce qui est alors équivalent à évaluer la perti nence de celle ci Un critère d’évaluation est proposé dans le cas d’une variable secondaire binaire pour évaluer chaque partition bivariée au moyen d’une approche Bayesienne Nous avons évalué l’approche sur des bases de données artificielles et réelles Les premiers résultats sur des variables explicatives binaires montrent que le critère d’évaluation permet de sélection ner des variables fortement informatives Des travaux futurs sont envisagés pour proposer les procédures d’optimisation efficaces de ce critère dans le cas de variables catégorielles éven Sélection des variables informatives pour l’apprentissage supervisé multi tables tuellement avec un nombre important de valeurs et continues et d’intégrer les prétraitements des variables un à plusieurs dans des classifieurs de type Bayésien Naïf ou arbre de décision Références Blockeel H et M Sebag 2003 Scalability and efficiency in multi relational data mining ACM SIGKDD Explorations Newsletter 5 1 17 Boullé M 2006 MODL A Bayes optimal discretization method for continuous attributes Machine learning 65 1 131–165 Boullé M 2007 Une méthode optimale d’évaluation bivariée pour la classification supervi sée Extraction et gestion des connaissances EGC’2007 461–472 Džeroski S 1996 Inductive logic programming and knowledge discovery in databases pp 117–152 Menlo Park CA USA American Association for Artificial Intelligence Guyon I et A Elisseeff 2003 An Introduction to Variable and Feature Selection Journal of Machine Learning Research 3 1157–1182 Knobbe A J H Blockeel A Siebes et D Van Der Wallen 1999 Multi Relational Data Mining In Proceedings of Benelearn ’99 Kramer S P A Flach et N Lavrač 2001 Propositionalization approaches to relational data mining Chapter 11 pp 262–286 New York NY USA Springer Verlag Summary In multi relational data mining data is represented in a relational form where the individ uals of the target table are potentially related to several records in secondary tables in one to many relationship To cope with this one to many setting most of the existing approaches try to transform the multi tables representation namely by propositionalisation thereby los ing the naturally compact initial representation and eventually introducing statistical bias Our approach aims to directly evaluate the informativness of the original input variables over the relational domain w r t the target variable The idea is to summarize for each individual the information contained in the non target table variable by a features tuple representing the car dinalities of the initial modalities Multivariate grid models have been used to qualify the joint information brought by the new features which is equivalent to estimating the conditional den sity of the target variable given the input variable in non target table Preliminary experiments on artificial and real data sets show that potentially relevant one to many variables could be found 