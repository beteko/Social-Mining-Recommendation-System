RNTI_CaquardModélisation conceptuelle des trajectoires Christine Parent* Stefano Spaccapietra** Christelle Vangenot** Maria Luisa Damiani*** José de Macedo** Fabio Porto** *UNIL HEC ISI Dorigny CH 1015 Lausanne christine parent unil ch lbd epfl ch ~cparent christine html **EPFL IC LBD Station 14 CH 1015 Lausanne stefano spaccapietra christelle vangenot jose macedo fabio porto epfl ch lbd epfl ch ***Universitá Milano mdamiani dico unimi it Résumé Une perception intelligente du mouvement d'objets mobiles personnes voitures colis etc est à la base de nombreuses applications par exemple le suivi d'une distribution postale à travers le monde l'optimisation du trafic routier ou l'étude de la migration d’animaux Les systèmes de gestion de bases de données actuels n'offrent ni les concepts ni les fonctions nécessaires à une analyse sémantique du mouvement se limitant au stockage et à l'interrogation de positions spatiales individuelles hors contexte temporel Des travaux de recherche précédents ont introduit et développé le concept d'objet mobile ou spatio temporel Dans cet article nous allons plus loin en proposant le concept de trajectoire comme unité sémantique de mouvement sur laquelle se construit la vision applicative Nous proposons de décrire les trajectoires au niveau conceptuel avec leurs aspects géométriques temporels et sémantiques et leurs composants structurels point de départ point d'arrivée arrêts et déplacements intermédiaires Chaque élément trajectoire arrêt déplacement voire partie de déplacement peut recevoir des annotations sémantiques sous forme de valeurs d'attributs ou de liens vers des objets de la base L'approche de modélisation décrite dans cet article est basée sur les patrons de modélisation qui permettent une solution générique pour modéliser les caractéristiques standard des trajectoires tout en étant ouverte aux caractéristiques spécifiques à l'application envisagée Enfin l'implémentation dans une base de données relationnelle étendue est présentée 1 Introduction Le monde bouge et bien des phénomènes ne peuvent être compris sans étudier leurs mouvements Heureusement de nouvelles technologies GPS et autres transmetteurs capteurs et réseaux de capteurs marqueurs de type RFID permettent désormais de saisir des positions spatio temporelles et ainsi de suivre un grand nombre d'objets en mouvement Cette voie correspond aux besoins réels d'applications dans de nombreux domaines parmi lesquels l'analyse des déplacements des habitants d'une ville ou d'un état afin d'optimiser les 151 RNTI E 13 Modélisation conceptuelle des trajectoires infrastructures de transport le suivi d'une flotte de véhicules de livraison ou encore les études comportementales d'animaux migratoires Malheureusement les systèmes de gestion de base de données SGBD actuels n'offrent au mieux que la possibilité de traiter de positions fixes Toute la logique de modélisation et de traitement du mouvement est à la charge des programmes d'applications Le monde de la recherche a été plus loin en concrétisant au niveau du prototypage les concepts et les opérations liés à la gestion d'objets en mouvement dits objets mobiles Almeida et al 2006 Pelekis et al 2006 Toutefois ces travaux n'ont abordé que la dimension spatio temporelle du mouvement à savoir la trace géométrique du parcours de l'objet dans l'espace au cours du temps Cela est insuffisant pour les applications qui utilisent une vision plus structurée plus sémantique du mouvement Par exemple de nombreuses applications perçoivent le mouvement d'un objet non pas comme un déplacement unique qui commencerait au début de la vie de l'objet et ne se terminerait qu'avec elle mais comme une séquence de déplacements chaque déplacement ayant son propre but un lieu et un instant de départ bien définis et un lieu et un instant d'arrivée bien définis C'est entre autres le cas des applications qui analysent les déplacements quotidiens des employés entre leur domicile et leur lieu de travail les tournées hebdomadaires de camions qui livrent des marchandises dans une région donnée ou les migrations annuelles d’oiseaux à la recherche d’une nourriture plus abondante Dans ces cas la perception d'un mouvement unique pour chaque objet n'est pas adéquate et une perception sémantique verra plutôt une succession de déplacements nettement différenciés les uns des autres C'est chacun de ces déplacements successifs effectués au cours de la vie d'un objet mobile que nous appelons trajectoire L'analyse de ces trajectoires permet de construire des modèles de mobilité servant soit à une prise de décision par exemple récolter des trajectoires urbaines afin d’en dériver des connaissances utiles pour optimiser le trafic soit à l'acquisition de connaissances concernant l’objet mobile par exemple analyser les trajectoires des oiseaux pour mieux comprendre leur comportement soit encore au contrôle de stratégies notamment en logistique par exemple surveiller le bon fonctionnement et l'efficacité du système de livraison de colis par une entreprise postale Du point de vue des applications l'étude de ces trajectoires demande de récolter de nombreuses autres informations en plus du chemin parcouru Par exemple pour une application étudiant les déplacements quotidiens pour aller au travail le moyen de transport est une information essentielle Pour l'étude des migrations d’oiseaux ce sont les conditions météorologiques et les arrêts des oiseaux en cours de parcours quand dans quel type de lieu pourquoi et pendant combien de temps Il est aussi important de pouvoir décrire les contraintes liées à l'application comme le fait que certains oiseaux ne volent jamais durant la nuit tandis que d'autres ne volent que de nuit Ces applications ont besoin de nouvelles structures de représentation qui aillent au delà de la simple description du mouvement Ces nouvelles structures doivent comprendre une partie fixe pour les caractéristiques communes à toutes les trajectoires et une partie variable pour les caractéristiques spécifiques aux trajectoires de chaque application Cet article étudie le problème de modélisation des trajectoires au niveau conceptuel ce qui nous permet d'établir les bases de modélisation sans être influencés par des considérations liées à des implémentations particulières Nous proposons un patron de modélisation des trajectoires qui peut être adapté à toute application qui utilise des trajectoires Cette approche par patron semble particulièrement adaptée parce qu’elle offre la flexibilité indispensable pour prendre en compte la diversité de la sémantique des 152 RNTI E 13 C Parent et al trajectoires Le modèle conceptuel ainsi défini permet de prendre en compte aussi bien les trajectoires simples déplacements directs d’un point à un autre que les trajectoires complexes où le déplacement est composé d'une séquence de déplacements séparés par des arrêts temporaires Il permet aussi d’associer des annotations sémantiques aux trajectoires que ce soit sous la forme d’attributs par exemple le moyen de transport utilisé ou de liens entre la trajectoire et des objets de la base de données de l'application par exemple un lien avec le client auquel on a livré un colis Dans un but de simplification cet article ne considère que des objets mobiles représentés dans l'espace géographique par un point qu'il s'agisse d'objets effectivement perçus comme des points par l'application ou d'objets indéformables ou dont la déformation n'est pas intéressante pour l'application Leur position peut donc être décrite par une fonction du temps vers l'espace vu comme un ensemble de points L'approche peut être généralisée aux objets surfaciques déformables en décrivant le mouvement de l'objet par une fonction du temps vers l'espace vu comme un ensemble de surfaces ou de lignes ou de volumes L'article est organisé comme suit Le paragraphe qui suit propose un aperçu de l’état de l’art Le paragraphe 3 présente l’application que nous avons utilisée pour illustrer notre approche l'étude des migrations des cigognes blanches Le paragraphe 4 définit les composants de base de notre approche de modélisation de trajectoires alors que le paragraphe 5 explore les besoins des applications et leur mise en œuvre à l’aide de ces composants de base Le paragraphe 6 présente le patron de modélisation des trajectoires Le paragraphe 7 propose une implémentation du patron sur un SGBD relationnel étendu avec des types de données spatiaux Finalement le paragraphe 8 propose des directions de recherche qui peuvent compléter ce travail 2 État de l’art Depuis longtemps différents types de mouvements ont fait l'objet d'études dans des domaines divers C'est le cas en sciences sociales pour l'étude des migrations des déplacements quotidiens ou des comportements humains en voyage Kwan et Lee 2003 Thériault et al 2002 C'est le cas en biologie pour l'étude du déplacement des cellules ou en médecine pour l'étude de la propagation de maladies Par ailleurs en géomatique le mouvement effectué par un objet mobile a été décrit de façon générique Il est appelé "ligne de vie geospatiale" par Mark et al 1999 et est décrit comme une ligne dans un espace spatio temporel à trois dimensions x y t les coordonnées géographiques x y et le temps t Hornsby et Egenhofer 2002 en ont proposé une définition formelle qui permet d'appréhender les problèmes des granularités multiples Laube et al 2005 ont fait appel aux techniques de fouille des données pour analyser les lignes de vie géospatiales afin d’en extraire une typologie des déplacements Suivant une approche base de données Güting et al Güting et al 2000 Güting et Schneider 2005 ont apporté une contribution essentielle en proposant une théorie formelle pour les objets mobiles points et surfaces et un prototype qui implémente cette théorie en utilisant un SGBD propriétaire extensible Secondo Güting et al 2004 Le cœur de cette théorie est un ensemble de types de données qui comprend des types spatiaux des types temporels et des types "mobiles" des types qui représentent une valeur qui varie dans le temps Plus récemment les auteurs ont étendu leur approche à la modélisation et manipulation de trajectoires contraintes par un réseau prédéfini par exemple un réseau ferré ou routier Güting et al 2006 La plupart des 153 RNTI E 13 Modélisation conceptuelle des trajectoires travaux sur le mouvement contraint par un réseau décrivent d’un côté le réseau avec sa structure et sa localisation et d’un autre côté l’objet mobile avec ses coordonnées Puis ils contraignent les coordonnées de l’objet à se situer sur le réseau L’approche de Güting et al 2006 est différente ils décrivent la position de l’objet via une référence aux routes du réseau par exemple "sur l’autoroute A9 10 km après Montreux en direction du Valais" Cette technique de spécification implique que l'objet mobile est nécessairement positionné à l’intérieur du réseau ce qui rend inutile le recours à des contraintes spatiales Wolfson et al 1998 1999 ont élaboré une autre approche des objets mobiles dans l'objectif de réduire le coût des mises à jour Ceci les conduit à stocker des vecteurs de mouvement direction vitesse instant plutôt que des positions spatio temporelles point instant ce qui a l’avantage de permettre de prédire le mouvement futur en fonction du dernier vecteur de mouvement Le vecteur courant reste actif tant que la différence entre la position prédite et la position relevée est inférieure à un seuil donné Quand le seuil est dépassé un nouveau vecteur est calculé et stocké Ce travail ne considère que les points mobiles pas les régions mobiles Les mêmes auteurs se sont aussi intéressés aux déplacements contraints par un réseau Notons que ce thème des déplacements contraints a aussi été étudié par Speicys et al 2003 Noyon et al 2005 ont étudié comment les déplacements de deux objets mobiles ponctuels ou surfaciques peuvent être corrélés via des mesures de distance ou comment analyser l'évolution de la position relative d’un objet par rapport à celle d'un autre objet L'étude des mouvements périodiques se répétant régulièrement par exemple le mouvement de planètes de trains ou d’animaux migrateurs a intéressé plusieurs équipes Behr et al 2006 ont proposé un modèle formel pour représenter les mouvements périodiques qui peuvent contenir des répétitions imbriquées comme par exemple le mouvement d’un métro qui réalise la même trajectoire chaque jour de la semaine Suivant l’approche initiale à base de types abstraits de données proposée par Güting et al 2000 les auteurs ont défini et implémenté sur Secondo un ensemble de types de données apte à décrire les mouvements périodiques en particulier le type pmpoint periodic moving point Du coté des implémentations on trouve le système Hermès Pelekis et al 2006 dont les spécifications ont été construites en se basant sur les approches de Güting et de Wolfson Hermès est une nouvelle cartouche de données spatio temporelles pour le SGBD relationnel objet Oracle 10 La cartouche utilise les types spatiaux statiques d’Oracle Oracle 2007 et les types temporels proposés par la cartouche temporelle de TAU TLL de Pelekis et Theodoulidis 2002 Hermès offre aussi différents types de fonctions d’interpolation pour reconstituer d'éventuelles parties manquantes du mouvement Par ailleurs certains travaux ont élaboré des techniques d’indexation spécifiques aux objets mobiles pour améliorer les performances du système voir Chakka et al 2003 et Pelanis et al 2006 A contrario la prise en compte d'une vision applicative des objets mobiles c'est à dire une vision qui tienne compte des aspects sémantiques du mouvement ne semble pas avoir motivé les chercheurs Ainsi nous n'avons pas trouvé d'approche conceptuelle du mouvement qui soit basée sur les besoins des applications Les modèles conceptuels pour bases de données spatio temporelles proposent bien le concept de point mobile voir par exemple Khatri et al 2004 ou Parent et al 2006a mais elles ne vont pas au delà À notre connaissance un seul travail Brakatsoulas et al 2004 s'est donné pour objectif d’enrichir la sémantique d’un modèle pour objets mobiles Malheureusement les trajectoires de ces auteurs restent au niveau géométrique Ce sont des polylignes qui connectent les différentes positions spatio temporelles relevées elles représentent le mouvement par une séquence de 154 RNTI E 13 C Parent et al segments spatio temporels plutôt que par une séquence d’étapes sémantiques De même les propriétés des trajectoires sont uniquement celles qui sont dérivables des positions spatio temporelles comme la vitesse ou le chemin parcouru et non d'autres propriétés sémantiques qu’une application pourrait souhaiter conserver à propos de ses trajectoires comme par exemple le but de la trajectoire Se démarquant des approches purement géométriques cet article perçoit les trajectoires comme des déplacements qui ont une signification sémantique trajectoires de personnes allant au travail d’animaux en migration de véhicules en route pour une destination de phénomènes naturels régis par les lois de la nature … La liste des positions spatio temporelles d'un objet tout au long de sa vie ne fournit qu'un des éléments de la trajectoire D’autres éléments décrivent entre autres quand la trajectoire débute se termine ou quand elle est temporairement suspendue Ces éléments sont déterminés par l’application qui seule peut définir la sémantique de la trajectoire Notre approche est basée sur ce principe Les applications ont aussi souvent besoin de pouvoir décrire des trajectoires selon différentes granularités spatiales et temporelles Quelques travaux se sont intéressés à la multi granularité dans le cadre des objets mobiles Friis Christensen et al 2005 Camossi et al 2003 Nous prévoyons de réutiliser un travail précédent sur la multi représentation dans les bases de données spatio temporelles Balley et al 2004 Parent et al 2006b et de proposer une approche similaire pour la multi représentation des trajectoires Cet aspect n'est cependant pas présenté dans cet article 3 Une application Ce paragraphe présente un exemple typique d'application utilisant des trajectoires Ce type d'application a pour objectif d'analyser les déplacements d'animaux migrateurs Les données sur leurs mouvements sont soit obtenues automatiquement grâce à des émetteurs portés par les animaux et qui envoient régulièrement leur position soit obtenues par observation directe en capturant temporairement les animaux L'exemple qui nous sert d'illustration concerne les migrations annuelles des cigognes blanches Ciconia ciconia auxquelles s'intéressent plusieurs groupes de recherche1 Comme plusieurs espèces d’oiseaux migrateurs les cigognes migrent tous les ans Chaque automne elles quittent l’hémisphère nord notamment l'Europe pauvre en nourriture en hiver et migrent vers l’hémisphère sud où la nourriture est abondante tout au long de l’année Mais pour se reproduire et nourrir leurs petits les cigognes ont besoin des longues journées qu'offre l’hémisphère nord en été Elles reviennent donc vers le nord au printemps L’analyse des migrations animales a pour objectif général d’améliorer les connaissances concernant le comportement animal Est ce que la migration est innée et en quelque sorte programmée génétiquement Comment les oiseaux s’orientent ils lors de la migration En effet ils reviennent souvent dans les mêmes endroits pour se reproduire Comment font ils pour voler sur de si longues distances Volent ils en groupe Où et quand s’arrêtent ils pour se reposer pendant la migration Quels sont les facteurs environnementaux qui influencent leur migration topographie conditions météorologiques prédateurs disponibilité de 1 storchenhof loburg info fr ch mhn vogelwarte ch 155 RNTI E 13 Modélisation conceptuelle des trajectoires nourriture Quels sont les dangers rencontrés Pourquoi certains oiseaux ne survivent ils pas à la migration … Pratiquement les données que nous avons utilisées proviennent d’un ensemble de cigognes blanches Elles ont été équipées chacune d’un petit émetteur qui émet régulièrement des signaux qui sont captés par des satellites Les cigognes blanches volent uniquement durant la journée parce qu’elles utilisent les courants thermiques créés par le soleil quand il réchauffe la terre Elles interrompent donc leur vol la nuit et en profitent pour se reposer et se nourrir Elles peuvent parcourir plusieurs centaines de kilomètres par jour selon les conditions météorologiques Elles migrent en groupes dont la composition peut changer lors des arrêts Pour détecter les groupes de cigognes volant ensemble on analyse les positions spatio temporelles des cigognes Cependant comme seul un petit pourcentage des cigognes sont équipées d’un émetteur le groupe dans lequel vole un oiseau peut rester inconnu Afin d’analyser le comportement des cigognes blanches durant leur migration les chercheurs ont besoin de connaître deux types d’information 1 Informations propres aux trajectoires des oiseaux Durant le vol des cigognes les informations suivantes sont enregistrées à intervalles réguliers leur position spatio temporelle l’altitude à laquelle la cigogne vole Cette information de même que les conditions météorologiques et les objets naturels ou artificiels rencontrés change le long de la trajectoire de l’oiseau le groupe avec lequel la cigogne vole Lorsque les cigognes blanches sont à l'arrêt les informations suivantes sont enregistrées le type d’arrêt arrêt pour la nuit ou arrêt plus long généralement quelques jours ou semaines pour se reposer et se nourrir si possible les activités de l’oiseau durant l’arrêt alimentation repos … si la cigogne a pu être attrapée durant l'arrêt son poids le pourcentage de graisse la température de son corps et sa condition générale 2 Informations sur les conditions environnementales des trajectoires Ici sont principalement enregistrés Les conditions météorologiques vent direction force température pression état du ciel soleil pluie nuages brouillard ciel clair Les objets naturels montagnes grandes étendues d’eau déserts… et les objets artificiels lignes électriques antennes gratte ciels éoliennes… qui peuvent constituer des obstacles pour les cigognes et influencent donc leur vol notamment leur direction de vol La description de ces obstacles est particulièrement importante parce qu’ils constituent une menace qui peut entraîner la mort des migrateurs 4 Trajectoires Définitions de base Nous présentons maintenant les définitions de base sur lesquelles repose notre travail et l'approche de modélisation conceptuelle des trajectoires que nous avons élaborée à partir de l'étude des besoins Notre objectif est de permettre aux applications gérant des objets mobiles 156 RNTI E 13 C Parent et al de décrire leur vision du mouvement d'un objet mobile c'est à dire l'évolution de sa position au cours de sa vie par un ensemble de trajectoires identifiables et significatives pour l'application Par exemple une entreprise gérant une flotte de camions de livraison pourra décrire les déplacements des camions par un ensemble de trajectoires chacune correspondant à une tournée de livraison qui part du siège de l'entreprise et qui y retourne À une autre granularité temporelle le déplacement d'un oiseau migrateur pourra être décrit par deux trajectoires annuelles l'une en automne de l’Europe vers l’Afrique l'autre au printemps suivant de l’Afrique vers l’Europe La figure 1 illustre l'idée de la désignation d'un ensemble de trajectoires dans le mouvement d'un objet mobile La figure montre aussi que certains segments du mouvement peuvent n'appartenir à aucune trajectoire par exemple le segment entre t1 et t2 Cette non appartenance traduit le fait que ces segments correspondent à des déplacements qui n'intéressent pas l'application FIG 1 – Parcours spatio temporel d'un objet en mouvement support de trajectoires définies par segmentation sémantique Étant donné qu'un objet ne peut être qu'à un seul endroit à un instant donné chaque trajectoire d'un objet est repérable par l'intervalle de temps qui la délimite depuis l’instant appelé tdébut où l’objet commence un déplacement dans un but donné jusqu'à l’instant appelé tfin où le déplacement pour ce but se termine Identifier soit directement soit par une règle de calcul le début et la fin de chaque trajectoire est de la responsabilité de l'application en fonction de ses propres règles de gestion Nous pouvons maintenant définir au niveau conceptuel la notion de trajectoire pour un objet ponctuel ou indéformable Définition 1 Trajectoire Une trajectoire est la description du point de vue utilisateur de l’évolution de la position perçue comme un point d’un objet qui se déplace pendant un intervalle de temps donné pour un but particulier Trajectoire [tdébut tfin] → espace Les trajectoires sont ainsi introduites comme un concept sémantique qui interprète un segment du parcours d'un objet mobile identifié par le choix de l'intervalle de temps [tdébut tfin] comme une unité significative par rapport à l'application Par exemple dans l’application de suivi des oiseaux les ornithologistes doivent définir s’ils voient l'aller retour annuel d'un oiseaux comme une seule trajectoire ou comme deux trajectoires différentes Dans certains domaines d’application les trajectoires sont facilement identifiables par exemple le parcours des camions de livraison peut être aisément segmenté en trajectoires 157 RNTI E 13 Modélisation conceptuelle des trajectoires journalières Dans d’autres domaines d’application par exemple le suivi de chimpanzés il n’est pas toujours évident de déterminer quand l'objet le chimpanzé commence une nouvelle trajectoire et quand il continue simplement la trajectoire précédente Dans ce cas la segmentation peut être induite par l'observateur plutôt que par l'observé par exemple en définissant une trajectoire par période d’observation Quel que soit le critère choisi par l’application l’intervalle de temps qui définit la trajectoire [tdébut tfin] est nécessairement inclus dans le cycle de vie de l’objet et est nécessairement disjoint ou adjacent aux intervalles de temps des autres trajectoires du même objet Si la segmentation en trajectoires couvre l’intégralité du parcours les intervalles de temps définissant deux trajectoires successives se touchent toujours De nouveau ce choix dépend de l’application La trajectoire ainsi définie ne constitue que la trace matérielle d'un voyage de l'objet Cette description minimale peut être enrichie par exemple en décrivant également avec plus ou moins de richesse l'objectif assigné à la trajectoire les conditions dans lesquelles elle a été réalisée ou les résultats auxquels elle a abouti La fonction temps → espace qui définit une trajectoire n’est pas nécessairement identique à celle produite par le processus d'acquisition des données Ce dernier fournit les données brutes du déplacement sous la forme d’une suite de couples point d'échantillonnage instant Ces données brutes sont souvent d'abord modifiées nettoyées afin de corriger les erreurs de saisie et les approximations réalisées lors de l’acquisition puis retravaillées pour constituer une fonction qui produise une image du déplacement ayant la qualité souhaitée Enfin les besoins applicatifs déterminent comment la fonction trajectoire doit être définie L’application pourrait n’être intéressée que par un sous ensemble des points connus par exemple elle peut supprimer les points acquis durant la nuit et ne conserver que les déplacements réalisés durant la journée Elle peut aussi avoir ses propres règles pour simplifier la fonction en remplaçant certaines séquences de points par un point unique synthétisant la séquence Les objets ne se déplacent pas nécessairement tout le temps pendant une trajectoire c’est le cas dans l'exemple des oiseaux Ils peuvent marquer des temps d'arrêt Les trajectoires peuvent donc être elles mêmes segmentées en périodes de déplacement et périodes d’absence de déplacement où l’objet est vu comme immobile Nous appelons ces premières des déplacements et ces dernières des arrêts Une trajectoire peut donc être perçue comme une séquence de déplacements allant d’un arrêt à l’arrêt suivant Par exemple un oiseau en migration va faire un arrêt quelque part pour un intervalle de temps donné pour se nourrir un autre arrêt pour se reposer et ainsi de suite jusqu’à ce qu’il atteigne sa destination finale la fin de sa trajectoire Des représentants de commerce en déplacement vont faire des arrêts à tous les endroits où ils doivent rencontrer un client Comme pour la détermination du début et de la fin des trajectoires l’identification des arrêts et des déplacements dans une trajectoire est de la responsabilité de l’application Les arrêts physiques c'est à dire le fait que la position de l’objet est la même durant au moins deux instants consécutifs ne sont pas systématiquement des arrêts conceptuels parce qu’ils peuvent être la conséquence d’évènements qui ne sont pas pertinents pour l’application Par exemple l’arrêt fait par le représentant de commerce pour boire un café n’est pas pertinent pour l’application Par contre l’arrêt réalisé pour rencontrer un client l’est L’application peut vouloir compter le nombre d’arrêts par trajectoire et ici seuls les arrêts significatifs doivent être comptés Dans la suite nous supposons que les arrêts et les déplacements couvrent complètement la trajectoire c'est à dire qu'il n’existe pas d'instant inclus dans 158 RNTI E 13 C Parent et al [tdébut tfin] qui n’appartienne ni à un arrêt ni à un déplacement Nous définissons sémantiquement les arrêts et les déplacements comme suit Définition 2 Arrêt Un arrêt est une partie de la trajectoire telle que L’utilisateur a explicitement spécifié que cette partie de la trajectoire définie par l'intervalle temporel [tdébutArrêt tfinArrêt] représente un arrêt L’intervalle de temps [tdébutArrêt tfinArrêt] n'est pas vide Du point de vue de l’application l’objet ne bouge pas c'est à dire l’emprise spatiale formée par la trajectoire pour l’intervalle [tdébutArrêt tfinArrêt] est un point Tous les arrêts sont temporellement disjoints les intervalles de temps correspondants à deux arrêts sont toujours disjoints Définition 3 Déplacement Un déplacement est une partie de la trajectoire telle que Cette partie est délimitée par deux extrémités qui sont soit deux arrêts consécutifs soit tdébut et le premier arrêt soit le dernier arrêt et tfin soit encore tdébut et tfin Soient tdébutDéplacement et tfinDéplacement ces deux instants L’intervalle de temps [tdébutDéplacement tfinDéplacement] n'est pas vide L’emprise spatiale de la trajectoire pour l’intervalle [tdébutDéplacement tfinDéplacement] est la ligne non réduite à un point définie par la fonction de la trajectoire Pratiquement c'est la polyligne construite à partir des points de l’échantillon appartenant à l’intervalle [tdébutDéplacement tfinDéplacement] Nous ne considérons pas le début et la fin de la trajectoire comme des arrêts Leur emprise temporelle est en effet un instant et non pas un intervalle non vide 5 Étude des besoins pour la modélisation de trajectoires Les définitions précédentes sont valables quel que soit le type de trajectoire Cependant les besoins en termes de modélisation peuvent varier suivant le type de trajectoire considéré Nous différencions dans cet article trois types de trajectoires les trajectoires métaphoriques les trajectoires géographiques et les trajectoires spatio temporelles 5 1 Les trajectoires métaphoriques Le terme de trajectoire est quelquefois utilisé dans un sens métaphorique afin de décrire une évolution qui n'est pas un mouvement physique Par exemple il n’est pas rare de parler de la trajectoire professionnelle d’une personne pour décrire une succession d'états ou de changements comme dans "Je suis passée du milieu académique à l’industrie où j'ai travaillé dans une grande compagnie puis je suis retournée dans le milieu académique" Cette utilisation métaphorique de la notion de trajectoire repose sur l’image d’un objet ici une personne se déplaçant dans un espace abstrait dont les points sont les différentes valeurs d’un attribut thématique ici un attribut décrivant le secteur professionnel Du point de vue de la modélisation ce type de trajectoire peut être décrit en définissant l'attribut thématique comme variable dans le temps c'est à dire un attribut dont la valeur est définie par une fonction du temps vers le domaine de valeurs de l'attribut Réciproquement tout attribut thématique variable dans le temps peut être vu comme définissant une trajectoire 159 RNTI E 13 Modélisation conceptuelle des trajectoires métaphorique pour les objets qui ont cet attribut Les modèles de base de données spatio temporelles existants tels ceux de Khatri et al 2004 ou Parent et al 2006a proposent ce concept d’attribut variable dans le temps La variabilité peut être continue les valeurs de l'attribut changent de façon continue C'est le cas par exemple de la température mesurée en un point particulier ou de la valeur d'une action en bourse par paliers les changements de valeur sont instantanés et chaque valeur est valable durant un intervalle de temps C'est le cas par exemple du salaire d'un employé ou du secteur professionnel de la personne dans l'exemple ci dessus discrète les valeurs de l'attribut existent uniquement à certains instants C'est le cas par exemple de l'attribut prime d'un employé qui est un évènement ponctuel Un attribut variable en continu a nécessairement un domaine de valeurs continu à la granularité près Par contre un attribut à domaine de valeurs continu peut être variable selon l'un quelconque des trois types Le choix entre ces trois types dépend de comment change la valeur de l'attribut dans le temps évolution continue remplacement d'une valeur par une autre au bout d'un certain temps valeur significative seulement à certains instants Tant que l’application n'a besoin que de mémoriser l'évolution de la valeur des attributs modéliser ce type de trajectoire métaphorique ne requiert pas de nouveaux concepts Cependant si la description d’une trajectoire métaphorique implique des liens entre la trajectoire et d’autres objets de l’application la trajectoire doit alors être modélisée comme un objet et non comme un attribut En conséquence ces trajectoires dont la sémantique est plus riche doivent être modélisées de manière similaire aux trajectoires spatio temporelles voir le paragraphe 5 3 Dans ce cas les relations topologiques et de synchronisation fréquemment utilisées pour modéliser les trajectoires spatio temporelles seront de simples relations thématiques 5 2 Les trajectoires à connotation géographique naïve Les voyages sont fréquemment décrits comme un déplacement d’un endroit à un autre par exemple d’une ville à une autre ville "Je suis allée à Paris puis à Bruxelles puis je me suis rendue à Amsterdam et Berlin avant de revenir à Lausanne" De façon similaire les déplacements d'une trajectoire peuvent être définis par référence à des objets à connotation géographique de nature linéaire mais dont les coordonnées spatiales ne sont pas définies ou pas utiles pour l'application Par exemple "J'ai pris le TGV de Lausanne à Paris puis le Thalys de Paris à Bruxelles " Le voyage a dans ces exemples une connotation géographique forte – ce pourquoi nous qualifions ces trajectoires de géographiques – mais ils n'est pas défini en termes de coordonnées spatiales il est défini par référence à des objets géographiques comme dans les approches dites "Géographie Naïve" Egenhofer et al 1995 De fait les trajectoires géographiques naïves sont un cas particulier de trajectoires métaphoriques Comme ces dernières elles peuvent être décrites en utilisant des attributs thématiques variables dans le temps dans les exemples ci dessus villeVisitée et trainUtilisé ou d’une manière similaire aux trajectoires spatio temporelles 160 RNTI E 13 C Parent et al 5 3 Les trajectoires spatio temporelles Une trajectoire est dite spatio temporelle si des cordonnées spatiales – dans l'espace vu comme ayant deux ou trois dimensions – sont utilisées pour décrire la position de l’objet qui se déplace Une trajectoire spatio temporelle comprend deux composantes Une composante géo temporelle qui décrit physiquement le déplacement de l'objet Cette composante a été définie au paragraphe 4 ci dessus Elle se matérialise comme une fonction continue d’un intervalle de temps donné vers l’espace trajectoire [tdébut tfin] → espace Cette fonction est implémentée de façon discrète par une suite de point instant et une fonction d'interpolation ou une suite de fonctions d'interpolation La fonction pourrait être décrite à l'aide d'un type de données qui décrit un point mobile comme le type de données time–varyingPoint de Parent et al 2006a ou movingPoint de Guting et al 2005 Cependant nous ne suivons pas cette approche puisque nous percevons les trajectoires comme d'abord composées d'une succession de déplacements et d'arrêts Ce sont les déplacements qui eux seront décrits à l'aide d'un type de données point mobile Une composante sémantique qui décrit les informations de la trajectoire liées à l’application telles que des annotations et des liens vers les objets décrits dans la base de données Cette composante sémantique est analysée dans le paragraphe suivant 5 4 La sémantique des trajectoires Les caractéristiques sémantiques pertinentes des trajectoires varient d'une application à une autre Cependant on peut identifier des constantes qui peuvent faire l'objet d'une approche de modélisation générique Ce sont ces constantes qui nous intéressent ici et qui nous conduisent à proposer un patron de modélisation Comme nous l'avons déjà dit une première préoccupation consiste à définir s’il en existe les arrêts qui décomposent la trajectoire en une séquence de déplacements Les arrêts peuvent être définis directement par l'objet mobile C'est le cas par exemple de la trajectoire d'un représentant de commerce qui définira lui même quand il est en arrêt pour visiter des clients de même qu'il définira lui même quand il commence et termine sa tournée c'est à dire une trajectoire Par contre d'autres applications ne peuvent pas compter sur des interactions avec l'objet mobile Elles doivent elles mêmes repérer et définir les segments du parcours spatio temporel qui peuvent constituer des arrêts ainsi que le début et la fin de chaque trajectoire C'est le cas du suivi des cigognes Dans ce cas c'est la connaissance que l'on a du comportement des animaux qui permet de fixer des règles qui lors de l'analyse de leur déplacement vont déterminer les composants début fin arrêts et déplacements Les règles ci dessous en sont des exemples Les cigognes ne volent jamais de nuit Les cigognes s'arrêtent pour manger et pour se reposer Le début d'une nouvelle trajectoire est détecté en observant dans la suite des positions spatio temporelles de l'oiseau un changement entre une période de résidence stable de l'oiseau plusieurs mois pendant lesquels sa position nocturne reste dans une même zone et une période de déplacement une suite de journées où l'oiseau se déplace en s'éloignant de sa zone de résidence Le déplacement constaté doit se diriger approximativement vers le Sud s'il a lieu en automne vers le Nord s'il a lieu en fin d'hiver Les paramètres exacts de ce calcul taille de la zone de résidence durée du séjour durée minimale permettant de conclure à un début de 161 RNTI E 13 Modélisation conceptuelle des trajectoires déplacement sont à fixer en fonction des caractéristiques du comportement des cigognes La fin d'une trajectoire est détectée de façon similaire mais inverse en observant un changement entre une période de déplacement et une période de résidence stable de l'oiseau Une suite de positions spatio temporelles situées entre le début et la fin d'une trajectoire constituent un arrêt si elle satisfait les trois conditions suivantes 1 Les positions forment un nuage de points dont le rayon est inférieur à un certain seuil par exemple 10 Km 2 L’intervalle de temps défini par l'instant de la première position et celui de la dernière position a une durée supérieure à un certain seuil par exemple 30 minutes 3 Cette suite est maximale c'est à dire que la position spatio temporelle précédant la première position de la suite et celle suivant la dernière position ne satisfont pas les conditions Pour l'arrêt ainsi défini son point sera le centre du nuage de points et son intervalle sera formé des instants de la première à la dernière position de la suite On appellera arrêt de nuit un arrêt d’une durée supérieure à 6h ayant lieu approximativement du coucher du soleil au lever du soleil le lendemain On appellera arrêt de repos tout autre arrêt Une autre caractéristique des trajectoires est qu'une partie importante de leur sémantique est traduite par des liens entre la trajectoire et les autres objets de la base de données en particulier les objets géographiques comme les rues bâtiments villes régions pays lacs Lorsque l'objet lié est un objet spatial doté de sa géométrie ces liens sont habituellement porteurs de contraintes topologiques par exemple pour exprimer que les arrêts de la trajectoire se situent nécessairement dans une ville Lorsque ce n'est pas le cas le lien est une simple relation classique d'association Certains liens sont au niveau de la trajectoire entière d'autres sont au niveau d'une partie de trajectoire ou de ses composants Un lien à contrainte spatiale au niveau trajectoire exprime que chaque point de la trajectoire doit satisfaire la contrainte spatiale Par exemple telle tournée d'un camion de livraison c'est à dire telle trajectoire du camion est tout entière incluse dans telle région Comme exemple de lien à contrainte spatiale au niveau composant citons de nouveau le cas des trajectoires de migration des cigognes les ornithologues peuvent lier chacun des arrêts à l'objet géographique surfacique qui est situé à cet endroit et qui présente un intérêt du point de vue ornithologique tel qu'un marais ou une roselière au bord d'un cours d'eau La relation sera une relation topologique de type inclusion ce qui signifie que le point représentant la cigogne doit être dans la surface associée à l'objet géographique Les ornithologues peuvent aussi vouloir mémoriser quels obstacles la cigogne a survolé par exemple une ligne à haute tension Ils pourront le faire en reliant à l'aide d'une relation topologique chaque déplacement de la trajectoire aux objets qui décrivent les obstacles surmontés En plus de liens vers des objets de la base de données la description sémantique d’une trajectoire peut conduire à associer à la trajectoire ou à ses composants des attributs et des contraintes d'intégrité et plus généralement toute caractéristique offerte par un modèle conceptuel Le processus qui consiste à associer une information thématique aux instances de trajectoire est généralement appelé annotation sémantique Des exemples d’annotation sont le but de la trajectoire le moyen de locomotion le nom du lieu où se trouve l’objet mobile à chaque instant le type d’activité de l’objet mobile durant ses déplacements ou durant ses arrêts les rencontres effectuées lors des arrêts et pour les migrations d’oiseaux l’altitude et 162 RNTI E 13 C Parent et al les conditions météorologiques lors des vols Suivant le cas ces annotations prennent la forme de valeurs d'attribut par exemple pour le but de la trajectoire ou d'instanciation d'un lien vers un objet particulier de la base de données par exemple pour noter le nom du lieu où se trouve un point de la trajectoire en supposant que ce lieu est représenté comme un objet dans la base de données Ces annotations peuvent avoir la même valeur pour toute la trajectoire par exemple le but de la trajectoire ou une valeur différente pour chaque composant de la trajectoire par exemple la vitesse moyenne par déplacement l’activité principale pendant chaque arrêt Ainsi selon le cas l'attribut sera un attribut de la trajectoire du déplacement ou de l'arrêt De plus la valeur de l'attribut peut varier tout au long de la trajectoire ou du déplacement ou de l'arrêt Dans ce dernier cas l'attribut sera variable dans le temps Par exemple pour les cigognes la valeur de l’attribut altitude varie pendant chaque déplacement Quand il y a plusieurs annotations variables dans le temps il faut déterminer quelles sont les règles d'échantillonnage utilisées par l'application Si plusieurs annotations variables sont mesurées aux mêmes instants alors elles seront décrites par un seul attribut complexe qui regroupera ces différentes valeurs et qui sera variable dans le temps Il y aura ainsi une seule et même suite de points d'échantillon pour toutes les valeurs Par contre si chaque annotation variable est mesurée selon une séquence d'instants qui est indépendante de la séquence des autres alors chaque annotation sera décrite par un attribut simple variable dans le temps Des contraintes d’intégrité thématique spatiale et temporelle peuvent aussi être associées aux trajectoires Par exemple un avion ne peut pas voler s’il n’y a pas une équipe de pilotes et d'hôtesses les cigognes ne volent pas durant la nuit les arrêts des représentants doivent inclure au moins un rendez vous avec un client un nombre limité d’arrêts est autorisé ou encore la distance ou la durée entre deux arrêts ne doit pas être inférieure ou supérieure à un certain seuil Très fréquemment les trajectoires des humains sont contraintes de suivre un réseau spécifique par exemple les voitures et les camions ne peuvent se déplacer que sur le réseau routier Une trajectoire contrainte par un réseau doit respecter deux types de contraintes une contrainte topologique d'inclusion le point mobile doit toujours être dans la géométrie du réseau et les contraintes associées aux noeuds du réseau En effet le réseau routier décrit non seulement les voies mais aussi les intersections avec les changements de direction autorisés tourner à droite ou à gauche faire demi tour La position des objets qui se déplacent dans un réseau peut être décrite par rapport à la géométrie du réseau chaque point mobile est alors défini par l'identifiant de la voie et sa position relative sur cette voie par exemple au 12ème km Güting et al 2006 Un type particulier de trajectoire contrainte est celui des trajectoires fixes et récurrentes comme celle des trains métros et bus qui font toujours le même trajet avec les mêmes arrêts avec des horaires prédéfinis D'autres trajectoires ont des contraintes spatiales ou temporelles particulières qui doivent être calculées dynamiquement C'est le cas par exemple des trajectoires des oiseaux migrateurs qui font du vol plané grâce aux thermiques qui ne peuvent pas traverser de grandes étendues d'eaux les cigognes contournent la Méditerranée ou s'effectuer de nuit à cause de l'absence de thermiques Les applications peuvent aussi souhaiter conserver des caractéristiques dérivées du mouvement comme la direction la vitesse l’accélération instantanée ou moyenne Les informations de ce type sont calculables à partir de la fonction qui définit la trajectoire ou de la séquence de points d'échantillon et sont généralement obtenues en appelant des méthodes du type de données point mobile 163 RNTI E 13 Modélisation conceptuelle des trajectoires Enfin les applications doivent avoir la possibilité de spécifier plusieurs représentations de la même trajectoire selon le point de vue la résolution et les objectifs de l'application Tous les composants et toutes les informations sémantiques de la trajectoire peuvent avoir plusieurs représentations Par exemple si on considère la trajectoire d'une cigogne une application aura besoin de différencier les différents types d'arrêts le long de la trajectoire de repos de nuit etc et décrira chaque type avec des informations spécifiques Une autre application aura simplement besoin de savoir que l'oiseau s'est arrêté et à tel endroit pendant tant de temps sans s'intéresser à d'autres informations relatives à cet arrêt Enfin une troisième application ne prendra en compte que les longs arrêts de repos et ignorera les arrêts qui ne durent qu'une nuit Un mécanisme qui permet cette représentation multiple pour les objets spatio temporels a été présenté dans MADS Parent et al 2006b En résumé une trajectoire est composée d'un début d'une fin de déplacements et d'arrêts Un modèle conceptuel pour trajectoires doit permettre la définition de trajectoires et de leurs composants avec des attributs des liens vers les objets de la base de données des contraintes thématiques spatiales et temporelles Chaque élément a une géométrie qui est ponctuelle pour le début la fin et les arrêts et qui est linéaire pour les déplacements Chaque élément a une extension temporelle qui est un instant pour le début et la fin et un intervalle de temps pour les arrêts et les déplacements Ces derniers peuvent donc être annotés avec des attributs variables ou non dans le temps 6 Modélisation des trajectoires Certains modèles conceptuels pour bases de données incluent la description des aspects spatiaux et temporels par exemple Parent et al 2006a Tryfona et al 2003 Bédard et al 2004 Ces modèles permettent de décrire des objets en mouvement et répondent donc en partie aux besoins de modélisation des trajectoires la description de la composante géo temporelle Mais ils n'offrent pas de constructeurs spécifiques aux trajectoires les notions de trajectoire de début de fin d'arrêt et de déplacement ne font pas partie du modèle et seront donc ignorés du SGBD sur lequel la base de données sera implantée Ces notions restent alors du domaine exclusif des utilisateurs et des programmes d'application Nous avons donc étudié différentes solutions pour compléter les services offerts par les SGBD spatio temporels et en avons développé deux La première est basée sur la définition d'un patron de modélisation la seconde sur celle de nouveaux types de données Dans cet article nous présentons la première solution la seconde est décrite dans Spaccapietra et al 2008 Le concept de patron de modélisation – de l'anglais "design pattern" Gamma et al 1995 – vient du génie logiciel Appliqué aux bases de données il dénote un schéma prédéfini qui décrit une solution simple à un problème de modélisation récurrent Il peut être utilisé par le concepteur de bases de données dans l'étape de modélisation Le patron est en effet prévu pour être facilement intégré dans un schéma de bases de données Notre patron de modélisation pour trajectoires vise à représenter explicitement les trajectoires et leurs composants début fin arrêts et déplacements Cette solution utilise un modèle conceptuel spatio temporel sans le modifier ce qui permet de l'implémenter facilement sur tout SGBD qui offre un support pour le spatial par exemple Oracle DB2 ou SQL Server ou sur un système d'information géographique Cette solution réifie les composants des trajectoires le début la fin les arrêts et les déplacements sont représentés par des objets Cette réification a pour but de satisfaire un des besoins vus aux paragraphes précédents le début la fin les 164 RNTI E 13 C Parent et al arrêts et les déplacements doivent pouvoir être reliés à des objets de la base de données Pour cela ils doivent être représentés eux aussi comme des objets En effet les modèles de données permettent de relier entre eux des éléments de premier rang les entités en entité relation les objets en orienté objets les tables en relationnel mais pas les attributs Cette solution a l'avantage de donner des schémas clairs lisibles et qui permettent facilement de compléter la description des trajectoires avec l’information sémantique spécifique à l'application De plus ces schémas peuvent évoluer facilement Le paragraphe 6 1 décrit dans ses grandes lignes le modèle conceptuel spatio temporel MADS dans lequel est décrit le patron pour trajectoires Le patron est présenté en détail au paragraphe 6 2 et un exemple de schéma utilisant le patron est décrit au paragraphe 6 3 6 1 Le modèle conceptuel spatio temporel MADS Le modèle MADS est un modèle de données de type entité relation étendu au spatial au temporel et à la multi représentation possibilité d'avoir plusieurs représentations différentes pour une même information Pour la dimension thématique on notera simplement que MADS permet de décrire des attributs simples et des attributs complexes composés d'autres attributs des attributs monovalués qui prennent une valeur et des attributs multivalués qui peuvent prendre plusieurs valeurs Pour la dimension spatiale MADS offre un jeu de types de données spatiales organisé en une hiérarchie Les types les plus courants sont Point Line Surface et le type générique Geo qui contient toutes les valeurs spatiales qu'elles soient simples ou complexes De même il y a une hiérarchie de types de données temporels dont Time est la racine et Instant TimeInterval InstantSet sont les plus courants En MADS les types d'objet tout comme les types de relation peuvent être spatiaux et ou temporels Un type d'objet ou de relation spatial possède un attribut particulier appelé geometry qui décrit son emprise spatiale et dont le domaine de valeurs est l'un des types spatiaux Un type d'objet ou de relation temporel possède un attribut particulier appelé lifecycle qui décrit sa durée de vie et les états par lesquels il passe au cours de sa vie actif suspendu invalidé Certains types de relations contraignent les objets qu'ils lient Ce sont d'une part les relations topologiques qui relient deux objets spatiaux et contraignent leurs attributs geometry à satisfaire un prédicat topologique par exemple adjacence intersection ou inclusion et d'autre part les relations de synchronisation qui relient deux objets temporels et contraignent leurs attributs lifecycle à satisfaire un prédicat temporel par exemple l'un doit succéder à l'autre Les attributs quelles que soient leurs caractéristiques peuvent varier dans le temps et ou dans l'espace Dans ce cas leur valeur est définie au niveau conceptuel par une fonction qui associe à chaque instant et ou chaque point un élément du domaine de définition de l'attribut Si l'attribut est spatial c'est à dire qu'il a pour domaine un des types de données spatiales et variable dans le temps alors cet attribut décrit un déplacement et ou une déformation Par exemple un attribut de domaine Point et variable dans le temps a pour valeur un point mobile Il existe trois catégories d'attribut variable attribut variable en continu par paliers ou attribut variable discret Chacune correspond à une façon de varier des phénomènes décrits Par exemple la température varie de façon continue le salaire d'un employé varie par paliers Selon la catégorie d'attribut variable les valeurs sont relevées de façon différente Les valeurs d'un attribut variable en continu ou discret sont fournies sous la forme d'une suite de couples valeur instantanée instant et celles d'un attribut variable par paliers sous la forme d'une suite de couples valeur instantanée intervalle de temps 165 RNTI E 13 Modélisation conceptuelle des trajectoires Le lecteur qui voudrait avoir plus de détails sur le modèle de données MADS est invité à consulter Parent et al 2006a 6 2 Patron de conception pour les trajectoires Comme nous l'avons vu un patron de conception pour les trajectoires doit comprendre un type d'objet pour représenter chacun des concepts trajectoire début fin arrêt et déplacement La figure 2 représente le patron de conception que nous proposons Dans ce patron le type d'objet Noeud regroupe le début la fin et les arrêts des trajectoires dans le même type parce qu'ils ont des caractéristiques similaires2 Le type d’objet Noeud possède un cycle de vie qui est un intervalle de temps simple et une géométrie qui est un point Un type de relation EstComposéDe relie les trajectoires à leurs noeuds Ses cardinalités contraignent chaque noeud à appartenir à une trajectoire unique et chaque trajectoire à posséder au moins un noeud Le type d'objet Déplacement possède un cycle de vie qui est un intervalle de temps simple et une géométrie qui est un point variable dans le temps Le cycle de vie des objets Trajectoire est un intervalle de temps qui est dérivé des cycles de vie de la première et de la dernière instances de Noeud qui lui sont liées c'est à dire les instants de son début et de sa fin Les deux types d'objet Noeud et Déplacement sont reliés par deux types de relation De et Vers représentant le fait que chaque déplacement commence et finit par un arrêt Ces deux relations sont à la fois topologiques et de synchronisation à contrainte de type adjacence temporelle avant après Les deux contraignent chaque déplacement à être lié à des arrêts qui leur sont adjacents dans l'espace et dans le temps Dans les modèles de données spatio temporels la sémantique des relations spatiales qui contraignent les géométries de deux objets doit être étendue au cas où l'un des deux objets voire les deux bouge ou se déforme À cette fin en MADS les relations topologiques qui lient des objets qui bougent ont été étendues en demandant au concepteur de définir la portée temporelle de la contrainte la contrainte doit être satisfaite soit au moins pendant un instant soit pendant toute la durée de vie de l'objet ce qui dans notre cas revient à toute la durée de la trajectoire ou toute celle d'un arrêt ou d'un déplacement Par exemple le fait qu'une cigogne passe au dessus d'une ligne à haute tension pendant un certain déplacement sera représenté en deux dimensions par une relation topologique d'inclusion du point mobile la cigogne dans la ligne haute tension pendant au moins un instant du déplacement Dans le patron de la figure 2 la contrainte topologique de la relation De Vers qui lie un déplacement à son nœud de départ fin est une contrainte d'égalité qui doit être satisfaite au premier dernier instant du déplacement 2 D'autres variantes du patron peuvent être définies par exemple en représentant chaque type de noeud début fin et arrêt par un type d'objet différent 166 RNTI E 13 C Parent et al FIG 2 – Un patron de modélisation de trajectoires En plus de la description de la structure interne de la trajectoire le patron inclut des relations crochets qui seront utilisées par le concepteur pour relier la trajectoire aux objets de l'application Dans la figure 2 les noms des crochets sont écrits en italiques Le type d'objet Trajectoire est relié à un type d'objet crochet ObjetATrajectoires qui représente l'objet du monde réel qui effectue les trajectoires Début fin et arrêt Noeud peuvent être reliés à des types d'objets spatiaux qui sont représentés par le type d'objet crochet spatial générique ObjetGéographique1 La relation EstDans impose une contrainte topologique d'inclusion le noeud doit être situé dans l'objet géographique Comme ce crochet est optionnel il est dessiné en pointillés De façon similaire les déplacements peuvent être reliés à un type d'objet crochet spatial ObjetGéographique2 par une autre relation topologique d'inclusion EstSur Cette dernière peut être utilisée pour modéliser les trajectoires contraintes par un réseau 167 RNTI E 13 Modélisation conceptuelle des trajectoires FIG 3 – Le patron de trajectoires utilisé pour l'application des Cigognes 6 3 Un exemple d'emploi du patron de trajectoires Quand un patron est utilisé les concepteurs doivent l'adapter à leur application Ils peuvent par exemple supprimer des éléments sans intérêt pour l'application ajouter de nouveaux éléments répondant à des besoins supplémentaires ou modifier la structure du patron pour l'adapter à leurs besoins Par exemple des types d'objet Début Fin et Arrêt peuvent être ajoutés comme sous types de Noeud Afin de connecter le patron au reste du schéma les concepteurs doivent remplacer les types d'objet crochet par des types d'objet de l'application ou rajouter d'autres relations crochets spécifiques à l'application La figure 3 montre un exemple d'utilisation du patron de trajectoires pour l'application de migration des cigognes Les concepteurs ont personnalisé le patron de la façon suivante Le type d'objet crochet ObjetATrajectoires a été mis en correspondance avec le type d'objet Cigogne Le type d'objet crochet ObjetGéographique1 et sa relation ont été dédoublés et sont devenus Pays et Zone ce dernier avec sa hiérarchie de sous types Zone et ses sous types décrivent les zones d'intérêt pour les oiseaux De la même façon le type d'objet crochet ObjetGéographique2 et sa relation ont été dédoublés La relation PasseSur qui décrit le fait que l'oiseau est passé au dessus d'une zone dangereuse pour lui est une relation topologique de type inclusion pour un instant au moins Pour qu'une instance de Déplacement puisse être liée à une instance de DangerNaturel le point mobile du déplacement doit être au moins un instant dans la zone du danger naturel Quant à la relation PassePrès son type a été modifié 168 RNTI E 13 C Parent et al C'est une relation métrique qui contraint la distance entre les objets liés Un nouveau lien non spatial Avec a été ajouté au type d'objet Déplacement il décrit le groupe s'il est connu avec lequel l'oiseau a fait ce vol ce déplacement Finalement des attributs spécifiques à l'application ont été ajoutés aux types d'objets du patron Par exemple la direction Nord Sud l'année de la trajectoire la météo durant la trajectoire ont été ajoutés à Trajectoire l'altitude est enregistrée le long des déplacements pour chaque arrêt où l'oiseau a été observé le type de l'arrêt les activités de l'oiseau son poids et son pourcentage de graisse sont enregistrés Les attributs météo et altitude sont des attributs variables dans le temps c'est à dire que l'historique de la météo est enregistré durant la totalité de la trajectoire et l'historique de l'altitude de l'oiseau est enregistré durant chaque déplacement En pratique la fonction spécifiant un attribut continu variable dans le temps est définie par une liste de couples valeur instant appelées valeurs d’échantillon ou points d’échantillon dans le cas de points variables dans le temps et par des fonctions d’interpolation entre les points de l’échantillon Quand un objet comporte plusieurs attributs variables dans le temps a priori leurs fonctions sont indépendantes c'est à dire que leurs valeurs d’échantillon sont définies pour différents instants Cependant si les valeurs de plusieurs attributs variables sont toujours enregistrées en même temps ces attributs sont temporellement liés Et cela doit être explicitement spécifié par une contrainte d’intégrité ou en regroupant les attributs dans un attribut complexe qui sera lui variable dans le temps Par exemple dans la figure 3 météo est un attribut complexe variable dans le temps dont les valeurs d’échantillon possèdent le format suivant instant vent température pression ciel D’un autre côté le type d’objet Déplacement possède deux attributs variables dans le temps geometry et altitude qui ne peuvent pas être regroupés dans un attribut complexe parce que geometry est un attribut prédéfini par le modèle de données MADS Une contrainte d’intégrité est donc nécessaire afin d’exprimer la contrainte suivante "Les listes de points d’échantillon des attributs geometry et altitude sont basées sur la même liste d’instants" Enfin afin de faciliter l’accès à l’information pour les utilisateurs les concepteurs peuvent choisir de stocker de l’information redondante et de gérer la cohérence de cette redondance via des contraintes d’intégrité Par exemple l’attribut naissance année du type d’objet Cigogne est défini comme dérivé de l’instant de début du cycle de vie de l’objet et l’attribut Nord Sud de Trajectoire comme dérivé des positions spatiales du début et de la fin de la trajectoire c'est à dire les positions des premier et dernier objets Nœud 7 Implémentation de l'approche Afin de valider nos approches de modélisation des trajectoires nous sommes en train de recueillir les descriptions et les données de plusieurs applications portant sur des trajectoires Nous modélisons les bases de données des applications puis les implémentons sur uun SGBD relationnel étendu au spatial Oracle 10 Nous utilisons ces bases de données de plusieurs façons pour répondre à des requêtes ponctuelles de type classique SQL pour faire de la fouille des trajectoires à l'aide de programmes spécifiques et enfin nous montons un entrepôt spécialisé pour les trajectoires Dans ce paragraphe nous présentons pour l'application des cigognes le schéma relationnel de la base de données qui correspond au schéma conceptuel de la figure 3 et à titre d'exemples quelques requêtes SQL Le schéma relationnel voir la figure 4 a été obtenu 169 RNTI E 13 Modélisation conceptuelle des trajectoires en suivant les règles classiques de traduction d'un schéma entité relation vers un schéma relationnel Une particularité est la traduction des attributs variables dans le temps dont la valeur est basée sur une liste de valeurs associées à leur temps de validité Selon que l'attribut varie de façon continue discrète ou par paliers le temps de validité est noté soit par un instant cas des attributs continus et discrets soit par un intervalle de temps cas des attributs par paliers Dans tous les cas un attribut variable est implémenté en relationnel par une table qui lui est propre et qui contient trois attributs la valeur instantanée l'instant ou l'intervalle de validité et une clé étrangère référençant l'objet propriétaire de l'attribut Ainsi les attributs variables en continu altitude et geometry qui appartiennent au type d'objet Déplacement génèrent chacun une table relationnelle DpltAltitude et DpltPoint De même l'attribut variable en continu météo du type d'objet Trajectoire qui est un attribut complexe regroupant les attributs vent température pression et ciel génère la table relationnelle TrajMeteo FIG 4 – Schéma relationnel correspondant à la figure 3 Une autre spécificité des schémas MADS est la présence de types de relation topologique ou de synchronisation temporelle qui contraignent les géométries ou les cycles de vie des objets liés Ces types de relation à contraintes sont traduits de la même façon que des relations classiques mais avec en plus un trigger qui vérifie lors des insertions et des mises à jour des objets liés que leurs géométries ou leurs cycles de vie satisfont bien la contrainte Par exemple le type de relation topologique EstDans qui lie Noeud à Pays dans la figure 3 est traduit dans la table Noeud de la figure 5 par une clé étrangère pays et par un trigger Ce trigger vérifie chaque fois qu'un tuple est inséré ou modifié dans Noeud que la valeur 170 RNTI E 13 C Parent et al spatiale de son attribut point est bien incluse dans la valeur spatiale de l'attribut géométrie du tuple de Pays qui est référencé par la clé étrangère pays De même le type de relation De qui lie Noeud et Déplacement dans la figure 3 est implémenté par la clé étrangère NoeudDebut dans la table Déplacement et par deux triggers Le premier assure la contrainte d'adjacence temporelle pour chaque tuple de Déplacement tDebut doit être l’instant suivant le tFin du tuple de Nœud référencé par NoeudDebut Le second trigger vérifie la contrainte d'égalité topologique pour un instant pour un point mobile le point de Déplacement se déplace le premier point de DpltPoint qui référence ce tuple de Déplacement doit être identique au point du tuple de Nœud référencé par NœudDébut À titre d'exemple nous donnons deux requêtes SQL qui peuvent être posées à la base de données La requête "Combien de fois la cigogne Max s’est elle arrêtée durant chacune de ses trajectoires " peut être exprimée comme suit SELECT t N°Traj t Debut COUNT n N°Noeud FROM Trajectoire AS t Noeud AS n WHERE t N°Traj=n N°Traj AND t nomCigogne="Max" GROUP BY t N°Traj t Debut Quant à la requête "Quelles activités a eu la cigogne pendant chaque arrêt de la trajectoire 133 " elle s'écrit très simplement SELECT N°Noeud activité FROM NoeudActivité WHERE N°Traj=133 8 Conclusion Dans les applications qui s'intéressent à des objets mobiles une connaissance approfondie des trajectoires spatio temporelles de ces objets est très souvent indispensable à la réalisation des objectifs de l'application Par exemple l'optimisation d'un réseau de transport demande que l'on recueille les données sur les déplacements de la population concernée et que l'on modélise ces déplacements Le plus souvent la connaissance recherchée ne se limite pas au tracé spatio temporel des déplacements Elle peut inclure d'autres informations par exemple le moyen de transport utilisé la classe d'âge de la personne ou sa capacité de mouvement invalides handicapés ou encore des informations sur les lieux visités La description des informations pertinentes relatives à une trajectoire peut donc conduire à des constructions complexes qui combinent des caractéristiques relatives au mouvement brut où est l’objet et quand avec une variété d’annotations sémantiques décrivant les connaissances spécifiques nécessaires à chaque application La contribution de cet article est essentiellement de définir précisément ce concept de trajectoire et d'en donner une caractérisation qui tout en s'appuyant sur une étude des besoins est indépendante de toute application particulière En particulier nous proposons de structurer les trajectoires grâce aux concepts complémentaires d'arrêt et de déplacement ce qui permet d'enrichir le contenu sémantique d'une trajectoire Ensuite l'article propose une approche de modélisation des trajectoires à l'aide d'un patron de conception design pattern autrement dit une construction standard ici exprimée dans les termes d'un modèle entité relation que les concepteurs peuvent réutiliser quelle que soit la nature de leur application 171 RNTI E 13 Modélisation conceptuelle des trajectoires L'article détaille les composantes du patron proposé et la manière de l'intégrer dans le schéma de la base de données de l'application Enfin l'implémentation du patron sur un SGBD relationnel objet est montrée À notre connaissance ce travail est le premier à proposer une approche conceptuelle pour modéliser la sémantique des objets mobiles Il ajoute ainsi une couche sémantique par rapport aux approches habituelles de modélisation qui représentent uniquement les déplacements bruts des objets mobiles Le travail présenté peut être étendu dans plusieurs directions Par exemple il conviendrait d'explorer les contraintes particulières des trajectoires liées à un réseau par exemple les voitures circulant sur un réseau routier afin de déterminer l'influence de ces contraintes en termes de modélisation Dans le cadre du projet GeoPKDD geopkdd it nous explorons une stratégie similaire de modélisation pour un entrepôt de trajectoires première étape pour réaliser des fouilles de données destinées à extraire des trajectoires des connaissances plus synthétiques pour les décideurs du domaine étudié voir par exemple Alvarez et al 2007 et Giannotti et Nanni 2006 Le travail pour le développement d'un entrepôt de trajectoires doit notamment conduire à la spécification d’opérateurs d’agrégation de trajectoires voir Braz et al 2007 Différents types d’agrégation sont possibles et peuvent être réalisés à différents niveaux en distinguant par exemple les opérateurs appliqués aux composants d’une trajectoire des opérateurs appliqués sur la trajectoire entière Un exemple d’opération sur les composants est l'agrégation qui remplace un ensemble d’arrêts dans une région par un arrêt unique représentant l’intégralité du temps passé dans cette région Un exemple d’opération réalisée sur la trajectoire entière est l'agrégation qui remplace un ensemble de trajectoires par la trajectoire moyenne calculée à partir de l’ensemble Références V T de Almeida R H Güting and T Behr 2006 Querying Moving Objects in SECONDO Proc of the 7th International Conference on Mobile Data Management MDM 2006 Nara Japan 47 51 S Balley C Parent S Spaccapietra 2004 Modeling geographic data with multiple representations IJGIS International Journal on GIS 18 4 327 352 Taylor Francis Y Bédard S Larrivée M J Proulx M Nadeau 2004 Modeling geospatial databases with Plug Ins for visual languages a pragmatic approach and the impacts of 16 years of research and experimentations on Perceptory In Conceptual Modeling for Advanced Applications Domains LNCS Vol 3289 17 30 Springer T Behr V T de Almeida R H Güting 2006 Representation of Periodic Moving Objects in Databases Proc of the 14th ACM International Symposium on Advances in Geographical Information Systems ACM GIS 2006 Arlington Virginia USA 43 50 S Brakatsoulas D Pfoser N Tryfona 2004 Modeling Storing and Mining Moving Object Databases Proc of the IEEE International Database Engineering and Applications Symposium IDEAS'04 68 77 172 RNTI E 13 C Parent et al F Braz S Orlando R Orsini A Raffaeta A Roncato C Silvestri 2007 Approximate aggregations in trajectory data warehouses Proc of the Workshop on Spatio temporal Data Mining STDM’07 in conjunction with ICDE’07 Istanbul Turkey 536 545 E Camossi M Bertolotto E Bertino G Guerrini 2003 A Multigranular Spatiotemporal Data Model Proc of 11th International Symposium on Advances in Geographic Information Systems ACM GIS 2003 New Orleans Louisiana USA 94 101 V P Chakka A Everspaugh J M Patel 2003 Indexing Large Trajectory Data Sets With SETI Proc of the First Biennial Conference on Innovative Data Systems Research CIDR Asilomar CA USA M Egenhofer D Mark 1995 Naive geography In Spatial Information Theory A Theoretical Basis for GIS A Frank W Kuhn Eds LNCS Vol 988 1 15 Springer A Friis Christensen C Jensen J Nytun D Skogan 2005 A Conceptual Schema Language for the Management of Multiple Representations of Geographic Entities Transactions in GIS 9 3 345 380 Blackwell Publishing E Gamma R Helm R Johnson J Vlissides 1995 Design Patterns Elements of Reusable ObjectOriented Software Addison Wesley Professional 1995 F Giannotti M Nanni D Pedreschi 2006 Efficient mining of temporally annotated sequences Proc of SIAM Data Mining Conference SDM06 Bethesda Maryland USA R H Güting M H Bohlen M Erwig C S Jensen N A Lorentzos M Schneider M Vazirgiannis 2000 A Foundation for Representing and Querying Moving Objects ACM Transactions on Database Systems 25 1 1 42 R H Güting T Behr V T de Almeida Z Ding F Hoffmann and M Spiekermann 2004 SECONDO An Extensible DBMS – Architecture and Prototype Fernuniversität Hagen Informatik Report 313 R H Güting and Markus Schneider 2005 Moving Object Databases Morgan Kaufmann Publishers 2005 R H Güting V T de Almeida and Z Ding 2006 Modeling and Querying Moving Objects in Networks VLDB Journal 15 2 165 190 K Hornsby M Egenhofer 2002 Modeling Moving Objects over Multiple Granularities Annals of Mathematics and Artificial Intelligence 36 1 2 177 – 194 V Khatri S Ram R Snodgrass 2004 Augmenting a conceptual model with geospatiotemporal annotations IEEE Transactions on Knowledge and Data Engineering 16 11 1324–1338 M P Kwan and J Lee 2003 Geovisualization of Human Activity Patterns Using 3D GIS A Time Geographic Approach In Spatially Integrated Social Science Michael F Goodchild and Donald G Janelle Eds 48 66 Oxford University Press P Laube S Imfeld R Weibel 2005 Discovering relative motion patterns in groups of moving point objects International Journal of Geographic Information Science 19 6 639 668 Taylor Francis 173 RNTI E 13 Modélisation conceptuelle des trajectoires D Mark M Egenhofer L Bian P Rogerson J Vena 1999 Spatio temporal GIS Analysis for Environmental Health Proc of the 2nd International Workshop on Geography and Medicine GEOMED'99 Paris France V Noyon T Devogele C Claramunt 2005 A Formal Model for Representing Point Trajectories in Two Dimensional Spaces Proc of the Workshop on Conceptual Modelling and GIS COMOGIS'05 LNCS Vol 3770 208 217 Springer Oracle database 10g 2007 oracle com database index html April 2007 C Parent S Spaccapietra E Zimanyi 2006a Conceptual Modeling for Traditional and Spatio Temporal Applications – The MADS Approach Springer 2006 C Parent S Spaccapietra E Zimanyi 2006b The MurMur project Modeling and querying multi representation spatio temporal databases Information Systems 31 8 733–769 Elsevier M Pelanis S Simonas C S Jensen 2006 Indexing the Past Present and Anticipated Future Positions of Moving Objects ACM Transactions on Database Systems 31 1 255 298 N Pelekis Y Theodoridis S Vosinakis T Panayiotopoulos 2006 Hermes a framework for location based data management In Advances in Database Technology EDBT 2006 LNCS Vol 3896 1130–1134 Springer N Pelekis B Theodoulidis 2002 TAU TLL Data Cartridge Technical Report TR 02 3 CRIM UMIST Manchester UK S Spaccapietra C Parent M L Damiani J A de Macedo F Porto C Vangenot 2008 A Conceptual View on Trajectories Knowledge and Data Engineering 65 1 126 146 Elsevier L Speicys C S Jensen A Kligys 2003 Computational data modeling for network constrained moving objects Proc of the 11th ACM International Symposium on Advances in Geographic Information Systems ACM GIS 2003 New Orleans Louisiana USA 118 125 M Theriault C Claramunt A Seguin P Villeneuve 2002 Temporal GIS and Statistical Modeling of Personal lifelines In Advances in Spatial Data Handling D Richardson P van Oosterom eds 433 449 Springer N Tryfona R Price C Price 2003 Conceptual Models for Spatio temporal Applications In Spatio Temporal Databases – The CHOROCHRONOS Approach M Kubarakis et al Eds LNCS Vol 2520 79 116 Springer O Wolfson B Xu S Chamberlain L Jiang 1998 Moving objects databases Issues and solutions Proc of the 10th International Conference on Scientific and Statistical Database Management SSDBM’98 Washington DC USA 111–122 O Wolfson A P Sistla S Chamberlain Y Yesha 1999 Updating and Querying Databases that Track Mobile Units Special issue of the Distributed and Parallel Databases Journal on Mobile Data Management and Applications 7 3 257 288 Kluwer Academic Publishers 174 RNTI E 13 C Parent et al ISO IEC 13249 3 2006 Technologies de l'information Langages de bases de données Multimédia SQL et paquetages d'application Partie 3 Spatial Summary An intelligent perception of movement of mobile objects people cars parcels etc is a premise to many applications in different domains e g control of worldwide parcel distribution traffic management fauna monitoring Current database management systems DBMS do not provide the concepts and functions needed to support a semantic analysis of movement At best they support the recoding and querying of spatial extents with no explicitly attached temporal reference Previous research introduced and developed the concept of mobile objects as objects whose spatio temporal location is defined by a function from time to space This paper reaches beyond object's location to focus on the concept of trajectory as the semantic unit of movement that underlines the application view of mobility We propose a trajectory description approach at the conceptual level that covers the geometric temporal and semantic aspects of trajectories as well as their structural components departure point arrival point and intermediate stops and moves Each element trajectory stop move and part of move can be semantically annotated either via attribute values or links to objects in the application database The proposed modeling approach relies on the use of a design pattern as an easy way to capture both trajectories' standard features and application specific features Finally the paper discusses how conceptual trajectories can be implemented using object relational DBMS 175 RNTI E 13 Modélisation conceptuelle des trajectoires 176 RNTI E 13