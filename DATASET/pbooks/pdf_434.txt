Automatisation Construction Variables Classification Supervisée Boullé Dhafer Lahbib Orange avenue Pierre Marzin 22300 Lannion boulle orange perso francetelecom boulle Résumé article proposons cadre visant automatiser construction variables apprentissage supervisé particulier cadre multi tables connaissance domaine spécifiée struc turant données variables tables liens entre tables autre sissant règles construction variables espace construction riables ainsi défini potentiellement infini problèmes explo ration combinatoire apprentissage introduisons distribution probabilité priori espace variables constructibles ainsi gorithme performant tirage échantillons cette distribution rimentations intensives montrent approche robuste performante Introduction projet fouille données phase préparation données extraire table données phase modélisation Chapman préparation données seulement coûteuse temps étude également critique qualité résultats escomptés préparation repose essentiellement recherche représentation pertinente problème modéliser recherche étapes complémentaires construction sélection variables sélection variables largement étudiée littérature Guyon papier focalisons approche filtre évalue corrélation entre variables explicatives variable cible indépendamment méthode classification utilisée adaptée phase préparation données grand nombre variables descriptives construction variables Motoda sujet nettement moins étudié littérature scientifique représente néanmoins travail considérable analyste données Celui exploite connaissance domaine créer nouvelles variables tentiellement informatives pratique données initiales souvent issues bases données relationnelles directement exploitables plupart techniques classification exploitent format tabulaire attributs valeurs fouille données lationnelle anglais Multi Relational Mining introduit Knobbe exploiter directement formalisme multi tables transformant représen tation relationnelle programmation logique inductive Džeroski Lavrac données recodées forme prédicats logiques autres méthodes dénommées Automatisation Construction Variables propositionalisation Kramer effectuent format tabulaire représentation multi tables création nouvelles variables exemple méthode laggs Krogel Wrobel exploite fonctions moyenne médiane résumer variables numériques tables secondaires comptes valeur variables catégorielles secondaires méthode Tilde Blockeel permet construire agrégats complexes exploitant conjonctions condition sélection individus tables secondaires expressivité méthodes heurte néanmoins problèmes suivants complexité paramétrage méthode explosion binatoire nombre variables construites difficile maitriser risque apprentissage croissant nombre variables produites papier proposons cadre visant automatiser construction variables objectif simplicité maîtrise combinatoire construction variables robustesse apprentissage partie présente formalisme description domaine connaissance format données multi tables entrée liste règles construction variables partie introduit critère évaluation variables construites selon approche Bayesienne proposant distribution priori espace variables constructibles partie analyse problème échantillonnage espace propose algorithme efficace calculable produire échantillons variables construites taille désirée partie évalue approche nombreux données Finalement partie conclut article propose pistes travaux futurs Spécification domaine construction variables proposons cette section cadre formel spécifier domaine connais sance permettant piloter efficacement construction variables potentiellement utiles classification objectif proposer nouveau formalisme expressif généraliste description connaissance simplement préciser cadre lequel appuieront algorithmes construction variables présentés partie maine connaissance décline parties description structure données choix règles construction variables utilisables Structure données structure simple structure tabulaire instance représentée liste variables chacune étant définie types usuels numérique catégoriel peuvent étendus autres types spécialisés comme exemple dates heures textes données réelles étant souvent issues bases données relation nelles naturel étendre cette structure multi tables propose prendre compte structures inspirant langages informatiques structurés orientés objets objet étude statistique instance appartient table principale objet principal alors défini liste variables types peuvent simple numérique goriel comme tabulaire structuré objets enregistrements table secondaire relation tableau objets enregistrement table secondaire relation classification supervisée variable cible variable gorielle objet principal figure présente exemple utilisation formalisme Boullé Lahbib objet principal client Customer objets secondaires usages relation variables simples structurés ObjectArray Usage variables identifiant préfixées servent essentiellement établir relationnelle elles considérées comme variables descriptives Customer id_customer Usages Usage Class Usage id_customer Product useDate Structure données problème gestion relation client Règle construction variables règle construction variable règle calcul similaire fonction méthode langage informatique définie liste opérandes retour opérandes ainsi retour typés selon mêmes types variables utilisées spécification structure données exemple règle YearDay permet construire variable numérique partir variable opérande provenir variable native présente représentation départ résultat autre règle calcul parti culier règle sélection TableSelection provenir intervalle valeur issue apprentissage article règles construction prises compte expérimentations partie suivantes TableSelection ObjectArray ObjectArray sélection objets tableau selon conjonction critères appartenance intervalles égalité valeurs TableCount ObjectArray effectif tableau TableMode ObjectArray valeur fréquente TableCountDistinct ObjectArray nombre valeurs différentes TableMean ObjectArray valeur moyenne TableMedian ObjectArray valeur médiane TableMin ObjectArray valeur minimum TableMax ObjectArray valeur maximum TableStdDev ObjectArray écart TableSum ObjectArray somme valeurs exploitant structure données présentée figure règles construction précédentes enrichies règle YearDay dates exemple construire variables suivantes enrichir description client MainProduct TableMode Usages Product LastUsageYearDay TableMax Usages YearDay useDate NbUsageProd1FirstQuarter TableCount TableSelection Usages YearDay useDate Product Prod1 Automatisation Construction Variables Evaluation variables construites exploiter connaissances domaine piloter efficacement construction variables potentiellement utiles prédiction variable cible formalisme introduit partie structure données avoir plusieurs niveaux profondeur voire posséder structure graphe exemple molécule graphe noeuds atomes liaisons entre atomes règles calcul peuvent utilisées comme opérandes autres règles conduisant formules calcul longueur quelconque alors confronté espace variables constructibles nombre poten tiellement infini problèmes principaux suivants explosion combinatoire exploration espace risque apprentissage propose solution problèmes introduisant critère évaluation variables selon approche Bayesienne permettant pénaliser variables complexes introduit effet distribution priori espace toutes variables algorithme efficace échantillonnage espace variables selon distribution priori Evaluation variable construction variables enrichir table principale nouvelles variables seront prises entrée classifieur classifieurs usuels prenant entrée uniquement variables numériques catégorielles intéresse évaluation variables Prétraitement supervisé prétraitement supervisé consiste partitionner variable numérique intervalles variable catégorielle groupes valeurs estimation densité conditionnelle constante partie paramètres modèle traitement nombre parties partition distribution multinomiale classes chaque partie approche prétraitement supervisé formulé problème sélection modèles traité selon approche Bayesienne exploitant priori hiérarchique paramètres modélisation meilleur modèle modèle maximum posteriori prenant négatif probabilités interprète comme longueur codage Shannon approche minimum description length Rissanen revient minimiser longueur codage modèle évaluation partition supervisée variable longueur codage classe connaissant modèle données descriptives nombre individus échantillon apprentissage entropie conditionnelle variable classe connaissant variable descrip critère optimisation détaillés Boullé discrétisation supervisée Boullé groupement valeurs supervisé Outil Khiops implémentant méthodes disponible shareware khiops khiops Boullé Lahbib Modèle filtrage variables modèle correspond particulier seule partie intervalle groupe valeurs modélisation directe classes multinomiale utiliser variable descriptive valeur critère revient encodage direct classe cibles critère évalua variable alors utilisé approche filtre sélection variables Guyon seules variables évaluation meilleure celle modèle considérées comme informatives retenues issue phase préparation données Prise compte construction variables Quand nombre variables natives construites devient important risque variable considérée comme infor mative devient critique prévenir risque apprentissage propose article exploiter espace construction variables décrit partie introduisant distribution priori ensemble modèles construction variables obtient alors régularisation Bayesienne obtention variables permettant naliser priori variables complexes traduit construction supplémentaire critère évaluation variables devient celui formule negatif probabilité priori longueur codage variable native construite définissons maintenant Distribution priori variables variable évaluer variable numérique catégorielle table principale native obtenue application récursive règles construction variables espace variables ainsi défini étant potentiellement infini définir probabilité priori espace nombreux problèmes implique nombreux choix guider choix propose suivre principes généraux suivants prise compte variables construites impact minimal variables natives priori uniforme possible minimiser biais priori exploite mieux connaissances domaine variables natives variables constructibles problème limite choix variable évaluer parmi variables numériques catégorielles table principale utilisant priori uniforme choix variables construites variables constructibles abord choisir utilise variable native construite priori uniforme choix implique surcoût variables natives contrevient impact minimal variables natives propose alors considérer choix variable construite comme possibilité choix supplémentaire variables Automatisation Construction Variables natives variable native devient alors impact minimal rapport construction variables Choisir variable construite repose alors hiérarchie suivante choix choix construire variable choix règle construction parmi règles construction applicables retour numérique catégoriel chaque opérande règle choix variable native construite compatible opérande attendu utilisant priori hiérarchique uniforme chaque niveau hiérarchie variable construite décompose opérandes règle utilisée selon récursive variable variables natives construites applicables opérandes règle règle TableSelection extrait table objets selon conjonction critères exploite façon similaire hiérarchie choix nombre variables sélec liste variables sélection chaque variable sélection choix opérande sélection intervalle valeur intervalles choix granularité nombre partiles intervalle index partile figure donne exemple telle distribution priori ensemble variables constructibles règles construction TableMode TableMin TableMax problème gestion relation client présenté figure exemple sélection variable native Celui variable construite TableMin Usages earDay exploite hiérarchie choix condui TableMin Usages earDay Distribution probabilité priori construction variables blème gestion relation client apriori construction variables ainsi défini correspond hiérarchie distri butions multinomiales profondeur potentiellement infinie HDMPI variables natives obtenues premier niveau multinomiale alors variables construites probabilités priori autant faibles elles complexes exploitent parties profondes prior HDMPI Boullé Lahbib Construction échantillon variables objectif construire nombre donné variables créer représentation données potentiellement informative classification supervisée proposons construire échantillon variables tirage selon distribution priori présen premier algorithme naturel construction échantillon démontrons efficace calculable proposons alors second algorithme répondant problème Tirages aléatoires successifs Algorithm Tirages aléatoires successifs Require Nombre tirages Ensure Echantillon variables construites Tirer selon prior HDMPI Ajouter algorithme consiste tirer successivement variables selon prior HDMPI Chaque tirage consiste partir racine arbre prior descendre hiérarchie tirages multinomiaux successifs jusqu obtention variable native construite correspond feuille arbre prior algorithme naturel utilisé général efficace calculable démontrons dessous algorithme efficace domaine connaissance comportant variables natives évaluables table principale variable constructible prior HDMPI réduit multionomiale valeurs équidistribuées effectue tirages selon cette multinomiale espérance nombre variables différentes obtenues Efron Tibshirani retrouve taille échantillon boostrap savoir variables obtenues tirages obtenir variables tirages efficace variables constructibles multinomiale racine prior HDMPI comporte cette choix équidistribués tirages permettent construire variables noter problème innefficacité produit niveaux profondeur prior HDMPI tirage opérandes règles cours construction algorithme calculable domaine connaissance comportant seule variable native numérique seule règle construction riables construire nombre Catalan permet dénombrer telles expres sions correspond nombre façons différentes placer parenthèses autour facteurs nombre arbres binaires feuilles Chaque variable correspondant arbre binaire feuilles nombre formule vient exemplaires différents Automatisation Construction Variables chacun probabilité priori selon prior HDMPI alors calculer espérance longueur variable calculée nombre feuilles arbre binaire calcul utilisant formule Stirling approximer nombres Catalan établit formule cette espérance infinie signifie hasard variable selon prior HDMPI parmi ensemble expressions faisant intervenir algorithme mettra moyenne temps infini avant produire variable algorithme calculable général Tirages aléatoires simultanés Algorithm Tirages aléatoires simultanés Require Nombre tirages Ensure Echantillon variables construites Partir racine hiérarchie prior HDMPI Calculer nombre tirages branche prior variable native règle opérande branche prior feuille terminale prior variable construite depuis règle complète Ajouter Propager construction façon récursive distribuant tirages multi nomiale niveau Comme possible tirer variables individuellement proposons créer échantillon directement plusieurs tirages simultanés multinomiale simple ayant événements probabilités probabilité échantillon tirages effectifs évènement échantillon probable obtenu maximisant expression maximum vraisemblance correspond effectifs exemple multino miale équidistribuée tirages remarque expression atteint maximum évènements tirés remédie problème efficacité décrit partie algorithme exploite tirage maximum vraisemblance récursivement tirages répartis selon variables natives construites chaque niveau prior HDMPI nombre tirages demandés diminue descendant hiérarchie prior égalité entre plusieurs choix exemple tirage variables choix hasard priorité variables natives Boullé Lahbib choix entre variables natives construites répartissant tirages branche rarchie prior HDMPI effectifs décroissants selon profondeur hiérarchie algorithme efficace calculable taille échantillon obtenu étant tentiellement inférieure nombre tirages demandés réitère appel algorithme doublant nombre tirage demandés chaque appel jusqu obtenir nombre variables désiré aucune variable supplémentaire produite entre appels successifs Evaluation évaluons méthode proposée focalisant suivants capacité générer grands nombres variables problème explosion combinatoire résistance apprentissage apport prédiction Bases multi tables petite taille cette première évaluation utilisons bases issues communauté mining multi tables ignorant variables table principale focalisant construction variables propositionalisation moyen règles construction présen partie avoir résultat référence utilise méthode apparentée Relaggs Krogel Wrobel basée utilisation mêmes règles construction celles partie excepté TableSelection effectif valeur chaque variable secondaire catégorielle Suite cette construction variable exploite prédicteur sélection variables moyennage modèles Boullé robuste performant grands nombres variables bases utilisées bases issues traitement image bases Elephant Tiger variables cibles Desert Mountains Sunset Trees moléculaire Diterpenses Musk1 Musk2 Mutagenesis trois représentations médecine Stulong variables cibles Cholrisk Htrisk Kourisk Obezrisk Rarisk ainsi TicTacToe Asuncion Newman traitée multi tables cases table secondaire bases petite taille individus utilisant algorithme contrôlons taille représentation générant 10000 100000 variables donnée échantillons apprentis processus validation croisée stratifiée niveaux représente total environ millions variables construites Evaluation performance première analyse collectons moyen chaque nombre variables générées méthode Relaggs appuie construction variables application systématique règles permet contrô combinatoire nombre variables produites varie dizaine environ variables selon reste néanmoins applicable petites bases fournit performance compétitive résultats présentés figure montrent performance notre approche croit systématiquement nombre variables construites lamda data_MIMLimage Elephant Tiger Mutagenesis Musk1 Musk2 grupos dataset Diterpenses unige woznica rel_weka Stulong euromise challenge2003 lamda data_MIMLimage grupos dataset unige woznica rel_weka unige woznica rel_weka euromise challenge2003Vers Automatisation Construction Variables atteint dépasse performance Relaggs bases quand nombre riables construites suffisant trois bases Musk1 Musk2 performance notre approche nettement moins bonnes celles Relaggs trois bases bruitées petites Musk1 Musk2 moins instances correspondent exactement trois bases grande variance résul Relaggs entre écart trois bases nombre instances insuffisant compenser régularisation critère plupart variables construites alors éliminées chuter performance 10000 100000 Relaggs fonction nombre variables construites Evaluation robustesse seconde analyse expérience réalisée après affectation aléatoire classes chaque données évaluer robustesse approche collectons nombre variables sélectionnées critère prise compte construction variables régularisation construc moyenne variables sélectionnées pourcentages diminuant taille petites bases grandes exemple Musk1 comprend instances variables parmi 100000 identifiées comme informatives prise compte régularisation construction méthode extrêmement robuste millions variables générées identifiées comme étant informatives aucune exception Bases taille moyenne seconde évaluation utilisons trois bases taille moyenne Connect4 kerHands Digits Asuncion Newman Connect4 correspond ensemble positions légales après coups Puissance prédire issue partie victoire défaite joueurs jouant coups parfaits cassé format tabulaire initial représenté forme multi tables table secondaire comportant cellules trois variables secondaires 67557 instances utilisées apprentissage PokerHand respond cartes poker couleur variables numériques chaque carte reconnaitre parmi classes paire double paire brelan format tabulaire initial représenté forme multi tables table secondaire comportant cartes 25000 instances utilisées prentissage 1000000 Digits images décrites Boullé Lahbib pixels objectif reconnaissance chiffre manuscrit format laire initial représenté forme multi tables table secondaire comportant pixels trois variables secondaires GrayLevel 60000 instances utilisées apprentissage 10000 évaluons bonne prédiction discriminant trois problèmes difficiles représentation initiale prédicteur tient performances figure montre performances notre approche croissent nombre variables construites dépassent significative celle classifieur représentation initiale Connect4 10000 PokerHand 10000 Digits 10000 100000 bonne prédiction bases Connect4 PokerHand Digits fonction nombre variables construites Conclusion avons proposé article cadre visant automatiser construction riables classification supervisée description format multi table données choix règles construction variables avons défini distri bution priori ensemble toutes variables constructibles moyen formalisme avons démontré effectuer tirages successifs selon cette distribution priori problèmes critiques efficacité calculabilité proposé algorithme efficace permettant effectuer simultanément grand nombre tirages façon construire représentation comportant nombre variables désiré expérimentations montrent approche résout problème explosion combinatoire intervient proches construction variables application systématique règles problème apprentissage quand représentations comportent grands nombres variables performances obtenues classification prometteuses travaux futurs prévoyons améliorer prise compte connaissances domaine premier étendant liste règles construction disponibles spécialisations potentielles domaine applicatif autre piste travail consiste rechercher meilleures variables construire échantillonnant distribution posteriori plutôt distribution priori Références Asuncion Newman machine learning repository Blockeel Raedt Ramon Induction Clustering Trees Proceedings Fifteenth International Conference Machine Learning Automatisation Construction Variables Boullé Bayes optimal approach partitioning values categorical attri butes Journal Machine Learning Research Boullé Bayes optimal discretization method continuous attributes Machine Learning Boullé Compression based averaging selective naive Bayes classifiers Journal Machine Learning Research Chapman Clinton Kerber Khabaza Reinartz Shearer Wirth CRISP mining guide Technical report CRISP consor Džeroski Lavrac Relational Mining Springer Verlag Efron Tibshirani introduction bootstrap Monographs Statistics Applied Probability Chapman Guyon Nikravesh Zadeh Feature Extraction Foundations Applications Springer Knobbe Blockeel Siebes Wallen Multi Relational Mining Proceedings Benelearn Kramer Flach Lavrac Propositionalization approaches relational mining Džeroski Lavrac Relational mining Chapter Springer Verlag Krogel Wrobel Transformation based learning using multirelational gregation Springer Motoda Feature Extraction Construction Selection Mining Perspective Kluwer Academic Publishers preparation mining Morgan Kaufmann Publishers Francisco Rissanen Modeling shortest description Automatica Shannon mathematical theory communication Technical Report systems technical journal Ramon Blockeel Refining aggregate conditions relational learning Proceedings European conference Principle Practice Knowledge Discovery Databases Springer Verlag Summary paper suggest framework automate variable construction supervised learning especially multi relational setting Domain knowledge specified describ structure means variables tables links across tables choosing construction rules space variables constructed virtually infinite which raises combinatorial fitting problems introduce prior distribution constructed variables effective algorithm samples constructed variables distribution Experiments approach robust efficient Introduction Spécification domaine construction variables Structure données Règle construction variables Evaluation variables construites Evaluation variable Distribution priori variables Construction échantillon variables Tirages aléatoires successifs Tirages aléatoires simultanés Evaluation Bases multi tables petite taille Bases taille moyenne Conclusion