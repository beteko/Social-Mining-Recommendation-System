E33Défi Modélisation Sensitive Enrichissement données Vincent Levorato Michel Matthieu Lagacherie Technology vlevorato mlagacherie Université Orléans vincent levorato orleans TOTAL Digital Corporate michel total Ecole mines Saint Etienne Résumé conférence propose contexte espaces verts ville Grenoble notamment arbres présents objectif proposer modèle données permettrait prédire mieux arbres malades ainsi localisa potentielle maladie Après avoir obtenu quelques résultats intéressants modèles standards notre approche utilisant modèle Sensitive Against CSOAA permet obtenir exactitude précision rappel prédiction unilabel préci rappel micro ainsi précision rappel macro prédiction multilabel extraction connaissances tâche permis mettre relief intérêt ajout données nature ladies concentration pollution ville Introduction Données travail présenté article répond enjeu ville Grenoble prédire apparition maladies parmi arbres urbain partie article expliquera notre approche types prédiction proposés tâche unilabel multilabel seconde partie proposera enrichissement données suivie conclusion Avant étudierons comment avons préparé données intégrer modèles Données disponibles Chaque arbre possède variables décrivent variables prédire reflète arbre Default prenant valeurs variables spécifiant endroits atteints Collet Houppier Racine Tronc prenant également valeurs Parmi données fournies géolocalisation chaque arbre était présente travers coordonnées figure aperçu implantation arbres ville premier données contenait environ arbres second environ total arbres final contient également arbres donne apprentissage correspondant trois quarts données contre quart Positionnement arbres sains malades rouge Préparation données Données numériques certain nombre champs total possède valeurs numériques ADR_SEC ANNEEDEPLANTATION ANNEEREALISATIONDIAGNOSTIC ANNEE TRAVAUXPRECONISESDIAG IDENTIFIANTPLU coord_x coord_y lesquels aucun formatage nécessaire rajoutons champ DIAMETREARBREAUNMETRE cette catégorie prenant première valeur intervalle Seules valeurs quantes gérées certains champs ANNEEREALISATIONDIAGNOSTIC ANNEETRAVAUXPRECONISESDIAG IDENTIFIANTPLU valeurs manquantes remplacées garder présence information pourrait apparaître comme signal faible DIAMETREARBREAUNMETRE valeurs manquantes remplacées fonction genre botanique arbre GENRE_BOTA autrement diamètre fréquent rapport genre botanique arbre question Données catégorielles champ REMARQUES autres champs transformés valeurs numériques entier chaque modalité catégorie valeurs manquantes Levorato gérées ainsi ESPECE diamètre valeurs manquantes remplacées fonction genre botanique arbre GENRE_BOTA toutes autres variables catégorielles valeurs manquantes gérées comme catégorie travaillerons après préparation données ensemble arbres exacte modifiera nombre Données textuelles champ REMARQUES retenu notre attention donnée textuelle placer texte toute valeur manquante nulle manquante permet garder champ tester premier modèle utilise informations texte deuxième temps avons utilisé technique connue comparaison grands volumes textes Local Sensitive Hashing Andoni Razenshteyn grams Kondrak avons haché chaque champ REMARQUES avons gardé valeur minimale minHash textes identiques probabilité avoir certain nombre codes hachage identiques grande utilisant fonctions hachage différentes ajoute autant variables numériques arbre permettra améliorer légèrement modèle comme verrons résultats Données géolocalisation coordonnées arbres notre gérées comme simples données riques Néanmoins avons voulu vérifier densité arbres endroit donné pouvait influer prédictions avons effectué clustering points respondant coordonnées arbres prime abord pense algorithme Means cependant celui impose choisir valeur contrainte traitée comme hypothèse forte avoir clusters linéairement séparables algorithme clustering DBSCAN résout contraintes permet construire densités différentes voulons précisément obtenir sommes penchés algorithme OPTICS généralise DBSCAN permet obtenir clusters densités différentes Ankerst paramètres minPts méthode respectivement rayon maximum recherche nombre minimum voisins trouver rayon avons traités comme avons ignoré prenant grande valeur possible laquelle résultat clustering évolue avons choisi minPts valeurs expliquent faible densité global arbres ainsi avoir arbre classifié cluster avoir arbres classifiés algorithme renverra augmente valeur minPts algorithme produit ainsi sorte dendrogramme lequel autre valeur nécessaire effectuer coupe certain nombre recherche optimum existent avons préféré choisir cette valeur manière obtenir meilleure prédiction maximisant homogénéité clusters mesure Rosenberg Hirschberg avons choisi valeur donne clusters score homogénéité viron nouvelle variable numérique catégorielle ajoutée données prenant comme valeur identifiant cluster nombre clusters taille amènent aucune information clusters cohérents Clustering obtenu OPTICS Tâche prédiction défauts arbre Modèles prédiction unilabel contexte supervisé plusieurs algorithmes peuvent utilisés apprentis prédiction avons utilisé abord modèles classifieurs connus Ensemble learning Random Forests Breiman Extremely Randomized Trees appelés également Extra Trees Geurts faire simple modèles composés certain nombre arbres décision chacun vision partielle blème retour forêt correspond ensemble votes arbres modèles implémentés librairie Python Scikit learn Pedregosa avons utilisée Résultats prédiction unilabel baseline exactitude précision rappel leurs rappellerons entre parenthèses comparaison utilisant obtenons résultats tableau forêts arbres misation particulière paramètres résultats similaires terme exactitude avons ensuite ajouté variable issue clustering expliqué section résultats apparaissent tableau constate impact positif modèle Dernier modèles ajoutant variables numériques tirées hachage champ Levorato REMARQUES expliqué section résultats donnés tableau finalement gagner amélioration précision modèle Extra Trees Exactitude Précision Rappel Performances modèles cross validation label Exactitude Précision Rappel Performances modèles cross validation ajout riable issue clustering OPTICS label Exactitude Précision Rappel Performances modèles cross validation ajout codes hachage champ REMARQUES label première analyse variables contribuant ensemble arbres indique expert grande influence ainsi géolocalisation moindre mesure dernier caractéristiques propres arbre différents tests avons voulu vérifier expert pourrait fournir bonnes prédictions gardons variables propres celui variables diagnostic approchons résultats utilisant ensemble variables exemple modèle Random Forest paramétré manière obtenons exactitude précision rappel Sachant atteignons rappel meilleur montre autres informations permettant couvrir ensemble complet réduire ainsi nombre négatifs Modèles prédiction multi label classification multi label consiste problème apprentissage plusieurs classes peuvent affectées simultanément exemple trouve usuellement grandes gories approches Tsoumakas Katakis Participation variables NOTEDIAGNOSTIC coord_x coord_y PRIORITE DERENOUVELLEMENT DIAMETREARBREAUNMETRE CODE_PARENT_DESC CODE_PARENT TRAVAUXPRECONISESDIAG ESPECE GENRE_BOTA Transformer problème convertir problème pouvant résolu algorithme classification binaire multiclasses usuel Utiliser algorithmes multiclasses transformés peuvent résoudre directement problème multi label avons cherché exploiter solutions multi labels existantes rapidement plémentables pourquoi sommes tournés seconde classe approche modèles Ensemble learning avons utilisés prédiction label adaptés traiter problèmes prédiction multi label également implémentés librairie Python Scikit learn implémentations trouve méthode Forest multivarié librairie randomForestSRC algorithme directement dérivé travaux Breiman Breiman méthode Random Ferns multi label librairie rFerns inspirée classifieurs bayésiens Ozuysal classifieurs peuvent longs entraîner données notamment sommes alors tournés solution reconnue performances système appren tissage données apprentissage besoin entièrement mémoire Vowpal Wabbit développé Langford laboratoire Microsoft Research précédemment Yahoo Research propose plusieurs implémentations algorithmes multi classe facilement détourné faire multi label sensitive against CSOAA algorithme combine trois éléments Classification multi classe consiste entraîner classifieur classe réponse possible chaque classifieur spécialisé prédire classes blème multi classe ainsi décomposé plusieurs problèmes binaires Biernat senstitive learning approche différente classification classique cherche prédire réponse positive négative associé réponse Elkan données apprentissage bonne réponse associe mauvaise réponse senstitive learning ressemble inverse classification classique aussi pénaliser moins fortement certaines réponses coûts différents Réduction transformer problème apprentissage problème simple Beygelzimer CSOAA transforme problème initial plusieurs problèmes régression chacun visant prédire associé classes réponse intérêt algorithme directement intégrer exemples appren tissage cible multi label prédiction CSOAA comporte défaut comme prédiction multi classe utiliser comme classifieur multi label pérant fichiers intermédiaires prédictions brutes contiennent coûts associés chacune décisions défaut prédire classe associée faible multi label prédire toutes classes inférieur seuil donné github JohnLangford vowpal_wabbit Levorato Résultats prédiction multi label Préparation données phase exploratoire librairie permet visualiser facilement données représenter problématique multi label figure image gauche quantifie occurrences différentes combinaisons classes réponse combinaison fréquente évidemment 00000 correspond arbre correspond présence défaut suivants maladie présente Collet Houppier Racine Tronc seconde combinaison fréquente représente arbres malades uniquement niveau houppier 10100 combinaison maladies quente houppier tronc occurrences image droite permet visualiser relations occurrences entre maladies relie maladies entre elles surface croît nombre occurrences cette relation houppier tronc relation fréquente Exploration problématique multi label souhaitons construire classifieur CSOAA permette prédire multanément combinaisons classes Défaut Collet Houppier Racine Tronc transformer données elles puissent ingérées présentation problématique multi label spécifique algorithme CSOAA associe valeur numérique chaque classe Collet Houppier Racine Tronc chaque exemple associe ensuite chacune réponses paire points avons décidé associer chaque mauvaise réponse Ainsi arbre arbre malade houppier tronc pourrions chercher affiner valeurs coûts voulait pénaliser fortement certaines mauvaises réponses avons utilisé nique brutale communément utilisée férus consiste déclarer chaque variable comme quantitative qualitative Entraînement modèle partir données transformées entraînons modèle batch online learning fonctionnement défaut réajuste paramètres chaque nouvelle entrée comportement project packages Micro Macro Précision Rappel Performance modèle CSOAA multi label Mesure Résultat Exactitude Précision Rappel Performance modèle CSOAA label souhaitons éviter avons utilisé paramétrage modèle pourrait amélioré jouant nombreux paramètres customisation nombre passes données données entraînement modèle quasi instantané ordinateur bureau bonne facture processeur mémoire Prédiction résultats ligne prédiction brute apparence suivante 0810122 18642 15586 07331 07771 valeur numérique associée chaque classe suivie prédiction petit chance bonne réponse transformons alors résultat résultat multi label classique chaque classe associée inférieur certain seuil taguée positivement bonne réponse faible chaque classe associée supérieur seuil taguée négativement coûte avons choisi seuil valeur pourrait optimisée seuil ligne précédente devient arbre évaluons cette approche validation croisée folds performance évaluée métriques précision rappel micro macro disponibles scikit learn Concernant baseline proposé précision micro rappel micro ainsi précision macro rappel macro résultats présentés tableau baseline rappelée entre parenthèses modèle utilisé prédiction label puisqu intègre directement cible malade aucun travail supplémentaire feature engineering tient modèle performant dessus baseline multi label label également dessus premiers modèles utilisés tâche prédiction label modèle pourrait encore amélioré paramétrage entraînement affinement seuil online learning Tâche Enrichissement données cette tâche avons voulu isoler données experts permettent obtenir résultats décrits tâche effet aucune amélioration significative était Levorato observée ajout données externes champs avons considérés comme seignés expert donnés section clarifier discours utiliserons mesures comparaison exactitude mesure moyenne harmonique précision rappel champs experts obtenons mieux exactitude mesure modèle confondu Données maladies enrichir données présentes avons étudié question risque arbres contracter maladie faire sommes largement appuyés guide observation suivi organismes nuisibles zones agricoles réalisé Plante pilotage Ministère chargé agriculture Plante document répertorié sensibilités plantes hôtes fonction groupe nomique niveaux sensibilités décrits sensibles sensibles moyennement sensibles sensibles sensibles quand absent liste niveau maladies autres nuisibles avons extrait niveau sensibilité entres elles rattaché chaque groupe botanique Ainsi chaque genre arbre avons socié probabilité contracter maladie fonction sensibilité avons ensuite construit simulation multi agents définie comme environnement espace géographique discrétisé ensemble agents arbres ensembles maladies opérations diffusion maladies Chaque agent arbre possède caractéristiques suivantes fonction genre nique probabilité contracter maladie maladie ensemble valeurs initialisées correspondra nombre arbre infecté autre arbre maladie donnée modèle diffusion utilisé simple arbre donné certain probabilité infecté rayon défini trairement droite complexe construire modèle précis aurait réagi fonction nature maladie nécessiterait étude entière instar liste moins modèles sujet aperçu simulation donné figure gauche Celle réalisée Netlogo Voici déroulé simulation chaque arbre chaque maladie chaque arbre voisin rayon Générer valeur flottante aléatoire entre uniforme Déterminer valeur générée supérieure probabilité arbre contracté maladie arbre incrémente nombre infections contractées maladie enrichir données origine avons jouer plusieurs simulations environ plusieurs rayons quelques mètres avons ajouté chaque arbre colonnes correspondant ratio infection global maladie faisant rejouer modèle obtenons malheureusement faible exactitude passe changement mesure northwestern netlogo Simulation propagation maladies Station Latitude Longitude 190425 686977 180708 720161 182825 753152 158395 703683 161876 735583 Scores cumulés pollution Grenoble année Données pollution avons également voulu vérifier impact pollution ville pouvait avoir rapport avoir arbre malade sommes intéressés composants polluants connus avoir effets nocifs arbres Gillig particules diamètre inférieur former couches gênant absorption lumineuse provoquant corrosion lésions cuticule foliaire ozone entraine lésions surface supérieure feuilles tâches punctiformes chloroses nécroses dioxyde azote contribue formation pluies acides données extraites plate forme nationale prévision qualité outil permet connaitre pollution journalier maximum moyenne station avons travaillé données journalières maximales issues année transformant intervalles concentration score pollution station relève pollution entre donnera score station relevant pollution entre donnant score valeurs réelles valeurs réelles valeurs réelles tableau récapitule stations relevant scores cumulés valeur chaque polluant correspondant somme scores journaliers année pollution cumulée prevair Levorato partir données donnons valeur pollution cumulée chaque arbre interpolation pondération inverse distance exemple interpolation scores pollutionNO2 moins pollué pollué rouge ajoutant scores polluants modèles chaque arbre obtenons exactitude contre mesure contre permet déduire certain donnée pollution notre tâche prédiction Pollution cumulée année Conclusion Notre travail permis proposer approche répondre premier temps avons travaillé variables feature engineering pouvoir rendre utilisables modèles apprentissage supervisé sortir maximum signal tâche après avoir obtenu premiers résultats modèles classiques avons utilisé modèle avancé CSOAA donné meilleurs résultats notre étude Concernant tâche autres données considérées pollution confirmer intérêt enrichir données informations extérieures rester faible autres pistes seraient creuser fonction disponibilité données comme exemple nature ainsi aspect temporel arbres temps météo Références Andoni Razenshteyn Optimal Dependent Hashing Approximate Neighbors Proceedings Forty Seventh Annual Symposium Theory Computing Ankerst Breunig Kriegel Sander OPTICS Proceedings international conference Management SIGMOD Beygelzimer Langford Zadrozny Machine learning techniques Reduc tions between prediction quality metrics University Lecture Biernat science fondamentaux études Eyrolles Breiman Random Forests Machine Learning Chapman White Hooftman Bullock Inventory review quanti tative models spread plant pests assessment territory Supporting Publications Elkan Foundations sensitive Learning Proceedings ternational Joint Conference Artificial Intelligence Volume IJCAI Francisco Morgan Kaufmann Publishers Geurts Ernst Wehenkel Extremely randomized trees Machine Gillig Bourgery Amann arbre milieu urbain plantations conception œuvre Infolio Kondrak similarity distance Twelfth String Processing Information Retrieval Ozuysal Calonder Lepetit Keypoint Recognition Using Random Ferns Transactions Pattern Analysis Machine Intelligence Pedregosa Scikit learn Machine Learning Python Journal Machine Learning Research Plante Guide observation suivi organismes nuisibles Rosenberg Hirschberg Measure Conditional Entropy Based Exter Cluster Evaluation Measure Proceedings Joint Conference pirical Methods Natural Language Processing Computational Natural Language Learning EMNLP CoNLL Tsoumakas Katakis Multi label classification overview International Journal Warehousing Mining Summary conference proposes contest whose context management green space Grenoble focused trees propose model based provided would better predict diseased trees potential location disease After getting interesting results standard models approach using Sensitive Against model CSOAA allows obtain accuracy precision recall unilabel prediction precision recall micro though precision recall macro multilabel prediction extraction knowledge allowed highlight interest adding about diseases concentration pollution